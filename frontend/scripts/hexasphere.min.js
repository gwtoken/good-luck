! function(a) {
    var b = /iPhone/i,
        c = /iPod/i,
        d = /iPad/i,
        e = /(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,
        f = /Android/i,
        g = /(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,
        h = /(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,
        i = /IEMobile/i,
        j = /(?=.*\bWindows\b)(?=.*\bARM\b)/i,
        k = /BlackBerry/i,
        l = /BB10/i,
        m = /Opera Mini/i,
        n = /(CriOS|Chrome)(?=.*\bMobile\b)/i,
        o = /(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,
        p = new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)", "i"),
        q = function(a, b) { return a.test(b) },
        r = function(a) {
            var r = a || navigator.userAgent,
                s = r.split("[FBAN");
            return "undefined" != typeof s[1] && (r = s[0]), s = r.split("Twitter"), "undefined" != typeof s[1] && (r = s[0]), this.apple = { phone: q(b, r), ipod: q(c, r), tablet: !q(b, r) && q(d, r), device: q(b, r) || q(c, r) || q(d, r) }, this.amazon = { phone: q(g, r), tablet: !q(g, r) && q(h, r), device: q(g, r) || q(h, r) }, this.android = { phone: q(g, r) || q(e, r), tablet: !q(g, r) && !q(e, r) && (q(h, r) || q(f, r)), device: q(g, r) || q(h, r) || q(e, r) || q(f, r) }, this.windows = { phone: q(i, r), tablet: q(j, r), device: q(i, r) || q(j, r) }, this.other = { blackberry: q(k, r), blackberry10: q(l, r), opera: q(m, r), firefox: q(o, r), chrome: q(n, r), device: q(k, r) || q(l, r) || q(m, r) || q(o, r) || q(n, r) }, this.seven_inch = q(p, r), this.any = this.apple.device || this.android.device || this.windows.device || this.other.device || this.seven_inch, this.phone = this.apple.phone || this.android.phone || this.windows.phone, this.tablet = this.apple.tablet || this.android.tablet || this.windows.tablet, "undefined" == typeof window ? this : void 0
        },
        s = function() { var a = new r; return a.Class = r, a };
    "undefined" != typeof module && module.exports && "undefined" == typeof window ? module.exports = r : "undefined" != typeof module && module.exports && "undefined" != typeof window ? module.exports = s() : "function" == typeof define && define.amd ? define("isMobile", [], a.isMobile = s()) : a.isMobile = s()
}(this);
// import { BufferGeometry } from '../../core/BufferGeometry';
// import { Vector2 } from '../../math/Vector2';
// import { Vector3 } from '../../math/Vector3';
// import { BufferAttribute } from '../../core/BufferAttribute';

/**
 * @author Mugen87 / https://github.com/Mugen87
 */

const network = {
    blockchain: 'eos',
    host: "eosmainnet.medishares.net",
    port: 443,
    protocol: 'https',
    chainId: 'aca376f206b8fc25a6ed44dbdc66547c36c6c33e3a119ffbeaef943642f0e906'
}

var gameInfo = {};
var netInfo = null;
var isStart = true;
var curChose = 0;
var contract = null;
var curWidth = 1920;
var curHeight = 983;
var curTime = 86400;
var divChoseIndex = 0;
var btnTouch = false;
var languageType = 0;
var createTeamEos = 100;
var isBuy = false;
var isRech = false;
var gameMode = 1;
var isShow = false;
var mobileWidth = 414;
var mobileHeight = 736;

if(window.location.origin.indexOf("localhost") == -1){
    console.log = function(){};
}

document.addEventListener('scatterLoaded', async () => {
    console.log('scatterLoaded');
    const scatter = window.scatter;
    //window.scatter = null;

    // const getAuthorization = () => {
    //     if (!scatter || !scatter.identity || !scatter.identity.accounts)
    //         return null;

    //     const account = scatter.identity.accounts.find(account => account.blockchain === 'eos')

    //     return {
    //         permission: {
    //             authorization: [`${account.name}@${account.authority}`]
    //         },
    //         account
    //     }
    // }
    // 
    // 
   
    const eosOptions = {};
    const eos = window.eos = scatter.eos(network, Eos, eosOptions);

    netInfo = await eos.contract("eos2goodluck");
    console.log(netInfo);
    contract = await eos.contract('eosio.token');
    console.log(contract);
    setInterval("initEosInfo()", 5000);

    var identity = await scatter.getIdentity({ "accounts": [network] }).catch(function(error) {
        console.log(error);
    });
    if (identity) {
        gameInfo.accountsInfo = identity.accounts[0];
        console.log(gameInfo.accountsInfo);
    }
    initEosInfo();
});

async function initEosKeyInfo(){
    netInfo = await window.eos.contract("eos2goodluck");
    contract = await window.eos.contract("eosio.token");
    console.log(contract);
    console.log(netInfo);
    if(this.initEosInfoVal){
        clearInterval(this.initEosInfoVal);
    }
    setInterval("initEosInfo()", 5000);
}

async function initEosInfo() {

    console.log("initEosInfo");
    var counter = null;
    if (gameInfo.accountsInfo) {
        counter = await eos.getTableRows(true, "eos2goodluck", "eos2goodluck", "counter");
    } else {
        fetch("http://180.76.108.100:8000/v1/chain/get_table_rows", { "body": JSON.stringify({ "json": true, "scope": "eos2goodluck", "code": "eos2goodluck", "table": "counter" }), "method": "post" })
            .then(resp => resp.json()).then(function(resp) { gameInfo.gInfo = resp.rows[gameMode - 1];
                refeshValue();
                counter = resp;
                //console.log(counter,"99999999999999999")
            });
    }

    if (counter) {
        gameInfo.gInfo = counter.rows[gameMode - 1];
    }
    //console.log(counter,"*****************");


    gameInfo.oInfo = null;
    if (gameInfo.gInfo && gameInfo.gInfo.last_buyer) {
        var otherAccount = await eos.getTableRows(true, "eos2goodluck", gameInfo.gInfo.last_buyer, "account");
        gameInfo.oInfo = otherAccount.rows[gameMode - 1];
    }

    if (gameInfo.gInfo) {
        isStart = ((new Date()).getTime() - gameInfo.gInfo.last_buy_time * 1000 > 0) ? true : false;
    }

    if (!gameInfo.accountsInfo) {
        refeshValue();
        if (CheckCurrentOs().isPc) {
            changeLocation();
        } else {
            mobileChangeLocation();
        }
        return;
    }


    var uInfo = gameInfo.uInfo;
    var account = await eos.getTableRows(true, "eos2goodluck", gameInfo.accountsInfo.name, "account");
    console.log(account);
    var modeInfo = account.rows[gameMode - 1];
    var isNotHave = false;
    if (uInfo) {
        console.log(modeInfo.balance, uInfo.balance);
        isRech = Number(modeInfo.balance) > Number(uInfo.balance) ? true : false;
        if (isRech && uInfo.game_mode == gameMode) {
            console.log("充值成功");
            var num = (modeInfo.balance - uInfo.balance) * 0.0001;
            var msg = (languageType == 0) ? ("成功充值 " + num + " EOS") : ("Successful Recharge " + num + " EOS");
            if (!isStart) {
                msg = (languageType == 0) ? ("获得分红奖励 " + num + " EOS") : ("Bonus Awarded  " + num + " EOS");
            }

            msgTip(msg);
            isRech = false;
        }
        console.log(modeInfo.keys, uInfo.keys);
        if (uInfo.game_mode == gameMode) {
            isBuy = Number(modeInfo.keys) > Number(uInfo.keys) ? true : false;
            if (Number($("#myInput")[0].value >= 1 && isBuy)) {
                console.log("购买key成功");
                var keyNum = modeInfo.keys - uInfo.keys;
                var keyStr = keyNum > 0 ? " Keys" : " Key"
                var msg = (languageType == 0) ? ("成功购买 " + keyNum + keyStr) : ("Successful Purchase " + keyNum + keyStr);
                $("#myInput")[0].value = 1;
                msgTip(msg);
                isBuy = false;
            }
        }

        var isHaveAridrop = (modeInfo.aridrop_dividend - uInfo.aridrop_dividend > 0) ? true : false;
        if (isHaveAridrop && uInfo.game_mode == gameMode) {
            var msg = (languageType == 0) ? "获得空投奖金 " : "Get a drop in bonus ";
            msg = msg + ((modeInfo.aridrop_dividend - uInfo.aridrop_dividend) * 0.0001).toFixed(4) + " EOS";
            msgTip(msg);
        }

        isNotHave = (uInfo.game_mode == gameMode) ? ((modeInfo.team.length > 0 && uInfo.team.length == 0) ? true : false) : false;

        var isInvite = (uInfo.game_mode == gameMode) ? ((modeInfo.invite_name.length > uInfo.invite_name.length) ? true : false) : false;
        if (isInvite) {
            var msg = (languageType == 0) ? "添加推荐人成功！" : "Add references to success！";
            msgTip(msg);
        }


        var isExtract = (uInfo.game_mode == gameMode) ? ((uInfo.income > modeInfo.income) ? true : false) : false;
        if (isExtract) {
            var msg = (languageType == 0) ? "提取成功！" : "Extraction success！";
            msgTip(msg);
        }


    } else {
        if (isRech) {
            console.log("充值成功");
            var num = account.rows[gameMode - 1].balance * 0.0001;
            var msg = (languageType == 0) ? ("成功充值 " + num + " EOS") : ("Successful Recharge " + num + " EOS");
            msgTip(msg);
            isRech = false;
        }
    }

    gameInfo.uInfo = account.rows[gameMode - 1];
    var team = await eos.getTableRows(true, "eos2goodluck", "eos2goodluck", "team");
    console.log(team);
    gameInfo.tInfo = team.rows;
    var isCreate = false;
    for (var i = 0; i < gameInfo.tInfo.length; i++) {
        var teamInfo = gameInfo.tInfo[i];
        if (teamInfo.owner == gameInfo.accountsInfo.name) {
            isCreate = true;
            break;
        }
    }

    if (isNotHave) {
        var msg = isCreate ? ((languageType == 0) ? "成功创建战队!" : "Successful creation of combat teams!") : ((languageType == 0) ? "成功加入战队!" : "Join the team successfully!");
        msgTip(msg);
    }

    refeshValue();
    if (CheckCurrentOs().isPc) {
        changeLocation();
    } else {
        mobileChangeLocation();
    }
}

function PRingBufferGeometry(innerRadius, outerRadius, thetaSegments, phiSegments, thetaStart, thetaLength) {

    THREE.BufferGeometry.call(this);

    this.type = 'PRingBufferGeometry';

    this.parameters = {
        innerRadius: innerRadius,
        outerRadius: outerRadius,
        thetaSegments: thetaSegments,
        phiSegments: phiSegments,
        thetaStart: thetaStart,
        thetaLength: thetaLength
    };

    innerRadius = innerRadius || 20;
    outerRadius = outerRadius || 50;

    thetaStart = thetaStart !== undefined ? thetaStart : 0;
    thetaLength = thetaLength !== undefined ? thetaLength : Math.PI * 2;

    thetaSegments = thetaSegments !== undefined ? Math.max(3, thetaSegments) : 8;
    phiSegments = phiSegments !== undefined ? Math.max(1, phiSegments) : 1;

    // these are used to calculate buffer length
    var vertexCount = (thetaSegments + 1) * (phiSegments + 1);
    var indexCount = thetaSegments * phiSegments * 2 * 3;

    // buffers
    var indices = new THREE.BufferAttribute(new(indexCount > 65535 ? Uint32Array : Uint16Array)(indexCount), 1);
    var vertices = new THREE.BufferAttribute(new Float32Array(vertexCount * 3), 3);
    var normals = new THREE.BufferAttribute(new Float32Array(vertexCount * 3), 3);
    var uvs = new THREE.BufferAttribute(new Float32Array(vertexCount * 2), 2);

    // some helper variables
    var index = 0,
        indexOffset = 0,
        segment;
    var radius = innerRadius;
    var radiusStep = ((outerRadius - innerRadius) / phiSegments);
    var vertex = new THREE.Vector3();
    var uv = new THREE.Vector2();
    var j, i;

    // generate vertices, normals and uvs

    // values are generate from the inside of the ring to the outside

    var phiStep = 1 / phiSegments;
    var thetaStep = 1 / thetaSegments;
    for (j = 0; j <= phiSegments; j++) {

        for (i = 0; i <= thetaSegments; i++) {

            segment = thetaStart + i / thetaSegments * thetaLength;

            // vertex
            vertex.x = radius * Math.cos(segment);
            vertex.y = radius * Math.sin(segment);
            vertices.setXYZ(index, vertex.x, vertex.y, vertex.z);

            // normal
            normals.setXYZ(index, 0, 0, 1);

            // uv
            // uv.x = ( vertex.x / outerRadius + 1 ) / 2;
            // uv.y = ( vertex.y / outerRadius + 1 ) / 2;
            uv.x = i * thetaStep;
            uv.y = j * phiStep;
            uvs.setXY(index, uv.x, uv.y);

            // increase index
            index++;

        }

        // increase the radius for next row of vertices
        radius += radiusStep;

    }

    // generate indices

    for (j = 0; j < phiSegments; j++) {

        var thetaSegmentLevel = j * (thetaSegments + 1);

        for (i = 0; i < thetaSegments; i++) {

            segment = i + thetaSegmentLevel;

            // indices
            var a = segment;
            var b = segment + thetaSegments + 1;
            var c = segment + thetaSegments + 2;
            var d = segment + 1;

            // face one
            indices.setX(indexOffset, a);
            indexOffset++;
            indices.setX(indexOffset, b);
            indexOffset++;
            indices.setX(indexOffset, c);
            indexOffset++;

            // face two
            indices.setX(indexOffset, a);
            indexOffset++;
            indices.setX(indexOffset, c);
            indexOffset++;
            indices.setX(indexOffset, d);
            indexOffset++;

        }

    }

    // build geometry

    this.setIndex(indices);
    this.addAttribute('position', vertices);
    this.addAttribute('normal', normals);
    this.addAttribute('uv', uvs);

}

PRingBufferGeometry.prototype = Object.create(THREE.BufferGeometry.prototype);
PRingBufferGeometry.prototype.constructor = PRingBufferGeometry;

THREE.PRingBufferGeometry = PRingBufferGeometry;

// export { RingBufferGeometry };
/**
 * @author alteredq / http://alteredqualia.com/
 *
 * Full-screen textured quad shader
 */

THREE.CopyShader = {

    uniforms: {

        "tDiffuse": { value: null },
        "opacity": { value: 1.0 }

    },

    vertexShader: [

        "varying vec2 vUv;",

        "void main() {",

        "vUv = uv;",
        "gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",

        "}"

    ].join("\n"),

    fragmentShader: [

        "uniform float opacity;",

        "uniform sampler2D tDiffuse;",

        "varying vec2 vUv;",

        "void main() {",

        "vec4 texel = texture2D( tDiffuse, vUv );",
        "gl_FragColor = opacity * texel;",

        "}"

    ].join("\n")

};

/**
 * @author felixturner / http://airtight.cc/
 *
 * RGB Shift Shader
 * Shifts red and blue channels from center in opposite directions
 * Ported from http://kriss.cx/tom/2009/05/rgb-shift/
 * by Tom Butterworth / http://kriss.cx/tom/
 *
 * amount: shift distance (1 is width of input)
 * angle: shift angle in radians
 */

THREE.RGBShiftShader = {

    uniforms: {

        "tDiffuse": { value: null },
        "amount": { value: 0.005 },
        "angle": { value: 0.0 }

    },

    vertexShader: [

        "varying vec2 vUv;",

        "void main() {",

        "vUv = uv;",
        "gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",

        "}"

    ].join("\n"),

    fragmentShader: [

        "uniform sampler2D tDiffuse;",
        "uniform float amount;",
        "uniform float angle;",

        "varying vec2 vUv;",

        "void main() {",

        // "vec2 offset = amount * vec2( cos(angle), sin(angle));",
        "vec2 offset = amount * vec2( vUv.x - .5, vUv.y - .5 );",
        "vec4 cr = texture2D(tDiffuse, vUv + offset);",
        "vec4 cga = texture2D(tDiffuse, vUv);",
        "vec4 cb = texture2D(tDiffuse, vUv - offset);",
        "gl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);",

        "}"

    ].join("\n")

};

THREE.AlphaColorShader = {

    uniforms: {

        color: { value: new THREE.Color(0xffffff) },
        fogType: { value: 1 },
        fogNear: { value: 10.0 },
        fogFar: { value: 30.0 }
    },

    vertexShader: [
        "attribute float alpha;",
        "varying float vAlpha;",
        "void main() {",
        "vAlpha = alpha;",
        "vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",
        "gl_PointSize = 4.0;",
        "gl_Position = projectionMatrix * mvPosition;",
        "}",

    ].join("\n"),

    fragmentShader: [
        // "uniform vec3 color;",
        //      "varying float vAlpha;",
        //      "void main() {",

        //          "gl_FragColor = vec4( color, vAlpha * ( gl_FragCoord.z ) );",


        //      "}"

        "uniform vec3 color;",
        "uniform int fogType;",
        "uniform float fogNear;",
        "uniform float fogFar;",

        "varying float vAlpha;",

        "void main() {",
        // vec4 texture = texture2D( map, vUV );
        // if ( texture.a < alphaTest ) discard;
        // gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );

        "vec3 fogColor = vec3(0,0,0);",

        "gl_FragColor = vec4( color, vAlpha * ( gl_FragCoord.z ) );",
        "if ( fogType > 0 ) {",
        "float depth = gl_FragCoord.z / gl_FragCoord.w;",
        "float fogFactor = 0.0;",
        "if ( fogType == 1 ) {",
        "fogFactor = smoothstep( fogNear, fogFar, depth );",
        "} else {",
        // "const float LOG2 = 1.442695;",
        // "float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );",
        // "fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );",
        "}",
        "gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );",
        "}",
        "}"

    ].join("\n"),

    transparent: true

};

/**
 * @author alteredq / http://alteredqualia.com/
 *
 * Simple fake tilt-shift effect, modulating two pass Gaussian blur (see above) by vertical position
 *
 * - 9 samples per pass
 * - standard deviation 2.7
 * - "h" and "v" parameters should be set to "1 / width" and "1 / height"
 * - "r" parameter control where "focused" horizontal line lies
 */

THREE.VerticalTiltShiftShader = {

    uniforms: {

        "tDiffuse": { value: null },
        "v": { value: 1.0 / 512.0 },
        "r": { value: 0.35 }

    },

    vertexShader: [

        "\
        varying vec2 vUv;\
        \
        void main() {\
            \
            vUv = uv;\
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\
            \
        }"

    ].join("\n"),

    fragmentShader: [

        "uniform sampler2D tDiffuse;\
        uniform float v;\
        uniform float r;\
        \
        varying vec2 vUv;\
        \
        void main() {\
            \
            vec4 sum = vec4( 0.0 );\
            \
            float vv = v * abs( vUv.y - 0.5 ) * 1.5;\
            \
            sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * vv ) ) * 0.051;\
            sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * vv ) ) * 0.0918;\
            sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * vv ) ) * 0.12245;\
            sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * vv ) ) * 0.1531;\
            sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\
            sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * vv ) ) * 0.1531;\
            sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * vv ) ) * 0.12245;\
            sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * vv ) ) * 0.0918;\
            sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * vv ) ) * 0.051;\
            \
            gl_FragColor = sum;\
            \
        }"

    ].join("\n")

};

/**
 * @author alteredq / http://alteredqualia.com/
 * @author davidedc / http://www.sketchpatch.net/
 *
 * NVIDIA FXAA by Timothy Lottes
 * http://timothylottes.blogspot.com/2011/06/fxaa3-source-released.html
 * - WebGL port by @supereggbert
 * http://www.glge.org/demos/fxaa/
 */

THREE.FXAAShader = {

    uniforms: {

        "tDiffuse": { value: null },
        "resolution": { value: new THREE.Vector2(1 / 1024, 1 / 512) }

    },

    vertexShader: [

        "void main() {",

        "gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",

        "}"

    ].join("\n"),

    fragmentShader: [

        "uniform sampler2D tDiffuse;",
        "uniform vec2 resolution;",

        "#define FXAA_REDUCE_MIN   (1.0/128.0)",
        "#define FXAA_REDUCE_MUL   (1.0/8.0)",
        "#define FXAA_SPAN_MAX     8.0",

        "void main() {",

        "vec3 rgbNW = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( -1.0, -1.0 ) ) * resolution ).xyz;",
        "vec3 rgbNE = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( 1.0, -1.0 ) ) * resolution ).xyz;",
        "vec3 rgbSW = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( -1.0, 1.0 ) ) * resolution ).xyz;",
        "vec3 rgbSE = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( 1.0, 1.0 ) ) * resolution ).xyz;",
        "vec4 rgbaM  = texture2D( tDiffuse,  gl_FragCoord.xy  * resolution );",
        "vec3 rgbM  = rgbaM.xyz;",
        "vec3 luma = vec3( 0.299, 0.587, 0.114 );",

        "float lumaNW = dot( rgbNW, luma );",
        "float lumaNE = dot( rgbNE, luma );",
        "float lumaSW = dot( rgbSW, luma );",
        "float lumaSE = dot( rgbSE, luma );",
        "float lumaM  = dot( rgbM,  luma );",
        "float lumaMin = min( lumaM, min( min( lumaNW, lumaNE ), min( lumaSW, lumaSE ) ) );",
        "float lumaMax = max( lumaM, max( max( lumaNW, lumaNE) , max( lumaSW, lumaSE ) ) );",

        "vec2 dir;",
        "dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));",
        "dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));",

        "float dirReduce = max( ( lumaNW + lumaNE + lumaSW + lumaSE ) * ( 0.25 * FXAA_REDUCE_MUL ), FXAA_REDUCE_MIN );",

        "float rcpDirMin = 1.0 / ( min( abs( dir.x ), abs( dir.y ) ) + dirReduce );",
        "dir = min( vec2( FXAA_SPAN_MAX,  FXAA_SPAN_MAX),",
        "max( vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),",
        "dir * rcpDirMin)) * resolution;",
        "vec4 rgbA = (1.0/2.0) * (",
        "texture2D(tDiffuse,  gl_FragCoord.xy  * resolution + dir * (1.0/3.0 - 0.5)) +",
        "texture2D(tDiffuse,  gl_FragCoord.xy  * resolution + dir * (2.0/3.0 - 0.5)));",
        "vec4 rgbB = rgbA * (1.0/2.0) + (1.0/4.0) * (",
        "texture2D(tDiffuse,  gl_FragCoord.xy  * resolution + dir * (0.0/3.0 - 0.5)) +",
        "texture2D(tDiffuse,  gl_FragCoord.xy  * resolution + dir * (3.0/3.0 - 0.5)));",
        "float lumaB = dot(rgbB, vec4(luma, 0.0));",

        "if ( ( lumaB < lumaMin ) || ( lumaB > lumaMax ) ) {",

        "gl_FragColor = rgbA;",

        "} else {",
        "gl_FragColor = rgbB;",

        "}",

        "}"

    ].join("\n")

};

/**
 * @author alteredq / http://alteredqualia.com/
 */

THREE.EffectComposer = function(renderer, renderTarget) {

    this.renderer = renderer;

    if (renderTarget === undefined) {

        var parameters = {
            minFilter: THREE.LinearFilter,
            magFilter: THREE.LinearFilter,
            format: THREE.RGBAFormat,
            stencilBuffer: false
        };
        var size = renderer.getSize();
        renderTarget = new THREE.WebGLRenderTarget(size.width, size.height, parameters);

    }

    this.renderTarget1 = renderTarget;
    this.renderTarget2 = renderTarget.clone();

    this.writeBuffer = this.renderTarget1;
    this.readBuffer = this.renderTarget2;

    this.passes = [];

    if (THREE.CopyShader === undefined)
        console.error("THREE.EffectComposer relies on THREE.CopyShader");

    this.copyPass = new THREE.ShaderPass(THREE.CopyShader);

};

Object.assign(THREE.EffectComposer.prototype, {

    swapBuffers: function() {

        var tmp = this.readBuffer;
        this.readBuffer = this.writeBuffer;
        this.writeBuffer = tmp;

    },

    addPass: function(pass) {

        this.passes.push(pass);

        var size = this.renderer.getSize();
        pass.setSize(size.width, size.height);

    },

    insertPass: function(pass, index) {

        this.passes.splice(index, 0, pass);

    },

    render: function(delta) {

        var maskActive = false;

        var pass, i, il = this.passes.length;

        for (i = 0; i < il; i++) {

            pass = this.passes[i];

            if (pass.enabled === false) continue;

            pass.render(this.renderer, this.writeBuffer, this.readBuffer, delta, maskActive);

            if (pass.needsSwap) {

                if (maskActive) {

                    var context = this.renderer.context;

                    context.stencilFunc(context.NOTEQUAL, 1, 0xffffffff);

                    this.copyPass.render(this.renderer, this.writeBuffer, this.readBuffer, delta);

                    context.stencilFunc(context.EQUAL, 1, 0xffffffff);

                }

                this.swapBuffers();

            }

            if (THREE.MaskPass !== undefined) {

                if (pass instanceof THREE.MaskPass) {

                    maskActive = true;

                } else if (pass instanceof THREE.ClearMaskPass) {

                    maskActive = false;

                }

            }

        }

    },

    reset: function(renderTarget) {

        if (renderTarget === undefined) {

            var size = this.renderer.getSize();

            renderTarget = this.renderTarget1.clone();
            renderTarget.setSize(size.width, size.height);

        }

        this.renderTarget1.dispose();
        this.renderTarget2.dispose();
        this.renderTarget1 = renderTarget;
        this.renderTarget2 = renderTarget.clone();

        this.writeBuffer = this.renderTarget1;
        this.readBuffer = this.renderTarget2;

    },

    setSize: function(width, height) {

        this.renderTarget1.setSize(width, height);
        this.renderTarget2.setSize(width, height);

        for (var i = 0; i < this.passes.length; i++) {

            this.passes[i].setSize(width, height);

        }

    }

});


THREE.Pass = function() {

    // if set to true, the pass is processed by the composer
    this.enabled = true;

    // if set to true, the pass indicates to swap read and write buffer after rendering
    this.needsSwap = true;

    // if set to true, the pass clears its buffer before rendering
    this.clear = false;

    // if set to true, the result of the pass is rendered to screen
    this.renderToScreen = false;

};

Object.assign(THREE.Pass.prototype, {

    setSize: function(width, height) {},

    render: function(renderer, writeBuffer, readBuffer, delta, maskActive) {

        console.error("THREE.Pass: .render() must be implemented in derived pass.");

    }

});

/**
 * @author alteredq / http://alteredqualia.com/
 */

THREE.RenderPass = function(scene, camera, overrideMaterial, clearColor, clearAlpha) {

    THREE.Pass.call(this);

    this.scene = scene;
    this.camera = camera;

    this.overrideMaterial = overrideMaterial;

    this.clearColor = clearColor;
    this.clearAlpha = (clearAlpha !== undefined) ? clearAlpha : 0;

    this.clear = true;
    this.needsSwap = false;

};

THREE.RenderPass.prototype = Object.assign(Object.create(THREE.Pass.prototype), {

    constructor: THREE.RenderPass,

    render: function(renderer, writeBuffer, readBuffer, delta, maskActive) {

        var oldAutoClear = renderer.autoClear;
        renderer.autoClear = false;

        this.scene.overrideMaterial = this.overrideMaterial;

        var oldClearColor, oldClearAlpha;

        if (this.clearColor) {

            oldClearColor = renderer.getClearColor().getHex();
            oldClearAlpha = renderer.getClearAlpha();

            renderer.setClearColor(this.clearColor, this.clearAlpha);

        }

        renderer.render(this.scene, this.camera, this.renderToScreen ? null : readBuffer, this.clear);

        if (this.clearColor) {

            renderer.setClearColor(oldClearColor, oldClearAlpha);

        }

        this.scene.overrideMaterial = null;
        renderer.autoClear = oldAutoClear;
    }

});

/**
 * @author alteredq / http://alteredqualia.com/
 */

THREE.MaskPass = function(scene, camera) {

    THREE.Pass.call(this);

    this.scene = scene;
    this.camera = camera;

    this.clear = true;
    this.needsSwap = false;

    this.inverse = false;

};

THREE.MaskPass.prototype = Object.assign(Object.create(THREE.Pass.prototype), {

    constructor: THREE.MaskPass,

    render: function(renderer, writeBuffer, readBuffer, delta, maskActive) {

        var context = renderer.context;
        var state = renderer.state;

        // don't update color or depth

        state.buffers.color.setMask(false);
        state.buffers.depth.setMask(false);

        // lock buffers

        state.buffers.color.setLocked(true);
        state.buffers.depth.setLocked(true);

        // set up stencil

        var writeValue, clearValue;

        if (this.inverse) {

            writeValue = 0;
            clearValue = 1;

        } else {

            writeValue = 1;
            clearValue = 0;

        }

        state.buffers.stencil.setTest(true);
        state.buffers.stencil.setOp(context.REPLACE, context.REPLACE, context.REPLACE);
        state.buffers.stencil.setFunc(context.ALWAYS, writeValue, 0xffffffff);
        state.buffers.stencil.setClear(clearValue);

        // draw into the stencil buffer

        renderer.render(this.scene, this.camera, readBuffer, this.clear);
        renderer.render(this.scene, this.camera, writeBuffer, this.clear);

        // unlock color and depth buffer for subsequent rendering

        state.buffers.color.setLocked(false);
        state.buffers.depth.setLocked(false);

        // only render where stencil is set to 1

        state.buffers.stencil.setFunc(context.EQUAL, 1, 0xffffffff); // draw if == 1
        state.buffers.stencil.setOp(context.KEEP, context.KEEP, context.KEEP);

    }

});


THREE.ClearMaskPass = function() {

    THREE.Pass.call(this);

    this.needsSwap = false;

};

THREE.ClearMaskPass.prototype = Object.create(THREE.Pass.prototype);

Object.assign(THREE.ClearMaskPass.prototype, {

    render: function(renderer, writeBuffer, readBuffer, delta, maskActive) {

        renderer.state.buffers.stencil.setTest(false);

    }

});

/**
 * @author alteredq / http://alteredqualia.com/
 */

THREE.ShaderPass = function(shader, textureID) {

    THREE.Pass.call(this);

    this.textureID = (textureID !== undefined) ? textureID : "tDiffuse";

    if (shader instanceof THREE.ShaderMaterial) {

        this.uniforms = shader.uniforms;

        this.material = shader;

    } else if (shader) {

        this.uniforms = THREE.UniformsUtils.clone(shader.uniforms);

        this.material = new THREE.ShaderMaterial({

            defines: shader.defines || {},
            uniforms: this.uniforms,
            vertexShader: shader.vertexShader,
            fragmentShader: shader.fragmentShader

        });

    }

    this.camera = new THREE.OrthographicCamera(-1, 1, 1, -1, 0, 1);
    this.scene = new THREE.Scene();

    this.quad = new THREE.Mesh(new THREE.PlaneBufferGeometry(2, 2), null);
    this.scene.add(this.quad);

};

THREE.ShaderPass.prototype = Object.assign(Object.create(THREE.Pass.prototype), {

    constructor: THREE.ShaderPass,

    render: function(renderer, writeBuffer, readBuffer, delta, maskActive) {

        if (this.uniforms[this.textureID]) {

            this.uniforms[this.textureID].value = readBuffer.texture;

        }

        this.quad.material = this.material;

        if (this.renderToScreen) {

            renderer.render(this.scene, this.camera);

        } else {

            renderer.render(this.scene, this.camera, writeBuffer, this.clear);

        }

    }

});

/**
 * @author mpk / http://polko.me/
 */

THREE.SMAAPass = function(width, height) {

    THREE.Pass.call(this);

    // render targets

    this.edgesRT = new THREE.WebGLRenderTarget(width, height, {
        depthBuffer: false,
        stencilBuffer: false,
        generateMipmaps: false,
        minFilter: THREE.LinearFilter,
        format: THREE.RGBFormat
    });

    this.weightsRT = new THREE.WebGLRenderTarget(width, height, {
        depthBuffer: false,
        stencilBuffer: false,
        generateMipmaps: false,
        minFilter: THREE.LinearFilter,
        format: THREE.RGBAFormat
    });

    // textures

    var areaTextureImage = new Image();
    areaTextureImage.src = this.getAreaTexture();

    this.areaTexture = new THREE.Texture();
    this.areaTexture.image = areaTextureImage;
    this.areaTexture.format = THREE.RGBFormat;
    this.areaTexture.minFilter = THREE.LinearFilter;
    this.areaTexture.generateMipmaps = false;
    this.areaTexture.needsUpdate = true;
    this.areaTexture.flipY = false;

    var searchTextureImage = new Image();
    searchTextureImage.src = this.getSearchTexture();

    this.searchTexture = new THREE.Texture();
    this.searchTexture.image = searchTextureImage;
    this.searchTexture.magFilter = THREE.NearestFilter;
    this.searchTexture.minFilter = THREE.NearestFilter;
    this.searchTexture.generateMipmaps = false;
    this.searchTexture.needsUpdate = true;
    this.searchTexture.flipY = false;

    // materials - pass 1

    if (THREE.SMAAShader === undefined) {
        console.error("THREE.SMAAPass relies on THREE.SMAAShader");
    }

    this.uniformsEdges = THREE.UniformsUtils.clone(THREE.SMAAShader[0].uniforms);

    this.uniformsEdges["resolution"].value.set(1 / width, 1 / height);

    this.materialEdges = new THREE.ShaderMaterial({
        defines: THREE.SMAAShader[0].defines,
        uniforms: this.uniformsEdges,
        vertexShader: THREE.SMAAShader[0].vertexShader,
        fragmentShader: THREE.SMAAShader[0].fragmentShader
    });

    // materials - pass 2

    this.uniformsWeights = THREE.UniformsUtils.clone(THREE.SMAAShader[1].uniforms);

    this.uniformsWeights["resolution"].value.set(1 / width, 1 / height);
    this.uniformsWeights["tDiffuse"].value = this.edgesRT.texture;
    this.uniformsWeights["tArea"].value = this.areaTexture;
    this.uniformsWeights["tSearch"].value = this.searchTexture;

    this.materialWeights = new THREE.ShaderMaterial({
        defines: THREE.SMAAShader[1].defines,
        uniforms: this.uniformsWeights,
        vertexShader: THREE.SMAAShader[1].vertexShader,
        fragmentShader: THREE.SMAAShader[1].fragmentShader
    });

    // materials - pass 3

    this.uniformsBlend = THREE.UniformsUtils.clone(THREE.SMAAShader[2].uniforms);

    this.uniformsBlend["resolution"].value.set(1 / width, 1 / height);
    this.uniformsBlend["tDiffuse"].value = this.weightsRT.texture;

    this.materialBlend = new THREE.ShaderMaterial({
        uniforms: this.uniformsBlend,
        vertexShader: THREE.SMAAShader[2].vertexShader,
        fragmentShader: THREE.SMAAShader[2].fragmentShader
    });

    this.needsSwap = false;

    this.camera = new THREE.OrthographicCamera(-1, 1, 1, -1, 0, 1);
    this.scene = new THREE.Scene();

    this.quad = new THREE.Mesh(new THREE.PlaneBufferGeometry(2, 2), null);
    this.scene.add(this.quad);

};

THREE.SMAAPass.prototype = Object.assign(Object.create(THREE.Pass.prototype), {

    constructor: THREE.SMAAPass,

    render: function(renderer, writeBuffer, readBuffer, delta, maskActive) {

        // pass 1

        this.uniformsEdges["tDiffuse"].value = readBuffer.texture;

        this.quad.material = this.materialEdges;

        renderer.render(this.scene, this.camera, this.edgesRT, this.clear);

        // pass 2

        this.quad.material = this.materialWeights;

        renderer.render(this.scene, this.camera, this.weightsRT, this.clear);

        // pass 3

        this.uniformsBlend["tColor"].value = readBuffer.texture;

        this.quad.material = this.materialBlend;

        if (this.renderToScreen) {

            renderer.render(this.scene, this.camera);

        } else {

            renderer.render(this.scene, this.camera, writeBuffer, this.clear);

        }

    },

    setSize: function(width, height) {

        this.edgesRT.setSize(width, height);
        this.weightsRT.setSize(width, height);

        this.materialEdges.uniforms['resolution'].value.set(1 / width, 1 / height);
        this.materialWeights.uniforms['resolution'].value.set(1 / width, 1 / height);
        this.materialBlend.uniforms['resolution'].value.set(1 / width, 1 / height);

    },

    getAreaTexture: function() {
        return 'data:image/png;base64,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';
    },

    getSearchTexture: function() {
        return 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAAAAABIXyLAAAAAOElEQVRIx2NgGAWjYBSMglEwEICREYRgFBZBqDCSLA2MGPUIVQETE9iNUAqLR5gIeoQKRgwXjwAAGn4AtaFeYLEAAAAASUVORK5CYII=';
    }

});

/**
 * @author alteredq / http://alteredqualia.com/
 */

THREE.FilmPass = function(noiseIntensity, scanlinesIntensity, scanlinesCount, grayscale) {

    THREE.Pass.call(this);

    if (THREE.FilmShader === undefined)
        console.error("THREE.FilmPass relies on THREE.FilmShader");

    var shader = THREE.FilmShader;

    this.uniforms = THREE.UniformsUtils.clone(shader.uniforms);

    this.material = new THREE.ShaderMaterial({

        uniforms: this.uniforms,
        vertexShader: shader.vertexShader,
        fragmentShader: shader.fragmentShader

    });

    if (grayscale !== undefined) this.uniforms.grayscale.value = grayscale;
    if (noiseIntensity !== undefined) this.uniforms.nIntensity.value = noiseIntensity;
    if (scanlinesIntensity !== undefined) this.uniforms.sIntensity.value = scanlinesIntensity;
    if (scanlinesCount !== undefined) this.uniforms.sCount.value = scanlinesCount;

    this.camera = new THREE.OrthographicCamera(-1, 1, 1, -1, 0, 1);
    this.scene = new THREE.Scene();

    this.quad = new THREE.Mesh(new THREE.PlaneBufferGeometry(2, 2), null);
    this.scene.add(this.quad);

};

THREE.FilmPass.prototype = Object.assign(Object.create(THREE.Pass.prototype), {

    constructor: THREE.FilmPass,

    render: function(renderer, writeBuffer, readBuffer, delta, maskActive) {

        this.uniforms["tDiffuse"].value = readBuffer.texture;
        this.uniforms["time"].value += delta;

        this.quad.material = this.material;

        if (this.renderToScreen) {

            renderer.render(this.scene, this.camera);

        } else {

            renderer.render(this.scene, this.camera, writeBuffer, this.clear);

        }

    }

});

THREE.POrbitControls = function(looking_object, DOMElement) {

    var scope = this;
    var is_dragging = false;
    var target = new THREE.Vector3();
    var lo_spherical = new THREE.Spherical();
    var t_spherical = window.t_spherical = new THREE.Spherical();
    var scale = 1;

    scope.enabled = true;

    scope.enableDamping = true;
    scope.dampingFactor = .063;

    // How far you can orbit vertically, upper and lower limits.
    // Range is 0 to Math.PI radians.
    this.minPolarAngle = 0; // radians
    this.maxPolarAngle = Math.PI; // radians

    // How far you can orbit horizontally, upper and lower limits.
    // If set, must be a sub-interval of the interval [ - Math.PI, Math.PI ].
    this.minAzimuthAngle = -Infinity; // radians
    this.maxAzimuthAngle = Infinity; // radians

    // Set to true to automatically rotate around the target
    this.autoRotate = false;
    this.autoRotateSpeed = 2.0;
    // console.log("> distance:", distance );

    // This option actually enables dollying in and out; left as "zoom" for backwards compatibility.
    // Set to false to disable zooming
    this.enableZoom = true;
    this.zoomSpeed = 1.0;
    this.zoomFactor = .063;

    // How far you can dolly in and out ( PerspectiveCamera only )
    this.minDistance = 0;
    this.maxDistance = Infinity;


    // 
    var mouse = {
        x: 0,
        y: 0,
        prev_x: 0,
        prev_y: 0,
        delta_x: 0,
        delta_y: 0
    }

    var dollyStart = new THREE.Vector2();
    var dollyEnd = new THREE.Vector2();
    var dollyDelta = new THREE.Vector2();

    scope.attach = function() {
        DOMElement.addEventListener('mousedown', onMouseDown, false);
        DOMElement.addEventListener('mousemove', onMouseMove, false);
        DOMElement.addEventListener('mouseup', onMouseUp, false);

        DOMElement.addEventListener('touchstart', onTouchStart, false);
        DOMElement.addEventListener('touchend', onTouchEnd, false);
        DOMElement.addEventListener('touchmove', onTouchMove, false);

        window.addEventListener('mouseout', onMouseUp, false);

        DOMElement.addEventListener('wheel', onMouseWheel, false);

        t_spherical.setFromVector3(looking_object.position);
        lo_spherical.setFromVector3(looking_object.position);
    }

    scope.detach = function() {
        DOMElement.removeEventListener('mousedown', onMouseDown);
        DOMElement.removeEventListener('mousemove', onMouseMove);
        DOMElement.removeEventListener('mouseup', onMouseUp);

        DOMElement.removeEventListener('touchstart', onTouchStart);
        DOMElement.removeEventListener('touchend', onTouchEnd);
        DOMElement.removeEventListener('touchmove', onTouchMove);

        window.removeEventListener('mouseout', onMouseUp);

        DOMElement.removeEventListener('wheel', onMouseWheel);
    }






    /*
    ██████╗  ██████╗ ████████╗ █████╗ ████████╗███████╗
    ██╔══██╗██╔═══██╗╚══██╔══╝██╔══██╗╚══██╔══╝██╔════╝
    ██████╔╝██║   ██║   ██║   ███████║   ██║   █████╗  
    ██╔══██╗██║   ██║   ██║   ██╔══██║   ██║   ██╔══╝  
    ██║  ██║╚██████╔╝   ██║   ██║  ██║   ██║   ███████╗
    ╚═╝  ╚═╝ ╚═════╝    ╚═╝   ╚═╝  ╚═╝   ╚═╝   ╚══════╝
    */
    function setMousePosition(x, y, start) {
        mouse.x = x;
        mouse.y = y;

        mouse.delta_x = start ? 0 : mouse.x - mouse.prev_x;
        mouse.delta_y = start ? 0 : mouse.y - mouse.prev_y;
        mouse.prev_x = mouse.x;
        mouse.prev_y = mouse.y;

        if (is_dragging) {
            t_spherical.phi -= mouse.delta_y * .002;
            t_spherical.theta -= mouse.delta_x * .002;
            t_spherical.makeSafe();
        }
    }


    // ROTATE
    function onMouseDown(e) {
        return;
        console.log(scope.enabled);
        if (scope.enabled === false) return;
        e.preventDefault();
        is_dragging = true;

        setMousePosition(e.clientX, e.clientY, true);
    }



    function onMouseMove(e) {
        return;
        if (scope.enabled === false) return;
        setMousePosition(e.clientX, e.clientY);

    }


    function onMouseUp(e) {
        return;
        if (scope.enabled === false) return;

        e.preventDefault();
        is_dragging = false;
    }







    /*
    ███████╗ ██████╗  ██████╗ ███╗   ███╗
    ╚══███╔╝██╔═══██╗██╔═══██╗████╗ ████║
      ███╔╝ ██║   ██║██║   ██║██╔████╔██║
     ███╔╝  ██║   ██║██║   ██║██║╚██╔╝██║
    ███████╗╚██████╔╝╚██████╔╝██║ ╚═╝ ██║
    ╚══════╝ ╚═════╝  ╚═════╝ ╚═╝     ╚═╝
    */
    // WHEEL
    function onMouseWheel(e) {
        console.log(onMouseWheel, scope.enabled, scope.enableZoom);
        if (scope.enabled === false || scope.enableZoom === false) return;

        e.preventDefault();
        e.stopPropagation();

        if (e.deltaY < 0) {

            // dollyOut( getZoomScale() );
            changeZoom(-scope.zoomSpeed);

        } else if (e.deltaY > 0) {

            // dollyIn( getZoomScale() );
            changeZoom(scope.zoomSpeed);

        }

    }

    function changeZoom(_add) {
        t_spherical.radius += _add;
        // restrict radius to be between desired limits
        t_spherical.radius = Math.max(scope.minDistance, Math.min(scope.maxDistance, t_spherical.radius));
    }







    /*
    ████████╗ ██████╗ ██╗   ██╗ ██████╗██╗  ██╗
    ╚══██╔══╝██╔═══██╗██║   ██║██╔════╝██║  ██║
       ██║   ██║   ██║██║   ██║██║     ███████║
       ██║   ██║   ██║██║   ██║██║     ██╔══██║
       ██║   ╚██████╔╝╚██████╔╝╚██████╗██║  ██║
       ╚═╝    ╚═════╝  ╚═════╝  ╚═════╝╚═╝  ╚═╝
    */
    // TOUCH
    function onTouchStart(event) {

        if (scope.enabled === false) return;

        var touches = event.touches;

        switch (touches.length) {

            case 1: // one-fingered touch: rotate
                is_dragging = true;
                setMousePosition(touches[0].pageX, touches[0].pageY, true);
                break;

            case 2: // two-fingered touch: dolly

                if (scope.enableZoom === false) return;
                var dx = touches[0].pageX - touches[1].pageX;
                var dy = touches[0].pageY - touches[1].pageY;
                var distance = Math.sqrt(dx * dx + dy * dy);
                dollyStart.set(0, distance);

                break;

        }
    }

    function onTouchMove(event) {

        if (scope.enabled === false) return;

        event.preventDefault();
        event.stopPropagation();

        var touches = event.touches;

        switch (touches.length) {

            case 1: // one-fingered touch: rotate
                setMousePosition(touches[0].pageX, touches[0].pageY);
                break;

            case 2: // two-fingered touch: dolly
                if (scope.enableZoom === false) return;

                var dx = touches[0].pageX - touches[1].pageX;
                var dy = touches[0].pageY - touches[1].pageY;

                var distance = Math.sqrt(dx * dx + dy * dy);

                dollyEnd.set(0, distance);

                dollyDelta.subVectors(dollyEnd, dollyStart);

                if (dollyDelta.y > 0) {

                    changeZoom(-scope.zoomSpeed);

                } else if (dollyDelta.y < 0) {

                    changeZoom(scope.zoomSpeed);

                }

                dollyStart.copy(dollyEnd);
                break;

        }

    }

    function onTouchEnd(event) {
        if (scope.enabled === false) return;
        is_dragging = false;

    }





    /*
    ██╗   ██╗██████╗ ██████╗  █████╗ ████████╗███████╗
    ██║   ██║██╔══██╗██╔══██╗██╔══██╗╚══██╔══╝██╔════╝
    ██║   ██║██████╔╝██║  ██║███████║   ██║   █████╗  
    ██║   ██║██╔═══╝ ██║  ██║██╔══██║   ██║   ██╔══╝  
    ╚██████╔╝██║     ██████╔╝██║  ██║   ██║   ███████╗
     ╚═════╝ ╚═╝     ╚═════╝ ╚═╝  ╚═╝   ╚═╝   ╚══════╝
    */
    // UPDATE
    scope.update = function() {
        // zoom
        lo_spherical.radius += (t_spherical.radius - lo_spherical.radius) * scope.zoomFactor;
        // console.log( "> ", t_spherical.radius, scale);

        // restrict theta to be between desired limits
        t_spherical.theta = Math.max(scope.minAzimuthAngle, Math.min(scope.maxAzimuthAngle, t_spherical.theta));

        // restrict phi to be between desired limits
        t_spherical.phi = Math.max(scope.minPolarAngle, Math.min(scope.maxPolarAngle, t_spherical.phi));

        //console.log(is_dragging,scope.autoRotate);
        if (!is_dragging && scope.autoRotate) {
            t_spherical.theta += scope.autoRotateSpeed;
            t_spherical.makeSafe();
        }

        // console.log( t_spherical.radius, scale );

        if (scope.enableDamping) {
            lo_spherical.phi += (t_spherical.phi - lo_spherical.phi) * scope.dampingFactor;
            lo_spherical.theta += (t_spherical.theta - lo_spherical.theta) * scope.dampingFactor;
            lo_spherical.makeSafe();
        } else {
            lo_spherical.radius = t_spherical.radius;
            lo_spherical.phi = t_spherical.phi;
            lo_spherical.theta = t_spherical.theta;
        }


        looking_object.position.setFromSpherical(lo_spherical);
        looking_object.lookAt(target);

    }



    scope.attach();

}
// d.potekhin
// TODO: stop animation of the grid effect

THREE.XRayMaterial = function(params) {

    var uniforms = {
        uTex: { type: "t", value: params.map || new THREE.Texture() },
        offsetRepeat: { value: new THREE.Vector4(0, 0, 1, 1) },
        alphaProportion: { type: "1f", value: params.alphaProportion || 0.5 },
        diffuse: { value: params.color || new THREE.Color(0xffffff) },
        opacity: { value: params.opacity || 1 },
        gridOffset: { value: 0 }
    }

    setInterval(function() {
        uniforms.gridOffset.value += params.gridOffsetSpeed || 1;
        // m.needsUpdate = true;
    }, 40);

    var m = new THREE.ShaderMaterial({

        uniforms: uniforms,

        // attributes: {
        //  vertexOpacity: { value: [] }
        // },
        vertexShader: "\
            varying float _alpha;\
            varying vec2 vUv;\
            uniform vec4 offsetRepeat;\
            uniform float alphaProportion;\
            \
            void main() {\
                gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\
                vUv = uv * offsetRepeat.zw + offsetRepeat.xy;\
                \
                vec4 worldPosition = modelMatrix * vec4( vec3( position ), 1.0 );\
                vec3 cameraToVertex = normalize( cameraPosition - worldPosition.xyz);\
                _alpha = 1.0 - max( 0.0, dot( normal, cameraToVertex ) );\
                _alpha = max( 0.0, (_alpha - alphaProportion) / (1.0 - alphaProportion) );\
            }",
        //alpha = alphaProportion + (alpha - 0.0) * (1.0 - alphaProportion) / (1.0 - 0.0);\

        fragmentShader:

            "uniform sampler2D uTex;\
            uniform vec3 diffuse;\
            uniform float opacity;\
            uniform float gridOffset;\
            \
            varying float _alpha;\
            varying vec2 vUv;\
            \
            void main() {\
                vec4 texColor = texture2D( uTex, vUv );\
                float _a = _alpha * opacity;\
                if( _a <= 0.0 ) discard;\
                _a = _a * ( sin( vUv.y * 2000.0 + gridOffset ) * .5 + .5 );\
                gl_FragColor = vec4( texColor.rgb * diffuse, _a );\
            \
            }",
        //if ( alpha < .5 ) discard;\

        transparent: true,
        blending: THREE.AdditiveBlending,
        depthTest: false
    });

    return m;
};

(function(kaspersky) {

    /*
    // !! In some cause Detector doesn't see webGL content on my configuration with nVidia GTS250
    console.log("Detector.webgl", Detector, Detector.webgl);
    if ( ! Detector.webgl ){
        console.log("Your graphics card does not seem to support WebGL. Find out how to get it here.");
        Detector.addGetWebGLMessage()
        return;
    }
    */

    var scope = this;
    var $container = scope.$container = $(".main-container");

    if (!Detector.webgl) {
        $container.hide();
        return;
    }

    var enable_screenshot = !true; // !!!    Flag enables making Screenshot functionality
    var dpr = window.devicePixelRatio !== undefined ? window.devicePixelRatio : 1;
    // console.log("dpr: ", dpr, window.devicePixelRatio);

    // WEBGL
    var scene = scope.scene = new THREE.Scene();
    // scene.fog = new THREE.Fog( 0x000000, 7, 40 );// !!!
    scene.fog = new THREE.Fog(0x000000, 7, enable_screenshot ? 60 : 40);


    // var renderer = scope.renderer =  new THREE.WebGLRenderer(  { antialias: true } );
    var renderer = scope.renderer = new THREE.WebGLRenderer({
        preserveDrawingBuffer: enable_screenshot
        // ,alpha: enable_screenshot
    });
    // renderer.set
    renderer.autoClearColor = new THREE.Color(0, 0, 0, 0);
    renderer.setPixelRatio(dpr);
    // renderer.setSize( window.innerWidth, window.innerHeight );
    $container.append(renderer.domElement);

    // CAMERA
    var camera = scope.camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 700);
    camera.position.set(-16, 11, 0);
    camera.lookAt(new THREE.Vector3(0, 0, 0));
    // scene.add( camera );




    // !!! SCREENSHOT
    if (enable_screenshot) {

        $("body").css("background-color", "#ff0000");
        $(".main-container").css("background-color", "rgba(0,0,0,0)");
        console.log(">>>>", $(".main-container").css("background-color"));

        $("<div id='screenshot-button' style='\
        display : inline-block;\
        font-family: Tahoma;\
        font-size : 18px;\
        color: white;\
        width: auto;\
        height: auto;\
        padding:10px;\
        background-color: red;\
        opacity: .99;\
        z-index: 100;\
        position: absolute;\
        bottom: 50px;\
        left: 50%;\
        cursor: pointer;\
        '>MAKE SCREENSHOT</div>").appendTo($("body")).click(function() {

            planet.bg.visible = false;

            if (composer) composer.render();
            else renderer.render(scene, camera);

            var dataURL = renderer.domElement.toDataURL();
            // console.log( dataURL );
            $("<img id='ready-screenshot' style='position:fixed;opacity:.99;z-index:999999;top:0;left:0;'>").attr("src", dataURL).appendTo($("body"));
        });
    }
    // !!! SCREENSHOT









    // EFFECTS

    var composer;

    // if( false && !isMobile.any ){
    if (!isMobile.any) {

        // composer = new THREE.EffectComposer( renderer );
        // composer.addPass( new THREE.RenderPass( scene, camera ) );

        // var effect = new THREE.ShaderPass( THREE.DotScreenShader );
        // effect.uniforms[ 'scale' ].value = 8;
        // effect.renderToScreen = true;
        // composer.addPass( effect );


        // var effect = new THREE.ShaderPass( THREE.ColoringShader );
        // effect.renderToScreen = true;
        // composer.addPass( effect );

        // var effect = new THREE.FilmPass( 0.35, 0.025, 648, false );
        // var effect = new THREE.FilmPass( 0.6, 0.5, 900, false );// black screen on mac
        // composer.addPass( effect );




        // var effect = new THREE.ShaderPass( THREE.VerticalTiltShiftShader );
        // effect.renderToScreen = true;
        // composer.addPass( effect );



        // var effect = new THREE.ShaderPass( THREE.RGBShiftShader );
        // effect.uniforms[ 'amount' ].value = 0;//0.005;
        // // effect.renderToScreen = true;
        // composer.addPass( effect );

        // pass = new THREE.SMAAPass( window.innerWidth, window.innerHeight );
        // pass.renderToScreen = true;
        // composer.addPass( pass );

        var effect, pass;

        composer = new THREE.EffectComposer(renderer);
        // composer.setSize(window.innerWidth * dpr, window.innerHeight * dpr);

        //
        effect = new THREE.RenderPass(scene, camera);
        composer.addPass(effect);

        // RGB shift
        effect = new THREE.ShaderPass(THREE.RGBShiftShader);
        effect.uniforms['amount'].value = 0.0025; //0.005;
        // effect.renderToScreen = true;
        composer.addPass(effect);

        // antialiasing
        // FXAA
        var FXAAShaderPass = effect = new THREE.ShaderPass(THREE.FXAAShader);
        // effect.uniforms['resolution'].value.set(1 / (window.innerWidth * dpr), 1 / (window.innerHeight * dpr));
        // effect.renderToScreen = true;
        composer.addPass(effect);

        var VerticalTiltShiftShader = effect = new THREE.ShaderPass(THREE.VerticalTiltShiftShader);
        effect.uniforms['r'].value = .35;
        // console.log( "::> ",effect.uniforms['r'] );
        effect.renderToScreen = true;
        composer.addPass(effect);

        // SMAA
        // pass = new THREE.SMAAPass( window.innerWidth, window.innerHeight );
        // pass.renderToScreen = true;
        // composer.addPass( pass );

    }



    // STATS
    var stats;
    /*
    if( window.Stats ){
        stats = new Stats();
        stats.domElement.style.position = 'fixed';
        stats.domElement.style.top = '0';
        stats.domElement.style.right = '0';
        stats.domElement.style.zIndex = 100;
        $container.append( stats.domElement );
    }
    */

    // RESIZE
    window.addEventListener('resize', onWindowResize, false);

    function onWindowResize() {
        var w = window.innerWidth;
        var h = window.innerHeight;
        // console.log("resize: ", w, h, dpr );
        renderer.domElement.originalSize = { width: w, height: h };
        camera.aspect = w / h;
        camera.updateProjectionMatrix();

        renderer.setPixelRatio(dpr);
        renderer.setSize(w, h);

        if (composer) {
            composer.setSize(w, h);
            FXAAShaderPass.uniforms['resolution'].value.set(1 / w, 1 / h);
            VerticalTiltShiftShader.uniforms["v"].value = 1 / h;
        }

    }
    onWindowResize();

    // var controls = scope.controls = new THREE.OrbitControls( camera, renderer.domElement );
    //     //controls.addEventListener( 'change', render ); // add this only if there is no animation loop (requestAnimationFrame)

    // controls.enablePan = false;


    var controls = scope.controls = new THREE.POrbitControls(camera, renderer.domElement);

    controls.minPolarAngle = Math.PI * .15; //Math.PI * .25;
    controls.maxPolarAngle = Math.PI * .85; //Math.PI * .75;

    controls.enableDamping = true;
    controls.dampingFactor = .063;

    controls.autoRotate = true;
    controls.autoRotateSpeed = .002 * 3;

    controls.enableZoom = !false;
    controls.minDistance = 18; // default is 18
    controls.maxDistance = enable_screenshot ? 40 : 20;
    controls.zoomSpeed = .2;
    controls.zoomFactor = .1;

    //
    // var directionalLight = new THREE.DirectionalLight( 0xffffff, 0.5 );
    // directionalLight.position.set( 0, 1, 0 );
    // scene.add( directionalLight );



    // var geometry = new THREE.BoxGeometry( 1, 1, 1, 10,10,10 );
    // var material = new THREE.MeshBasicMaterial( {color: 0x00ff00} );
    // // material.wireframe = true;
    // var cube = new THREE.Mesh( geometry, material );
    // cube.position.set(-5,1,-5);
    // scene.add( cube );


    // PLanet
    var planet;

    var def = kaspersky.ready.addWait();
    kaspersky.planetMain = function(api, locationAPI) {
        api()
            .then(function(data) {
                console.log("success", data);
                planet = new Planet(scope, data, function() {
                    //kaspersky.Transition.fadeOut();
                    //$(document).trigger("page:ready");
                    def.resolve();
                    def = undefined;
                }, locationAPI);
                animate();
            })
            .fail(function() {
                console.log("error");
            })
            .always(function() {
                // console.log( "complete" );
            })
    };
    /*$.getJSON( "api_example/locations.json", )
        // .done(function() {
        //     console.log( "second success" );
        // })
        .fail();*/


    // ANIMATION LOOP
    function animate() {

        window.requestAnimationFrame(animate);

        if (planet.state != planet.ANIMATED) controls.update();
        planet.update();

        if (composer) composer.render();
        else renderer.render(scene, camera);

        if (stats) stats.update(renderer);
    }




    this.animateIn = function(t, onComplete) {

        t = t || 3;

        // controls.autoRotateSpeed = .002*20;
        TweenLite.to(controls, t, {
            autoRotateSpeed: .002,
            ease: Sine.easeOut
        });


        // camera.fov = 2;
        camera.updateProjectionMatrix();
        TweenLite.to(camera, t, {
            fov: 60,
            ease: Sine.easeInOut,
            onUpdate: function() {
                camera.updateProjectionMatrix();
            },
            onComplete: function() {
                if (onComplete) onComplete();
            }
        })
    };

    this.animateOut = function(t, onComplete) {

        t = t || 2;

        // TweenLite.to( controls, t,{
        //     autoRotateSpeed: .02,
        //     ease: Sine.easeIn
        // });

        TweenLite.to(camera, t, {
            fov: 10,
            ease: Sine.easeInOut,
            onUpdate: function() {
                camera.updateProjectionMatrix();
            },
            onComplete: function() {
                if (onComplete) onComplete();
            }
        })
    };

})(kaspersky = kaspersky || {});
//------------------------------------------------------------

var kaspersky;
/*
██████╗ ██╗      █████╗ ███╗   ██╗███████╗████████╗    ██████╗  █████╗ ███████╗███████╗
██╔══██╗██║     ██╔══██╗████╗  ██║██╔════╝╚══██╔══╝    ██╔══██╗██╔══██╗██╔════╝██╔════╝
██████╔╝██║     ███████║██╔██╗ ██║█████╗     ██║       ██████╔╝███████║███████╗█████╗  
██╔═══╝ ██║     ██╔══██║██║╚██╗██║██╔══╝     ██║       ██╔══██╗██╔══██║╚════██║██╔══╝  
██║     ███████╗██║  ██║██║ ╚████║███████╗   ██║       ██████╔╝██║  ██║███████║███████╗
╚═╝     ╚══════╝╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝   ╚═╝       ╚═════╝ ╚═╝  ╚═╝╚══════╝╚══════╝
*/

async function changeLocation() {

    var curPlanet = window.PLANET;
    if (!curPlanet.haveFlagLocations) {
        curPlanet.haveFlagLocations = [];
    }

    if (gameMode == 2 || !gameInfo.oInfo || !isStart) {
        if (PLANET.hexaspherePopup) {
            PLANET.hexaspherePopup.close();
        }
        PLANET.hexaspherePopup = null;
        if (PLANET.state != PLANET.IDLE) {
            PLANET.state = PLANET.IDLE;
        }
        curPlanet.haveFlagLocations = [];
        this.curLocation = null;
        return;
    }

    //原数据清空
    if (curPlanet.haveFlagLocations.length == 0) {
        for (var i = 0; i < curPlanet.data.locations.length; i++) {
            var location = curPlanet.data.locations[i];
            location.name = "";
            location.preview = "";
            if (location.position) {
                curPlanet.haveFlagLocations.push(location);
            }
        }
    }

    if (gameInfo.tInfo && gameInfo.tInfo.length > 0) {
        var curTeamNum = 0;
        while (curTeamNum < gameInfo.tInfo.length) {
            var teamInfo = gameInfo.tInfo[curTeamNum];
            for (var i = 1; i < curPlanet.haveFlagLocations.length; i++) {
                var haveF = curPlanet.haveFlagLocations[i];
                if (haveF.name == teamInfo.name) {
                    curTeamNum = gameInfo.tInfo.length;
                    break;
                }
            }
            if (curTeamNum < gameInfo.tInfo.length) {
                var roundNum = Math.floor(Math.random() * (curPlanet.haveFlagLocations.length - 1));
                var locat = curPlanet.haveFlagLocations[roundNum + 1];
                if (locat.name.length == 0 && locat.preview.length == 0) {
                    locat.name = teamInfo.name;
                    locat.preview = teamInfo.logo;
                    curTeamNum++;
                    break;
                }
            }
        }

        if (gameInfo.oInfo) {
            if (gameInfo.oInfo.team) {
                var curLocation = null;
                for (var i = 1; i < curPlanet.haveFlagLocations.length; i++) {
                    var haveF = curPlanet.haveFlagLocations[i];
                    if (haveF.name == gameInfo.oInfo.team) {
                        curLocation = haveF;
                        break;
                    }
                }
                if (this.curLocation && curLocation && this.curLocation.name == curLocation.name) {
                    return;
                }

                this.curLocation = curLocation;
                if (curLocation) {
                    curPlanet.moveToActiveHexagonF(curLocation);
                }
            } else {
                var firstLocation = curPlanet.haveFlagLocations[0];
                firstLocation.name = gameInfo.oInfo.name;
                if (this.curLocation) {
                    if (this.curLocation.name != gameInfo.oInfo.name) {
                        curPlanet.moveToActiveHexagonF(firstLocation);
                    }
                } else {
                    curPlanet.moveToActiveHexagonF(firstLocation);
                }
                this.curLocation = firstLocation;
            }
        }

    } else {

        if (gameInfo.oInfo) {
            var firstLocation = curPlanet.haveFlagLocations[0];
            if (this.curLocation) {
                console.log(this.curLocation.name, gameInfo.oInfo.name);
                if (this.curLocation.name != gameInfo.oInfo.name) {
                    console.log("8888888888888888888888888888888888888888888888888");
                    curPlanet.moveToActiveHexagonF(firstLocation);
                    /*                    if (PLANET.hexaspherePopup) {
                                            $("#hexagon__image")[0].style["background-image"] = firstLocation.preview;
                                            $("#earth-popup__city")[0].innerText = gameInfo.oInfo.name;
                                        }*/
                }
                firstLocation.name = gameInfo.oInfo.name;
            } else {
                firstLocation.name = gameInfo.oInfo.name;
                curPlanet.moveToActiveHexagonF(firstLocation);
            }
            this.curLocation = firstLocation;
            return;
        }
    }
}

function mobileChangeLocation() {
    if (!gameInfo.oInfo || !isStart || gameMode == 2) {
        var useInfoBg = document.getElementById("useInfoBg");
        if (useInfoBg) {
            useInfoBg.style.visibility = "hidden";
        }
        return;
    }
    if (gameInfo.oInfo) {
        var image = "url(assets/earth/tips/icon_1.png)";
        var last_buyer = gameInfo.oInfo.name;
        if (gameInfo.oInfo.team.length > 0) {
            for (var i = 0; i < gameInfo.tInfo.length; i++) {
                if (gameInfo.oInfo.team == gameInfo.tInfo[i].name) {
                    image = gameInfo.tInfo[i].logo;
                    last_buyer = gameInfo.oInfo.team;
                    break;
                }
            }
        }
        var useInfoBg = document.getElementById("useInfoBg");
        if (useInfoBg) {
            useInfoBg.style.visibility = "visible";
            var useTeamImage = document.getElementById("useTeamImage");
            useTeamImage.style["background-image"] = image;
            var useNameDiv = document.getElementById("useNameDiv");
            useNameDiv.innerText = last_buyer;
        }
    }
}

function CheckCurrentOs() {
    var ua = navigator.userAgent,
        isWindowsPhone = /(?:Windows Phone)/.test(ua),
        isSymbian = /(?:SymbianOS)/.test(ua) || isWindowsPhone,
        isAndroid = /(?:Android)/.test(ua),
        isFireFox = /(?:Firefox)/.test(ua),
        isChrome = /(?:Chrome|CriOS)/.test(ua),
        isTablet = /(?:iPad|PlayBook)/.test(ua) || (isAndroid && !/(?:Mobile)/.test(ua)) || (isFireFox && /(?:Tablet)/.test(ua)),
        isPhone = /(?:iPhone)/.test(ua) && !isTablet,
        isPc = !isPhone && !isAndroid && !isSymbian;
    return {
        isTablet: isTablet,
        isPhone: isPhone,
        isAndroid: isAndroid,
        isPc: isPc
    };
}

function Planet(main, data, onReady, locationAPI) {

    // var $debug = $(".debug");

    var scope = window.PLANET = this;
    // scope.textures_path = "assets/earth/";

    scope.main = main;
    var DOMElement = main.renderer.domElement;
    var scene = scope.scene = main.scene;
    var camera = main.camera;

    var radius = scope.radius = 10; // Radius used to calculate position of tiles
    var ratio = scope.ratio = window.devicePixelRatio || 1;
    // console.log("ratio: ", ratio );

    // PLANET 3D CONTAINER 地球
    var container = this.container = window.earthContainer = new THREE.Object3D();
    if (CheckCurrentOs().isPc) {
        scene.add(container);
    }
    var scaleNum = 0.75;
    container.scale.set(scaleNum, scaleNum, scaleNum);
    console.log(container.scale, container.visible, container.up);

    // 3D CONTAINER FOR OBJECTS LOOKING TO THE CAMERA
    var static_container = this.static_container = new THREE.Object3D();
    scene.add(static_container);
    static_container.matrixAutoUpdate = false;

    var textureLoader = this.textureLoader = new THREE.TextureLoader();

    this.planet_color = 0xa6f5a3;
    this.water_color = 0xa6f5a3; //0x81915b;

    // STATES
    scope.LOADING = "loading";
    scope.IDLE = "idle";
    scope.ANIMATED = "animated";
    scope.state = scope.LOADING;





    //--------------------------------------------
    // DATA
    scope.data = data;
    // var _l = $.extend(true, {}, data.locations);
    // data.locations = {};
    // data.locations['2030'] = _l;
    // data.locations['2040'] = _l;
    // data.locations['2050'] = _l;
    console.log("DATA: ", data);

    // sort countries by id
    data.countries_by_id = {};
    for (var i = 0; i < data.countries.length; i++) {
        var l = data.countries[i];
        data.countries_by_id[l.country_id] = l;
    };

    // sort locations by id
    data.locations_by_id = {};
    for (var i = 0; i < data.locations.length; i++) {
        var l = data.locations[i];
        data.locations_by_id[l.location_id] = l;
    }

    scope.haveFlagLocations = [];

    setTimeout(function() {
        console.log("检测当前是否安装了钱包插件", gameInfo.gInfo,gameInfo.accountsInfo);
        if (!window.scatter) {
            var msg = (languageType == 0) ? "未安装EOS钱包插件!" : "No EOS wallet plugins installed!";
            msgTip(msg);            
        }
    }, 4000)

    if(!gameInfo.gInfo){
        initEosInfo();
        if(this.initEosInfoVal){
            clearInterval(this.initEosInfoVal);
        }
        setInterval("initEosInfo()", 5000);
    }
    //--------------------------------------------



    /*
     ██████╗ ██████╗ ███╗   ███╗███╗   ███╗███████╗███╗   ██╗████████╗    ████████╗██╗██████╗ 
    ██╔════╝██╔═══██╗████╗ ████║████╗ ████║██╔════╝████╗  ██║╚══██╔══╝    ╚══██╔══╝██║██╔══██╗
    ██║     ██║   ██║██╔████╔██║██╔████╔██║█████╗  ██╔██╗ ██║   ██║          ██║   ██║██████╔╝
    ██║     ██║   ██║██║╚██╔╝██║██║╚██╔╝██║██╔══╝  ██║╚██╗██║   ██║          ██║   ██║██╔═══╝ 
    ╚██████╗╚██████╔╝██║ ╚═╝ ██║██║ ╚═╝ ██║███████╗██║ ╚████║   ██║          ██║   ██║██║     
     ╚═════╝ ╚═════╝ ╚═╝     ╚═╝╚═╝     ╚═╝╚══════╝╚═╝  ╚═══╝   ╚═╝          ╚═╝   ╚═╝╚═╝     
    */

    // COMMENTARY TIP
    // this._PlanetCommentPopup = PlanetCommentPopup( this.main.$container );

    // scope.commentToggle = function( _show ){
    // if( !scope._PlanetCommentPopup ) return;
    // if( _show ) scope._PlanetCommentPopup.showRandom();
    // else scope._PlanetCommentPopup.hide();
    // }

    this.getLocationBriefs = function(location_id, onComplete) {

        var loc = scope.data.locations_by_id[location_id];
        var brief_list = loc.brief_list;

        // console.log("getLocationBriefs:", brief_list );

        if (brief_list) {

            onComplete(brief_list[PlanetData.YEAR_ID].briefs);
            return;

        } else {

            locationAPI({ location_id: location_id })
                .done(function(locationData) {
                    // console.log("LOC:>>>", locationData );
                    // console.log(":>>>", PlanetData.YEAR_ID );
                    // console.log(":>>", loc );
                    brief_list = loc.brief_list = locationData;
                    onComplete(brief_list[PlanetData.YEAR_ID].briefs);
                });

        }

    }

    this.drawPoints(radius * 1.1);
    // ELEMENTS    
    if (CheckCurrentOs().isPc) {

        this.drawParticles(radius);
        this.drawBG();
        this.drawSputniks();
        this.drawOrbitas();
    }


    this.planetLocations = new PlanetLocations(this);
    this.planetPointed = new PlanetPointed(this);
    this.planetContour = new PlanetContour(this);

    this.drawDisplayBoxImage();

    /*
    ██╗   ██╗██████╗ ██████╗  █████╗ ████████╗███████╗
    ██║   ██║██╔══██╗██╔══██╗██╔══██╗╚══██╔══╝██╔════╝
    ██║   ██║██████╔╝██║  ██║███████║   ██║   █████╗  
    ██║   ██║██╔═══╝ ██║  ██║██╔══██║   ██║   ██╔══╝  
    ╚██████╔╝██║     ██████╔╝██║  ██║   ██║   ███████╗
     ╚═════╝ ╚═╝     ╚═════╝ ╚═╝  ╚═╝   ╚═╝   ╚══════╝
    */

    var camera_dist_to_center;

    this.update = function() {


        camera_dist_to_center = camera.position.distanceToSquared(THREE.Vector3.ZERO) - 100;

        static_container.lookAt(camera.getWorldPosition());
        scope.static_container.updateMatrix();

        // Rotation of the grid sphere
        this.grid_shpere.rotation.y += .0005;

        // MOVEMENT OF DECOR ORBITS
        if (this.orbits) {
            for (var i = 0; i < this.orbits.length; i++) {
                var orbit = this.orbits[i];
                orbit.rotation.x += orbit._increment.x;
                orbit.rotation.y += orbit._increment.y;
                orbit.rotation.z += orbit._increment.z;
            };
        }

        // Movement of space stations
        if (this.sputniks) {
            for (var i = 0; i < this.sputniks.length; i++) {
                var sputnik = this.sputniks[i];
                sputnik.rotation.y += .0020;
            }
        }

        // SPACE JUNK FLOATING AROUND THE PLANET
        if (this.particles) {
            this.particles.rotation.y += .001;
        }

        // PLANET LANDSCAPE MADE OF POINTS
        this.planetPointed.update();
        if (this.updateBg) this.updateBg();

        adaptionPos();
        // Active hexagon update state
        if (window.active_hexagon || active_hexagon) {
            // active_hex_dummy.lookAt( camera.getWorldPosition().clone().multiplyScalar( 1000 ) );
            active_hex_dummy.updateMatrix();
            /*            var pos = active_hex_dummy.getWorldPosition();
                        var v1 = pos.clone().project(camera);
                        v1.x = (v1.x + 1) / 2 * window.innerWidth;
                        v1.y = -(v1.y - 1) / 2 * window.innerHeight;
                        active_hexagon.style.transform = "translate(" + v1.x + "px, " + v1.y + "px)";*/
            //console.log("********************************");
            window.active_hexagon.style.transform = "translate(" + window.innerWidth * 0.5 + "px, " + window.innerHeight * 0.5 + "px)";

            // console.log( v1.x, v1.y );

            // Deactivate picked hexagons when it moves to the negative side of the planet
            if (!this.isInFrontOfPlanet(active_hex_dummy.position)) {
                scope.deactivateHexagon();
            }
        }

        // if( this._PlanetCommentPopup ) this._PlanetCommentPopup.update();
        //console.log("update*************************************",isMobile.any);
        if (this.state == this.IDLE && !isMobile.any) {
            chekHover()
        }

    }

    /*
    ██╗███╗   ██╗████████╗███████╗██████╗  █████╗  ██████╗████████╗██╗██╗   ██╗███████╗
    ██║████╗  ██║╚══██╔══╝██╔════╝██╔══██╗██╔══██╗██╔════╝╚══██╔══╝██║██║   ██║██╔════╝
    ██║██╔██╗ ██║   ██║   █████╗  ██████╔╝███████║██║        ██║   ██║██║   ██║█████╗  
    ██║██║╚██╗██║   ██║   ██╔══╝  ██╔══██╗██╔══██║██║        ██║   ██║╚██╗ ██╔╝██╔══╝  
    ██║██║ ╚████║   ██║   ███████╗██║  ██║██║  ██║╚██████╗   ██║   ██║ ╚████╔╝ ███████╗
    ╚═╝╚═╝  ╚═══╝   ╚═╝   ╚══════╝╚═╝  ╚═╝╚═╝  ╚═╝ ╚═════╝   ╚═╝   ╚═╝  ╚═══╝  ╚══════╝
    */
    // INTERACTIVE
    scope.tile_current = null;
    // console.log( "raycaster: ", raycaster );
    var mouse = new THREE.Vector2(-2, -2);
    var mouse_dir = mouse.clone();
    var mouse_start = new THREE.Vector2();
    var mouse_moving_distance = 0;
    var mouse_is_down;

    var intersect_sphere = new THREE.Sphere(scope.container.position.clone(), radius);
    var raycaster = new THREE.Raycaster();

    DOMElement.addEventListener('touchstart', onMouseDown, false);
    DOMElement.addEventListener('touchmove', onMouseMove, false);
    DOMElement.addEventListener('touchend', onMouseUp, false);

    DOMElement.addEventListener('mousedown', onMouseDown, false);
    DOMElement.addEventListener('mousemove', onMouseMove, false);
    DOMElement.addEventListener('mouseup', onMouseUp, false);

    var mx, my, dx, dy;

    function onMouseDown(e) {

        e.preventDefault();

        if (e.touches) {
            var touch = e.touches[0];
            mx = touch.clientX;
            my = touch.clientY;
        } else {
            mx = e.clientX * ratio;
            my = e.clientY * ratio;
        }

        updateMouse(mx, my);
        mouse_moving_distance = 0;
        mouse_is_down = true;

    }


    function onMouseUp(e) {

        mouse_is_down = false;

        // if( active_hexagon ) active_hexagon.style.pointerEvents = "auto";
        //console.log("onMouseUp",scope.state);
        if (scope.state != scope.IDLE) return;

        // is it was a click?
        if (mouse_moving_distance > 6) return;

        if (isMobile.any) {

            checkTapOnObject();

        } else {

            /*if( hexagon_hover ) {
                activateHexagon( hexagon_hover.location );
                hexagon_hover = null;
            }else{
                scope.deactivateHexagon();
            }*/


        }


    }

    function onMouseMove(e) {

        e.preventDefault();

        // if( active_hexagon && mouse_is_down ) active_hexagon.style.pointerEvents = "none";

        if (e.touches) {
            var touch = e.touches[0];
            // console.log("move", e);
            mx = touch.clientX;
            my = touch.clientY;
        } else {
            mx = e.clientX * ratio;
            my = e.clientY * ratio;
        }

        updateMouse(mx, my);

    }



    function updateMouse(mx, my) {

        dx = Math.abs(mouse.x - mx);
        dy = Math.abs(mouse.y - my);
        mouse_moving_distance += dx * dx + dy * dy;
        mouse.x = mx;
        mouse.y = my;

        if (isMobile.any) {
            mouse_dir.x = (mouse.x / DOMElement.originalSize.width - .5) * 2;
            mouse_dir.y = -(mouse.y / DOMElement.originalSize.height - .5) * 2;
        } else {
            mouse_dir.x = (mouse.x / DOMElement.width - .5) * 2;
            mouse_dir.y = -(mouse.y / DOMElement.height - .5) * 2;
        }
        // $debug.text( mouse.x+" : "+mouse.y+" | "+Math.floor(mouse_dir.x*100)/100+":"+Math.floor(mouse_dir.y*100)/100 );
    }


    function chekHover() {

        //console.log("chekHover",scope.state);
        if (scope.state != scope.IDLE) return;

        var intersection, _location_current;

        // console.log(">>>", mouse );
        raycaster.setFromCamera(mouse_dir, camera);

        // intersection with sphere
        intersection = raycaster.ray.intersectSphere(intersect_sphere);
        if (intersection) {
            // return;
            _location_current = scope.getClosestLocation(intersection);
            //console.log("_location_current: ", _location_current);
        }
        //console.log(_location_current,intersection);
        if (_location_current) {

            if (_location_current != scope.location_current) {

                // showCurrentHover( _location_current );
                // DOMElement.style.cursor = "pointer";
                // console.log("HOVER");
                //scope.activateHexagonF(_location_current);

                return true;
            }

        } else {

            // hideCurrentHover();
            // DOMElement.style.cursor = "default";
        }

        return false;
    }



    function checkTapOnObject() {
        var intersection, _location_current;

        raycaster.setFromCamera(mouse_dir, camera);
        // $debug.text( DOMElement.width+" => "+mouse.x+" : "+mouse.y+" | "+Math.floor(mouse_dir.x*100)/100+":"+Math.floor(mouse_dir.y*100)/100 );

        // intersection with sphere
        intersection = raycaster.ray.intersectSphere(intersect_sphere);
        // console.log("checkTapOnObject >>>", mouse );
        if (intersection) {
            // return;
            _location_current = scope.getClosestLocation(intersection);
            console.log("_location_current: ", _location_current);
        }


        if (_location_current) {
            //scope.activateHexagonF(_location_current);
        } else {
            //scope.deactivateHexagon();
        }

    }


    /*
    ██╗  ██╗ ██████╗ ██╗   ██╗███████╗██████╗ ███████╗
    ██║  ██║██╔═══██╗██║   ██║██╔════╝██╔══██╗██╔════╝
    ███████║██║   ██║██║   ██║█████╗  ██████╔╝███████╗
    ██╔══██║██║   ██║╚██╗ ██╔╝██╔══╝  ██╔══██╗╚════██║
    ██║  ██║╚██████╔╝ ╚████╔╝ ███████╗██║  ██║███████║
    ╚═╝  ╚═╝ ╚═════╝   ╚═══╝  ╚══════╝╚═╝  ╚═╝╚══════╝
    */
    var location_picked = null; // hexagon_hovered and picked hexagon
    /*
        // HOVERS
        var hexagon_hover = null;// 
        var hexagon_hover_assets = [];
        var hexagon_hover_actives = [];
        for (var i = 0; i < 10; i++) {  
            hexagon_hover_assets.push( new Hexagon( scene ) );
        };


        function showCurrentHover ( l ) {

            // console.log("showCurrentHover: ", l.name );
            // hideCurrentHover();
            
            main.controls.autoRotate = false;
            scope.location_current = l;

            // if( hexagon_hover_assets.length ){
            //     hexagon_hover = hexagon_hover_assets.pop();
            // }else{
            //     hexagon_hover = hexagon_hover_actives.shift();
            // }

            // if( hexagon_hover ) {

            //     hexagon_hover_actives.push( hexagon_hover );
            //     hexagon_hover.setToLocation( l );


            //     // DOMElement.style.cursor = "pointer";
            // }else {
            //     // console.log("> ", hexagon_hover_assets.length, hexagon_hover_actives.length);
            //     // setTimeout( scope.deactivateHexagon.bind( this, l ), 20 );
            // }

        }
    */

    /*
        function hideCurrentHover () {
            if( scope.location_current==null ) return;
            // console.log("hideCurrentHover: " );

            if( hexagon_hover ){
                hexagon_hover_actives.push( hexagon_hover );
                hexagon_hover.hide( hexagon_hover_assets );
                hexagon_hover = null;
            }
            // scope.location_current = null;
            
            // if( !location_picked ) main.controls.autoRotate = true;
            // DOMElement.style.cursor = "default";
        }
    */




    /*
     █████╗  ██████╗████████╗██╗██╗   ██╗███████╗    ██╗  ██╗███████╗██╗  ██╗ █████╗  ██████╗  ██████╗ ███╗   ██╗
    ██╔══██╗██╔════╝╚══██╔══╝██║██║   ██║██╔════╝    ██║  ██║██╔════╝╚██╗██╔╝██╔══██╗██╔════╝ ██╔═══██╗████╗  ██║
    ███████║██║        ██║   ██║██║   ██║█████╗      ███████║█████╗   ╚███╔╝ ███████║██║  ███╗██║   ██║██╔██╗ ██║
    ██╔══██║██║        ██║   ██║╚██╗ ██╔╝██╔══╝      ██╔══██║██╔══╝   ██╔██╗ ██╔══██║██║   ██║██║   ██║██║╚██╗██║
    ██║  ██║╚██████╗   ██║   ██║ ╚████╔╝ ███████╗    ██║  ██║███████╗██╔╝ ██╗██║  ██║╚██████╔╝╚██████╔╝██║ ╚████║
    ╚═╝  ╚═╝ ╚═════╝   ╚═╝   ╚═╝  ╚═══╝  ╚══════╝    ╚═╝  ╚═╝╚══════╝╚═╝  ╚═╝╚═╝  ╚═╝ ╚═════╝  ╚═════╝ ╚═╝  ╚═══╝
    */

    // TODO: separate placing of additive prview hexagons
    var active_hex_dummy = new THREE.Object3D();
    active_hex_dummy.matrixAutoUpdate = false;
    this.container.add(active_hex_dummy);

    var active_hexagon = null; //
    var extActiveHexagonHide; // External method to hide DOM element of the active hexagon

    // ACTIVE HEXAGON
    this.activateHexagonF = function activateHexagon(_location) {
        //console.log("activateHexagon", _location );
        console.log("*************", _location);
        main.controls.autoRotate = false;
        scope.location_current = _location;

        // Define an array of nearby locations to view
        location_picked = _location;
        _location.briefs = PlanetData.hasLocationAnyBriefs(location_picked, true);
        var _locations = [_location];
        extActiveHexagonHide = null;
        // var closer_location_1 = scope.getAnyClosestLocation( _location.position, [ _location ] );
        // if( closer_location_1 ){
        //     _locations.push( closer_location_1 );
        //     var closer_location_2 = scope.getAnyClosestLocation( _location.position, [ _location, closer_location_1] );
        //     if( closer_location_2 ) _locations.push( closer_location_2 );
        // }

        // Hit an external method to show defined hexagons  鼠标移动到相应位置，弹出信息
        if (kaspersky.getHexaspherePopup && gameMode == 1) {

            console.log("kaspersky.getHexaspherePopup");

            this.hexaspherePopup = kaspersky.getHexaspherePopup(_locations, this.moveToActiveHexagonF);
            active_hexagon = window.active_hexagon = this.hexaspherePopup.element;
            console.log($("#hexagon__image"), _locations.preview);
            $("#hexagon__image")[0].style["background-image"] = _location.preview;
            $("#earth-popup__city")[0].innerText = _location.name;
            changeTime();

            // console.log( "active_hexagon: ", o );
            //extActiveHexagonHide = hexaspherePopup.close;

            /*var $active_hexagon = $(active_hexagon);
            $active_hexagon.on( "mouseleave", onActiveHexagonMouseLeave );

            function onActiveHexagonMouseLeave(){
                scope.deactivateHexagon();
                $active_hexagon.off( "mouseleave", onActiveHexagonMouseLeave );
            }*/
        }

        // console.log( ">>>", _location );
        active_hex_dummy.position.copy(_location.position);

        // hideCurrentHover();

        // Disable Earth constant rotation
        main.controls.autoRotate = false;
        _location.light.visible = false;

        // Hide current commentary
        // scope.commentToggle( false );

        // console.log("INFO: ", renderer.info );
    }


    this.deactivateHexagon = function() {

        if (!location_picked) return;
        // console.log("deactivateHexagon", location_picked );

        if (typeof extActiveHexagonHide === "function") extActiveHexagonHide();

        active_hexagon = null;

        scope.location_current = null;
        location_picked.light.visible = true;
        location_picked = null;

        main.controls.autoRotate = true;

        // show a commentary
        // scope.commentToggle( true );
    }


    // var camera_zoom = main.camera.clone();
    var camera_rotator = window.camera_rotator = new THREE.Object3D();
    camera_rotator.up = new THREE.Vector3(0, 1, 0);
    main.scene.add(camera_rotator);
    camera_rotator.matrixAutoUpdate = false;

    /*
        var gbg = new THREE.Mesh( new THREE.BoxBufferGeometry(.1,.1,.1), new THREE.MeshBasicMaterial({color:0xff0000}) );
        camera_rotator.add( gbg );
        gbg.position.z = radius;
        */

    //控制摄像机位移到指定位置
    this.moveToActiveHexagonF = function moveToActiveHexagon(location) {

        console.log(location.name);
        // var navigateUrl;
        // if (location.type === "brief") {
        //     var $info = location.years[PlanetData.YEAR_ID];
        //     navigateUrl  = "prediction?brief_id=" + $info.brief_id;
        // } else {
        //     navigateUrl = "map.html?location_id=" + location.location_id;
        // }
        // console.log(scope, scope.state);
        console.log(this.hexaspherePopup);
        if (this.hexaspherePopup) {
            this.hexaspherePopup.close();
        }
        this.hexaspherePopup = null;
        scope.state = scope.ANIMATED;

        // main.controls.detach();
        DOMElement.style.cursor = "default";

        //scope.deactivateHexagon();
        // hideCurrentHover();
        //showCurrentHover( location );

        // hide current commentary
        //scope.commentToggle( false );

        // target rotation
        var curQend = null;
        var qend, qstart;
        if (this.qend) {
            curQend = this.qend;
        }
        camera_rotator.lookAt(location.position);
        qend = this.qend = camera_rotator.quaternion.clone();

        if (curQend) {
            qstart = curQend;
        } else {
            camera_rotator.lookAt(main.camera.position);
            qstart = camera_rotator.quaternion.clone();
        }

        camera_rotator.updateMatrix();
        console.log(qstart, this.qend);

        // THREE.SceneUtils.attach( main.camera, main.scene, camera_rotator );
        var d = main.camera.position.length();
        //camera_rotator.remove( main.camera );
        camera_rotator.add(main.camera);
        //console.log("main.camera.position.length()",d);
        main.camera.position.set(0, 0, d);
        main.camera.rotation.set(0, 0, 0);

        scene.updateMatrixWorld();

        // ANIMATE SPHERICAL ROTATION TO ACTIVE HEXAGON
        camera_rotator._anim_progress_ = 0;
        TweenLite.to(camera_rotator, 1.5, {
            _anim_progress_: 1,
            ease: Sine.easeInOut,
            onUpdate: function() {
                THREE.Quaternion.slerp(qstart, qend, camera_rotator.quaternion, camera_rotator._anim_progress_);
                camera_rotator.updateMatrix();
            },
            onComplete: function() {
                var rotation = camera_rotator.rotation,
                    pos = camera_rotator.position;
                //console.log("camera_rotator",rotation,pos);
                //console.log("main.camera",main.camera.rotation,main.camera.position);
                // console.log(main.camera.toJSON());
                //camera_rotator.remove( main.camera );
                //camera_rotator.updateMatrix();
                //main.camera.updateMatrix();
                //main.camera.position.set(pos.x, pos.y, pos.z);
                //main.camera.rotation.set(rotation.x, rotation.y, rotation.z);
                /*              console.log(main.camera.position, camera_rotator.position);
                                console.log(main.camera.rotation, camera_rotator.rotation);*/
                //scene.updateMatrixWorld();
                //scope.state = scope.IDLE;
                scope.activateHexagonF(location);
                /*              scope.commentToggle( true );
                                TweenLite.to( main.camera.position, 1.2, {
                                    z: radius*1.15,
                                    ease: Sine.easeIn,
                                    // onUpdate: function () {
                                    //     main.camera.updateProjectionMatrix();
                                    // },
                                    onComplete: function() {
                                        //console.log("AAA");
                                        //var _href = window.location.href.split("/");
                                        //_href[_href.length - 1] = "map.html#city_id=1";
                                        //window.location.href = _href.join("/");
                                    }
                                });*/

                // show Transition
                //setTimeout( kaspersky.Transition.fadeIn, 400);
                // setTimeout(function () {
                //     //$(document).trigger("page:out");

                //     kaspersky.navigateTo( navigateUrl );

                //     //var _href = window.location.href.split("/");
                //     //_href[_href.length - 1] = ;
                //     //window.location.href = _href.join("/");
                // }, 400);

            }
        });

    }



    // UTILS

    this.isInFrontOfPlanet = function(position) {
        var dist = camera.position.distanceToSquared(position);
        if (dist > camera_dist_to_center) return false;
        // console.log( "isInFrontOfPlanet:", dist, camera.position.distanceTo( position ) );
        return true;
    }

    this.googlePosToUV = function(_u, _v) {
        if (_u === undefined) {
            var a = ('40.705565,-74.1180857').split(",");
            _u = a[0];
            _v = a[1];
        }
        var u = 1 - (parseFloat(_u) + 90) / 180;
        u += .014;
        if (u > 1) u = u - 1;
        var v = (parseFloat(_v) + 180) / 360;
        v -= .031;
        if (v < 0) v = 1 + v;

        // console.log( "u:"+u+", v:"+v+" (U:"+_u+", V:"+_v+")" );
        return { u: u, v: v };
    }


    // INIT THE PLANET
    var _first_year = window.currentYear || PlanetData.year_ids[0];

    /*  setTimeout(function(){
          onReady();
          scope.hidePlanet( undefined, function(){
              scope.showYear( _first_year );
          }, .01 );
      }, 300 );*/

    // onReady();
    // setTimeout(function(){
    //     scope.showYear( _first_year );
    // },100 );

    onReady();
    main.animateOut(.05, function() {
        scope.showYear(_first_year, undefined, 6);
    });

}



Planet.prototype.getClosestLocation = function(intersection) {

    var _location_current;
    var min = isMobile.any ? .15 : .04;
    var _locations = this.planetLocations.current_locations;

    if (_locations){
        for (var i = 0; i < _locations.length; i++) {

            var l = _locations[i];

            // if the location object has no briefs
            if (!l.position) continue;
            if (!PlanetData.hasLocationAnyBriefs(l, true)) continue;

            var d = intersection.distanceToSquared(l.position);
            if (d < min) {
                min = d;
                _location_current = l;
                break;
            }
        };        
    }

    return _location_current;
}


Planet.prototype.getAnyClosestLocation = function(intersection, except_locations) {

    var _location_current;
    var min = 10000;
    var _locations = this.planetLocations.current_locations;

    for (var i = 0; i < _locations.length; i++) {

        var l = _locations[i];

        if (except_locations && checkExceptions(l)) continue;

        var d = intersection.distanceToSquared(l.position);
        if (d < min) {
            min = d;
            _location_current = l;
        }
    };

    function checkExceptions(l) {
        for (var j = 0; j < except_locations.length; j++) {
            if (except_locations[j] == l) return true;
        };
        return false;
    }

    return _location_current;
}

function Hexagon(scene) {

    var active_color = new THREE.Color(0xffffff);
    var inactive_color = new THREE.Color(0x507e50);

    var mesh = Utils.createHexagon(.5);
    // mesh.up = new THREE.Vector3(0,1,0);
    var material = mesh.material;
    material.transparent = true;
    material.opacity = .4;
    material.blending = THREE.AdditiveBlending;
    material.depthWrite = false;

    mesh._anim_progress = .001;
    mesh.scale.set(mesh._anim_progress, mesh._anim_progress, mesh._anim_progress);

    mesh.setToLocation = function(l) {
        // console.log("setToTile: ", l);
        mesh.location = l;

        mesh.position.copy(l.position);
        mesh.lookAt(new THREE.Vector3());

        material.color = active_color;
        scene.add(mesh);
        mesh.matrixAutoUpdate = true;
        TweenLite.killTweensOf(mesh);
        TweenLite.to(mesh, .2, {
            _anim_progress: .8, // * .8,
            // ease: Sine.easeOut,
            onUpdate: function() {
                mesh.scale.set(mesh._anim_progress, mesh._anim_progress, mesh._anim_progress);
            },
            onComplete: function() {
                mesh.matrixAutoUpdate = false;
            }
        });
    }

    mesh.hide = function(_assets) {
        mesh.matrixAutoUpdate = true;
        TweenLite.killTweensOf(mesh);
        TweenLite.to(mesh, 1, {
            _anim_progress: .001,
            // ease: Sine.easeIn,
            onUpdate: function() {
                mesh.scale.set(mesh._anim_progress, mesh._anim_progress, mesh._anim_progress);
            },
            onComplete: function() {
                scene.remove(mesh);
                _assets.push(mesh);
                mesh.matrixAutoUpdate = false;
            }
        });
    }
    /*
        //
        mesh.setActive = function() {
            // console.log("setActive", mesh.tile);
            if( !mesh.tile ) return;
            mesh.is_active = true;

            TweenLite.killTweensOf( mesh );
            mesh._anim_progress = 0;
            TweenLite.to( mesh, .2, {
                _anim_progress: 1,
                // ease: Sine.easeOut,
                onUpdate: function () {
                    var scl = mesh._anim_progress*1+1;
                    mesh.scale.set( scl, scl, scl );
                    mesh.position.copy( mesh.tile.centerPoint ).multiplyScalar( 1 + scl*.05 );
                }
            });
        }

        mesh.setInactive = function( _assets ) {
            // _assets.push( mesh );
            mesh.is_active = false;

            TweenLite.killTweensOf( mesh );
            // mesh._anim_progress = 0;
            TweenLite.to( mesh, .5, {
                _anim_progress: .01,
                // ease: Sine.easeOut,
                onUpdate: function () {
                    mesh.scale.set( mesh._anim_progress, mesh._anim_progress, mesh._anim_progress );
                },
                onComplete: function () {
                    scene.remove( mesh );
                    _assets.push( mesh );
                }
            });
        }
    */
    return mesh;
}

function PlanetLocations(planet) {

    var data = planet.data;
    var data_locations = data.locations;
    var current_container;

    this.current_locations; // a list of locations corresponding to the current year

    var max_opacity = .8;
    var material_yellow = window.material_yellow = new THREE.MeshBasicMaterial({
        transparent: true,
        //alphaTest: .5,
        opacity: 0,
        color: new THREE.Color(0xffde00),
        //color : new THREE.Color( 0xff0000 ),
        blending: THREE.AdditiveBlending,
        side: THREE.DoubleSide,
        depthWrite: false
    });

    var material_white = new THREE.MeshBasicMaterial({
        transparent: true,
        //alphaTest: .5,
        opacity: 0,
        color: new THREE.Color(0xffffff),
        //color : new THREE.Color( 0xff0000 ),
        blending: THREE.AdditiveBlending,
        side: THREE.DoubleSide,
        depthWrite: false,
        //wireframe: true
    });


    // !!! fake locations

    // get image links
    var f_images = [];
    for (var i = 0; i < data_locations.length; i++) {
        f_images.push(data_locations[i].preview);
    }



    // make base location shape
    var hex = Utils.createHexagon(.2, false, undefined); //六边形网格
    //this.container.add( hex );
    // additional shape - the ring
    var hex_ring = Utils.createHexagon(.25, false, undefined, .02); //网格边框
    hex.add(hex_ring);

    // var geo = new THREE.BufferGeometry();

    // console.log("geo:",geo);


    var r = planet.radius * 1.005;
    var zero = new THREE.Vector3();


    // METHODS

    this.init = function(_year) {

        // var year_data = PlanetData.years[_year];

        var container = new THREE.Object3D();
        container.matrixAutoUpdate = false;

        var _locations = container._locations = [];
        for (var i = 0; i < data_locations.length; i++) {
            var l = data_locations[i];
            // console.log( i, "::", _year, l.years[_year].briefs, l );
            // if( l.year == _year ) _locations.push( l );
            _locations.push(l); /// All Locations are available in all Years
        }

        //if( year_data.min_locations && _locations.length < year_data.min_locations ) addFakeLocations( _locations, year_data.min_locations - _locations.length, _year );
        var geo;
        var geo_yellow = new THREE.Geometry(); //hex.geometry.clone();
        var geo_white = new THREE.Geometry(); //hex.geometry.clone();
        //geo_yellow.merge( hex.geometry, hex.matrixWorld );

        for (var i = 0; i < _locations.length; i++) {

            var l = _locations[i];
            var l_year_data = l.years[_year];

            // skip a point creation if the location doesn't have any briefs
            if (!l_year_data.briefs) continue;

            // console.log("add Location", i, l_year_data );

            // get shorthand to a country object of the location
            l.country = data.countries_by_id[l.country_id];

            var uv = planet.googlePosToUV(l.planet_u, l.planet_v);
            Utils.setFromSpherical(r, uv.v, uv.u, hex.position);
            hex.lookAt(zero);
            hex.updateMatrix();
            hex.updateMatrixWorld();

            geo = l_year_data.works ? geo_yellow : geo_white;
            geo.merge(hex.geometry, hex.matrixWorld);
            geo.merge(hex_ring.geometry, hex_ring.matrixWorld);

            l.position = hex.position.clone();

            // and finaly the ray 光柱
            l.light = addLightRay(hex.position, l_year_data.works);
            container.add(l.light);
            //console.log(hex.position);

        };

        console.log(">>>>>>>>>>>>>>>>>>>>>>添加几何标位图", geo_yellow.vertices.length);

        //黄色图标
        var hexs_yellow = window.hexs_yellow = new THREE.Mesh(geo_yellow, material_yellow);
        container.add(hexs_yellow);

        //白色图标
        var hexs_white = new THREE.Mesh(geo_white, material_white);
        container.add(hexs_white);

        return container;
    }



    this.show = function(_year, t) {
        var year_data = PlanetData.years[_year];

        if (!year_data.locations_container) year_data.locations_container = this.init(_year);
        current_container = window.current_container = year_data.locations_container;
        this.current_locations = current_container._locations;

        planet.container.add(current_container);

        _showMaterial(material_yellow, t);
        _showMaterial(material_white, t);
        showRays(t / 2, t / 2);
    }

    function _showMaterial(mat, t) {

        var _anim = 0;
        var t1 = .3;

        mat.opacity = 0;

        TweenLite.killTweensOf(mat);
        TweenLite.to(mat, t1, {
            delay: t - t1,
            // _anim: 201,
            ease: Sine.easeOut,
            onUpdate: function() {
                _anim += 1;
                mat.opacity = Math.round(_anim % 2) * max_opacity;
            },
            onComplete: function() {
                mat.opacity = max_opacity;
            }
        });

    }

    this.hide = function(t) {

        _hideMaterial(material_yellow, t);
        _hideMaterial(material_white, t);
        hideRays(t / 2);
    }

    function _hideMaterial(mat, t) {

        var _anim = 0;

        TweenLite.killTweensOf(mat);
        TweenLite.to(mat, .3, {
            // opacity: 0,
            ease: Sine.easeInOut,
            onUpdate: function() {
                _anim += 1;
                mat.opacity = Math.round(_anim % 2) * max_opacity;
            },
            onComplete: function() {
                console.log("_hideMaterial");
                planet.container.remove(current_container);
            }
        });
    }



    //
    /*  function addFakeLocations( _locations, _amount, _year ){
            
            var projectiveImage = PlanetData.years[ _year ].earth_image;
            console.log( "PlanetData.years: ", PlanetData.years, _year );
            var id = data_locations.length;
            
            for (var i = 0; i < _amount; i++) {
            
                for (var j = 0; j < 10; j++) {
                    var u = Math.random();
                    var v = Math.random()*.5+.25;
                    if( projectiveImage.isLandByUV( u, v ) ) break;
                };

                var _id = id + i;

                var l = {
                    "location_id" : _id,
                    "name": "FAKE LOCATION " + _id,
                    "planet_u" : u,
                    "planet_v" : v,
                    "briefs" : ~~(Math.random()*50),
                    "country_id" : ~~(Math.random()*4+1),
                    "preview" : f_images[ Math.floor(Math.random()*f_images.length) ],
                    "year" : _year
                };

                _locations.push( l );
                data_locations.push( l );
                data.locations_by_id[ _id ] = l;
            };
        }*/



    /*
    ██████╗  █████╗ ██╗   ██╗███████╗
    ██╔══██╗██╔══██╗╚██╗ ██╔╝██╔════╝
    ██████╔╝███████║ ╚████╔╝ ███████╗
    ██╔══██╗██╔══██║  ╚██╔╝  ╚════██║
    ██║  ██║██║  ██║   ██║   ███████║
    ╚═╝  ╚═╝╚═╝  ╚═╝   ╚═╝   ╚══════╝
    */

    var _light_material = new THREE.MeshBasicMaterial({
        transparent: true,
        opacity: .9,
        blending: THREE.AdditiveBlending,
        side: THREE.DoubleSide,
        depthWrite: false,
        fog: true
    });
    var m = _light_material;
    // m.color = new THREE.Color( 0xc3ad32 );
    m.map = planet.textureLoader.load(PlanetData.textures_path + "lightray.jpg"); //,
    m.map.wrapT = THREE.ClampToEdgeWrapping;


    var _light_material_yellow = _light_material.clone();
    _light_material_yellow.map = planet.textureLoader.load(PlanetData.textures_path + "lightray_yellow.jpg"); //,

    function addLightRay(_pos, has_works) {

        var h = Math.random() * 2 + 1;
        var geometry = new THREE.PlaneBufferGeometry(.3, h, 1);
        // var material = new THREE.MeshBasicMaterial( {color: 0xffffff, side: THREE.DoubleSide} );
        var plane = new THREE.Mesh(geometry, has_works ? _light_material_yellow : _light_material);
        var m = new THREE.Matrix4();
        m.makeRotationX(Math.PI / 2);
        m.setPosition(new THREE.Vector3(0, 0, -h / 2));
        geometry.applyMatrix(m);

        // m.identity();
        // m.makeRotationZ( Math.random()*Math.PI );
        // geometry.applyMatrix(m);

        //this.container.add( plane );


        // cross plane of ray
        var plane2 = plane.clone();
        plane.add(plane2);
        plane2.rotation.z = Math.PI / 2;
        plane2.matrixAutoUpdate = false;
        plane2.updateMatrix();

        // main ray plane
        plane.position.copy(_pos);
        plane.lookAt(planet.container.position);
        // console.log( '>', plane.rotation );
        plane.matrixAutoUpdate = false;
        plane.updateMatrix();

        return plane;
    }


    function showRays(t, d) {
        var val = _light_material.map.offset;
        TweenLite.to(val, t, {
            delay: d,
            y: 0,
            ease: Sine.easeInOut
        });
    }

    function hideRays(t) {
        var val = _light_material.map.offset;
        TweenLite.to(val, t, {
            y: -1,
            ease: Sine.easeInOut
        });
    }


}
/*
██████╗  ██████╗ ██╗███╗   ██╗████████╗███████╗
██╔══██╗██╔═══██╗██║████╗  ██║╚══██╔══╝██╔════╝
██████╔╝██║   ██║██║██╔██╗ ██║   ██║   ███████╗
██╔═══╝ ██║   ██║██║██║╚██╗██║   ██║   ╚════██║
██║     ╚██████╔╝██║██║ ╚████║   ██║   ███████║
╚═╝      ╚═════╝ ╚═╝╚═╝  ╚═══╝   ╚═╝   ╚══════╝
*/
// POINTS
Planet.prototype.drawPoints = function(radius) {


    // var _material = new THREE.MeshBasicMaterial({
    // color: 0xffffff, wireframe: true, transparent: true, opacity: .15
    // });
    // _material.depthWrite = false;
    // this.grid_shpere = new THREE.Mesh(_geometry, _material);
    this.grid_shpere = new THREE.Object3D();
    // this.grid_shpere.matrixAutoUpdate = false;
    // this.container.add( this.grid_shpere );

    // XRAY EARTH
    var _geometry = new THREE.SphereGeometry(radius * 1.1, 66, 44);

    var _material = new THREE.XRayMaterial({
        map: this.textureLoader.load(PlanetData.textures_path + "clouds.jpg"),
        alphaProportion: .5,
        color: new THREE.Color(0xfb2f2c5),
        opacity: 1,
        gridOffsetSpeed: .6
    });

    // var _material = new THREE.MeshBasicMaterial();
    // _material.map = this.textureLoader.load( PlanetData.textures_path+"clouds.jpg" );
    var clouds_mesh = new THREE.Mesh(_geometry, _material);
    clouds_mesh.matrixAutoUpdate = false;
    this.container.add(clouds_mesh);

    // !!! TEST

    var total = _geometry.vertices.length * 3;
    var positions = new Float32Array(total);
    var colors = new Float32Array(total);
    var alphas = new Float32Array(total);
    var color = new THREE.Color(0xffffff);

    for (var i = 0; i < _geometry.vertices.length; i++) {
        var v = _geometry.vertices[i];
        var ii = i * 3;
        positions[ii] = v.x;
        positions[ii + 1] = v.y;
        positions[ii + 2] = v.z;
        colors[ii] = color.r;
        colors[ii + 1] = color.g;
        colors[ii + 2] = color.b;
        alphas[Math.floor(ii / 3)] = Math.random() * .3 + .5;
    };



    var geometry = new THREE.BufferGeometry();
    geometry.addAttribute('position', new THREE.BufferAttribute(positions, 3));
    //geometry.addAttribute('color', new THREE.BufferAttribute(colors, 3));
    geometry.addAttribute('alpha', new THREE.BufferAttribute(alphas, 1));
    geometry.computeBoundingSphere();


    var shaderMaterial = new THREE.ShaderMaterial(THREE.AlphaColorShader);
    // console.log("shaderMaterial: ", shaderMaterial);
    shaderMaterial.depthWrite = false;
    shaderMaterial.uniforms.fogNear.value = 10.0;
    shaderMaterial.uniforms.fogFar.value = 20.0;

    // var material = new THREE.PointsMaterial( { size: .05, vertexColors: THREE.VertexColors } );
    // console.log("THREE.PointsMaterial: ", THREE.PointsMaterial);
    var points = new THREE.Points(geometry, shaderMaterial);
    points.matrixAutoUpdate = false;
    this.grid_shpere.add(points);

    // geometry2.addAttribute( 'position', new THREE.BufferAttribute( positions2, 3 ) );
    // geometry2.addAttribute( 'color', new THREE.BufferAttribute( colors2, 3 ) );
    // geometry2.computeBoundingSphere();
    // var material = new THREE.PointsMaterial( { size: .2, vertexColors: THREE.VertexColors } );
    // var points2 = new THREE.Points( geometry2, material );
    // this.container.add( points2 );
}



/*
██████╗  █████╗ ██████╗ ████████╗██╗ ██████╗██╗     ███████╗███████╗
██╔══██╗██╔══██╗██╔══██╗╚══██╔══╝██║██╔════╝██║     ██╔════╝██╔════╝
██████╔╝███████║██████╔╝   ██║   ██║██║     ██║     █████╗  ███████╗
██╔═══╝ ██╔══██║██╔══██╗   ██║   ██║██║     ██║     ██╔══╝  ╚════██║
██║     ██║  ██║██║  ██║   ██║   ██║╚██████╗███████╗███████╗███████║
╚═╝     ╚═╝  ╚═╝╚═╝  ╚═╝   ╚═╝   ╚═╝ ╚═════╝╚══════╝╚══════╝╚══════╝
*/

Planet.prototype.drawParticles = function(radius) {

    var total = 600;
    // var total = (_geometry.vertices.length )*3;
    var positions = new Float32Array(total * 3);
    // var colors = new Float32Array( total*3 );
    // var alphas = new Float32Array( total*3 );
    var color = new THREE.Color(0xfb2f2c5);

    var spherical = new THREE.Spherical();
    var vec3 = new THREE.Vector3();

    // ADDITIVE POINTS
    for (var i = 0; i < total; i++) {
        var ii = i * 3;

        spherical.radius = radius * (1 + Math.random() * .6);
        spherical.theta = Math.random() * 8;
        spherical.phi = .3 + Math.random() * 2.2;
        vec3.setFromSpherical(spherical);

        positions[ii] = vec3.x;
        positions[ii + 1] = vec3.y;
        positions[ii + 2] = vec3.z;

        // colors[ii] = color.r;
        // colors[ii+1] = color.g;
        // colors[ii+2] = color.b;
        // alphas[ Math.floor(ii/3) ] = Math.random()*.3+.7;
    };

    var geometry = new THREE.BufferGeometry();
    geometry.addAttribute('position', new THREE.BufferAttribute(positions, 3));
    // geometry.addAttribute( 'color', new THREE.BufferAttribute( colors, 3 ) );
    // geometry.addAttribute( 'alpha', new THREE.BufferAttribute( alphas, 1 ) );
    geometry.computeBoundingSphere();

    // var material = new THREE.ShaderMaterial( THREE.AlphaColorShader );
    var material = new THREE.PointsMaterial();
    material.size = .1 / this.ratio;
    material.color = color;
    material.transparent = true;
    material.opacity = .6;
    material.blending = THREE.AdditiveBlending;
    // console.log("shaderMaterial: ", shaderMaterial);
    material.depthWrite = false;
    // shaderMaterial.uniforms.fogNear.value = 0.1;
    // shaderMaterial.uniforms.fogFar.value = 20.0;

    var points = new THREE.Points(geometry, material);
    points.matrixAutoUpdate = false;

    this.particles = new THREE.Object3D();
    this.scene.add(this.particles);
    this.particles.add(points);
}


/*
██████╗ ██╗███╗   ██╗ ██████╗ 
██╔══██╗██║████╗  ██║██╔════╝ 
██████╔╝██║██╔██╗ ██║██║  ███╗
██╔══██╗██║██║╚██╗██║██║   ██║
██║  ██║██║██║ ╚████║╚██████╔╝
╚═╝  ╚═╝╚═╝╚═╝  ╚═══╝ ╚═════╝ 
*/
// 
Planet.prototype.drawRing = function(position, radius, width, rotation, dont_orient) {

    /*
        var geometry = new THREE.CylinderBufferGeometry( radius, radius, .1, 64, 1, true );
        var m = new THREE.Matrix4();
        m.makeRotationX( Math.PI/2 );
        // m.setPosition( new THREE.Vector3(0, 0, -h/2) );
        geometry.applyMatrix(m);
    */

    var geometry = new THREE.RingGeometry(radius, radius + width, 64, 1);
    var m = new THREE.Matrix4();
    if (!dont_orient) {
        m.makeRotationX(Math.PI / 2);
    } else {
        // m.makeRotationY( Math.PI/2 );
        m.setPosition(new THREE.Vector3(0, 0, radius * .29));
    }
    geometry.applyMatrix(m);

    var material = new THREE.MeshBasicMaterial({ color: this.planet_color, side: THREE.DoubleSide });
    material.transparent = true;
    material.opacity = Math.random() * .2 + .1;
    material.blending = THREE.AdditiveBlending;
    material.depthWrite = false;
    // material.fog = false;
    var cylinder = new THREE.Mesh(geometry, material);
    cylinder.rotation.set(rotation.x, rotation.y, rotation.z);
    cylinder.position.set(position.x, position.y, position.z);

    // cylinder.matrixAutoUpdate = false;

    this.container.add(cylinder);
    return cylinder;
}


// ORBITAS
Planet.prototype.drawOrbitas = function() {
    // draw ORBITAS
    this.orbits = [];

    for (var i = 0; i < this.radius; i += 3) {
        // var position = new THREE.Vector3( 0, Math.random() * radius * 2 - radius , 0 );
        var position = new THREE.Vector3(0, i, 0);
        var p = Math.cos(position.y / this.radius);
        // console.log( ">>>", position.y, p );
        p += Math.random() > .8 ? Math.random() * .7 : Math.random() * .2;
        var rotation = new THREE.Vector3(Math.random() * Math.PI, 0, Math.random() * Math.PI);
        // this.drawRing( position, radius * (Math.random()*.4 + .9), Math.random()*.1 + .02,  rotation );
        position.y = 0;
        var orbit = this.drawRing(position, this.radius * 1.1, Math.random() * .05 + .02, rotation);
        var speed_x = Utils.getRandSides(.002);
        var speed_y = Utils.getRandSides(.002);
        var speed_z = Utils.getRandSides(.002);
        orbit._increment = new THREE.Vector3(speed_x, speed_y, speed_z);
        this.orbits.push(orbit);
    };
    // console.log("> ", this.orbits.length);
}

/*
██████╗  ██████╗ 
██╔══██╗██╔════╝ 
██████╔╝██║  ███╗
██╔══██╗██║   ██║
██████╔╝╚██████╔╝
╚═════╝  ╚═════╝ 
*/

Planet.prototype.drawDisplayBoxImage = function() {

    if (!CheckCurrentOs().isPc) {
        var groundBg = document.createElement("div");
        groundBg.style["background-image"] = "url(assets/earth/img/background.jpg)";
        groundBg.id = "groundBg";
        groundBg.style.width = window.innerWidth + "px";
        groundBg.style.height = window.innerHeight + "px";
        groundBg.style.position = "absolute";
        groundBg.style["background-size"] = "100% 100%";
        groundBg.style["background-repeat"] = "no-repeat";
        groundBg.style.top = "0px";
        document.body.appendChild(groundBg);
    }

    if(CheckCurrentOs().isPc){

        var loginDiv = document.createElement("div");
        loginDiv.id = "loginDivID";
        loginDiv.style.width = "200px";
        loginDiv.style.height = "160px";
        loginDiv.style.top = "50px";
        loginDiv.style.right = "350px";
        loginDiv.style.position = "absolute";
        document.body.appendChild(loginDiv);

        var loginBtn = document.createElement("div");
        loginBtn.style["background-image"] = "url(assets/earth/img/login.png)";
        loginBtn.id = "loginBtn";
        loginBtn.style.width = "120px";
        loginBtn.style.height = "47px";
        loginBtn.style.position = "absolute";
        loginBtn.style["background-size"] = "100% 100%";
        loginBtn.style["background-repeat"] = "no-repeat";
        loginBtn.style.top = "0px";
        loginBtn.style.right = "0px";
        loginBtn.addEventListener("click", loginBtnClick);
        loginDiv.appendChild(loginBtn);
        
        var loginText = document.createElement("div");
        loginText.id = "loginText";
        loginText.innerText = "登录";
        loginText.style.width = "80px";
        loginText.style.height = "47px";
        loginText.style["text-align"] = "center";
        loginText.style["line-height"] = "47px";
        loginText.style.fontSize = "22px";
        loginText.style.color = "white";
        loginText.style.left = "0px";
        loginBtn.appendChild(loginText);

        var loginjt = document.createElement("div");
        loginjt.style["background-image"] = "url(assets/earth/img/jiantou.png)";
        loginjt.style.width = "20px";
        loginjt.style.height = "11px";
        loginjt.style.position = "absolute";
        loginjt.style["background-size"] = "100% 100%";
        loginjt.style["background-repeat"] = "no-repeat";
        loginjt.style.top = "18px";
        loginjt.style.right = "20px";
        loginBtn.appendChild(loginjt);        

        var choiceBg = document.createElement("div");
        choiceBg.style["background-image"] = "url(assets/earth/img/loginBg.png)";
        choiceBg.style.width = "200px";
        choiceBg.id = "choiceBg";
        choiceBg.style.height = "113px";
        choiceBg.style.position = "absolute";
        choiceBg.style["background-size"] = "100% 100%";
        choiceBg.style["background-repeat"] = "no-repeat";
        choiceBg.style.bottom = "0px";
        choiceBg.style.left = "5px";
        choiceBg.style.display = "none";
        loginDiv.appendChild(choiceBg);

        for(var i = 0; i < 2; i++){
            var walletDiv = document.createElement("div");
            walletDiv.style.position = "absolute";
            walletDiv.style.width = "150px";
            walletDiv.style.height = "50px";
            walletDiv.style.top = 10 + i*45 + "px";
            walletDiv.style.left = "25px";
            choiceBg.appendChild(walletDiv);

            var wallBtnBg = document.createElement("div");
            wallBtnBg.style["background-image"] = "url(assets/earth/img/beijing1.png)";
            wallBtnBg.style.width = "150px";
            wallBtnBg.style.height = "40px";
            wallBtnBg.style.position = "absolute";
            wallBtnBg.style["background-size"] = "100% 100%";
            wallBtnBg.style["background-repeat"] = "no-repeat";
            wallBtnBg.style.top = "5px";
            wallBtnBg.id = "wallBtnBg_" + i;
            wallBtnBg.innerText = i == 0?"钱包登录":"私钥登录";
            wallBtnBg.style["text-align"] = "center";
            wallBtnBg.style["line-height"] = "40px";
            wallBtnBg.style.fontSize = "20px";
            wallBtnBg.addEventListener("mousedown", wallBtnDown);
            wallBtnBg.addEventListener("mouseup", wallBtnClick);
            wallBtnBg.addEventListener("mouseout", wallBtnOut);
            wallBtnBg.setAttribute("wallIndex", i.toString());
            walletDiv.appendChild(wallBtnBg);         
        } 

        function loginBtnClick(event){
/*            event = event || window.event;
            var target = event.target || event.srcElement;*/
            choiceBg.style.display = choiceBg.style.display == "none"?"block":"none";         
        }

        function wallBtnDown(event){
            event = event || window.event;
            var target = event.target || event.srcElement; 
            target.style["background-image"] = "url(assets/earth/img/beijing_curr.png)";        
        }

        async function wallBtnClick(event){
            event = event || window.event;
            var target = event.target || event.srcElement;
            target.style["background-image"] = "url(assets/earth/img/beijing1.png)";
            var curIndex = parseInt(target.getAttribute("wallIndex"));
            choiceBg.style.display = choiceBg.style.display == "none"?"block":"none"; 
            if(gameInfo.accountsInfo){
                var msg = (languageType == 0) ? "钱包已登录!" : "Wallet is logged in!";
                msgTip(msg);
                return;                
            }
            if(curIndex == 0){
                var identity = await window.scatter.getIdentity({ "accounts": [network] }).catch(function(error) {
                    console.log(error);
                });
                if (identity) {
                    gameInfo.accountsInfo = identity.accounts[0];
                    console.log(gameInfo.accountsInfo);
                    initEosInfo();
                }
            }else{
                createEosKeyLogin();
            }
        }

        function wallBtnOut(event){
            event = event || window.event;
            var target = event.target || event.srcElement;
            target.style["background-image"] = "url(assets/earth/img/beijing1.png)";            
        }        
    }

    var logo = document.createElement("div");
    logo.id = "logoImg";
    logo.style.left = "30px";
    logo.style.top = "20px";
    if (CheckCurrentOs().isPc) {
        logo.style.width = "184px";
        logo.style.height = "120px";
    } else {
        logo.style.width = "110px";
        logo.style.height = "78px";
    }
    logo.style.position = "absolute";
    logo.style["background-image"] = "url(assets/earth/img/logoImg.png)";
    logo.style["background-size"] = "100% 100%";
    logo.style["background-repeat"] = "no-repeat";
    document.body.appendChild(logo);

    var audio = document.createElement("AUDIO");
    audio.id = "gameAudio";
    audio.src = "assets/earth/videoplayback.mp3";
    audio.loop = true;
    audio.autoplay = true;
    document.body.appendChild(audio);

    if (CheckCurrentOs().isPc) {
        pcTopDiv();
    } else {
        mobileTopDiv();
    }

    var languageDiv = document.createElement("div");
    languageDiv.style.position = "absolute";
    languageDiv.id = "languageDiv";
    if (CheckCurrentOs().isPc) {
        languageDiv.style.width = "260px";
        languageDiv.style.height = "60px";
        languageDiv.style.top = "50px";
        languageDiv.style.right = "34px";
    } else {
        languageDiv.style.width = "160px";
        languageDiv.style.height = "40px";
        languageDiv.style.top = "15px";
        languageDiv.style.right = "0px";
    }
    document.body.appendChild(languageDiv);

    var strLang = ["CN", "EN"];
    for (var i = 0; i < 2; i++) {
        var cnDiv = document.createElement("div");
        cnDiv.style.position = "absolute";
        cnDiv.id = "cnDiv_" + i;
        cnDiv.innerText = strLang[i];
        cnDiv.style["text-align"] = "center";
        if (CheckCurrentOs().isPc) {
            cnDiv.style.left = 20 + 60 * i + "px";
            cnDiv.style.top = "0px";
            cnDiv.style.width = "50px";
            cnDiv.style.height = "50px";
            cnDiv.style["line-height"] = "50px";
            cnDiv.style["font-size"] = "24px";
        } else {
            cnDiv.style.left = 40 * i + "px";
            cnDiv.style.top = "0px";
            cnDiv.style.width = "40px";
            cnDiv.style.height = "40px";
            cnDiv.style["line-height"] = "40px";
            cnDiv.style["font-size"] = "18px";
        }
        cnDiv.style.color = (i == 0) ? "#00ed9b" : "white";
        cnDiv.setAttribute("cnIndex", i.toString());
        cnDiv.addEventListener("click", cnDivBtnClick);
        languageDiv.appendChild(cnDiv);
    }

    function cnDivBtnClick(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        var curIndex = parseInt(target.getAttribute("cNIndex"));
        for (var i = 0; i < 2; i++) {
            var cnDiv = document.getElementById("cnDiv_" + i);
            cnDiv.style.color = "#b7b7b7";
        }
        target.style.color = "#00ed9b";
        languageType = curIndex;
        refreshLanguage();
    }

    var languageImage = document.createElement("div");
    languageImage.style.position = "absolute";
    languageImage.id = "languageImage";
    if (CheckCurrentOs().isPc) {
        languageImage.style.left = "140px";
        languageImage.style.width = "103px";
        languageImage.style.height = "55px";
    } else {
        languageImage.style.left = "84px";
        languageImage.style.width = "70px";
        languageImage.style.height = "40px";
    }
    languageImage.addEventListener("click", redioBtnClick)
    languageDiv.appendChild(languageImage);

    for (var i = 0; i < 20; i++) {
        var lImage = document.createElement("div");
        lImage.id = "lImage_" + i;
        lImage.style.width = languageImage.offsetWidth / 50 + "px";
        lImage.style.height = languageImage.offsetHeight + "px";
        lImage.style["background-color"] = "cyan";
        lImage.style.left = languageImage.offsetWidth / 50 * i + 2 * i + "px";
        lImage.style.top = "0px";
        lImage.style.position = "absolute";
        languageImage.appendChild(lImage);
    }

    languageImage.iterval = setInterval(function() {
        var firstRandom = Math.random() * 0.6;
        var isFloor = false;
        for (var i = 0; i < 20; i++) {
            var lImage = document.getElementById("lImage_" + i);
            var random = isFloor ? firstRandom + 0.1 : firstRandom - 0.1;
            if (random >= 0.6) {
                isFloor = false;
                firstRandom = Math.random() * 0.6;
                random = firstRandom;
            } else if (random <= 0) {
                isFloor = true;
                firstRandom = Math.random() * 0.6;
                random = firstRandom;
            } else {
                firstRandom = random;
            }
            lImage.style.transform = "scaleY(" + random + ")";
        }
    }, 400);

    function redioBtnClick(event) {
        if (languageImage.iterval) {
            clearInterval(languageImage.iterval);
        }

        if (audio.paused) {
            audio.play();
            languageImage.iterval = setInterval(function() {
                var firstRandom = Math.random() * 0.6;
                var isFloor = false;
                for (var i = 0; i < 20; i++) {
                    var lImage = document.getElementById("lImage_" + i);
                    var random = isFloor ? firstRandom + 0.1 : firstRandom - 0.1;
                    if (random >= 0.6) {
                        isFloor = false;
                        firstRandom = Math.random() * 0.6;
                        random = firstRandom;
                    } else if (random <= 0) {
                        isFloor = true;
                        firstRandom = Math.random() * 0.6;
                        random = firstRandom;
                    } else {
                        firstRandom = random;
                    }
                    lImage.style.transform = "scaleY(" + random + ")";
                    lImage.style["background-color"] = "cyan";
                }
            }, 400);
        } else {
            audio.pause();
            for (var i = 0; i < 20; i++) {
                var lImage = document.getElementById("lImage_" + i);
                lImage.style["background-color"] = "#838B83";
            }
        }

    }

    if (CheckCurrentOs().isPc) {
        createTimeDiv();
    } else {
        createUseInfo();
        createGameInfo();
        createMobileTimeDiv();
        //createAssets();
    }

    createUI();

    if (!CheckCurrentOs().isPc) {
        //底部按钮
        createMobileItem();
    }

    var uiDiv = document.createElement("div");
    uiDiv.id = "uiDiv";
    uiDiv.style.position = "absolute";
    uiDiv.style.width = window.innerWidth + "px";
    uiDiv.style.height = window.innerHeight + "px";
    uiDiv.style["background-color"] = "rgba(0,0,0,0.8)";
    uiDiv.style.top = "0px";
    uiDiv.style.visibility = "hidden";
    document.body.appendChild(uiDiv);
}

function createEosKeyLogin(){
    var msgDiv = document.getElementById("msgDiv");
    if (msgDiv) {
        msgDiv.remove();
    }

    var uiDiv = document.getElementById("uiDiv");
    uiDiv.style.visibility = "visible";

    var keyLoginBg = document.createElement("div");
    keyLoginBg.style["background-image"] = "url(assets/earth/tips/bg_background_1.png)";
    keyLoginBg.style.width = "747px";
    keyLoginBg.id = "keyLoginBg";
    keyLoginBg.style.height = "420px";
    keyLoginBg.style.position = "absolute";
    keyLoginBg.style["background-size"] = "100% 100%";
    keyLoginBg.style["background-repeat"] = "no-repeat";
    keyLoginBg.style.left = window.innerWidth*0.5 - 747*0.5 + "px";
    keyLoginBg.style.top = window.innerHeight*0.5 - 210 + "px";
    uiDiv.appendChild(keyLoginBg);

    var title = document.createElement("div");
    title.style.position = "absolute";
    title.style.width = keyLoginBg.offsetWidth + "px";
    title.style.height = "100px";
    title.style["text-align"] = "center";
    title.style["line-height"] = "100px";
    title.style["font-size"] = "50px";
    title.style.top = "-60px";
    keyLoginBg.appendChild(title);

    var titleText = document.createElement("div");
    titleText.innerText = languageType == 0?"私钥登录":"Private key login";
    title.appendChild(titleText);


    var inputBg = document.createElement("div");
    inputBg.style.width = "568px";
    inputBg.style.height = "75px";
    inputBg.style.position = "absolute";
    inputBg.style["background-image"] = "url(assets/earth/tips/input_bg.png)";
    inputBg.style["background-size"] = "100% 100%";
    inputBg.style["background-repeat"] = "no-repeat";
    inputBg.style.left = "100px";
    inputBg.style.top = "120px";
    keyLoginBg.appendChild(inputBg);

    var rechargeText = document.createElement("div");
    rechargeText.style["text-align"] = "center";
    rechargeText.style["line-height"] = "74px";
    rechargeText.style.width = "170px";
    rechargeText.style.height = "74px";
    rechargeText.style["font-size"] = "32px";
    inputBg.appendChild(rechargeText);

    var rechargeInfo = document.createElement("div");
    rechargeInfo.innerText = languageType == 0?"私钥":"KEY";
    rechargeText.appendChild(rechargeInfo);

    //输入框
    var inputText = document.createElement("input");
    inputText.type = "text";
    inputText.value = "";
    inputText.style["text-align"] = "center";
    inputText.style["vertical-align"] = "middle";
    inputText.style.position = "absolute";
    inputText.style.top = "0px";
    inputText.style.left = "172px";
    inputText.style.width = "395px";
    inputText.style.height = "75px";
    inputText.style.border = "none";
    inputText.style.background = "rgba(255,255,255,0)";
    inputText.style.color = "#ffff4c";
    inputText.style.fontSize = "32px";
    inputText.setAttribute("placeholder", (languageType == 0) ? "输入私钥" : "Enter the private key");
    inputBg.appendChild(inputText);

    var tipText = document.createElement("div");
    tipText.innerText = languageType == 0?"请放心输入私钥，只会用于本地交易签名!":"Private key, only for local transaction signatures";
    tipText.style.width = "747px";
    tipText.style.height = "40px";
    tipText.style.position = "absolute";
    tipText.style.top = "210px";
    tipText.style["text-align"] = "center";
    tipText.style["line-height"] = "40px";
    tipText.style.fontSize = "20px";
    keyLoginBg.appendChild(tipText);

    var btnStr = (languageType == 0) ? ["取消", "确定"] : ["Cancel", "Confirm"];
    for (var i = 0; i < 2; i++) {
        var curBtn = document.createElement("div");
        curBtn.innerHTML = btnStr[i];
        curBtn.style["text-align"] = "center";
        curBtn.style["line-height"] = "70px";
        curBtn.style.position = "absolute";
        curBtn.style["font-size"] = "24px";
        curBtn.style.top = "283px";
        curBtn.style.left = (340 * i + 80) + "px";
        curBtn.style.width = "249px";
        curBtn.style.height = "77px";

        if (i == 0) {
            curBtn.style.color = "#00ed9b";
            curBtn.style["background-image"] = "url(assets/earth/tips/btn_cancle.png)";
        } else {
            curBtn.style["background-image"] = "url(assets/earth/tips/btn_ok.png)";
        }

        curBtn.style["background-size"] = "100% 100%";
        curBtn.style["background-repeat"] = "none";
        curBtn.addEventListener("mousedown", curBtnDownFunc);
        curBtn.addEventListener("mouseout", curBtnOutFunc);
        curBtn.addEventListener("click", curBtnUpFunc);
        curBtn.setAttribute("index", i.toString());
        keyLoginBg.appendChild(curBtn);
    }

    function curBtnDownFunc(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        target.style["background-image"] = "url(assets/earth/tips/btn_press.png)";
        var curIndex = parseInt(target.getAttribute("index"));
        if (curIndex == 0) {
            target.style.color = "#ffffff";
        }
    }

    function curBtnOutFunc(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        var curIndex = parseInt(target.getAttribute("index"));
        if (curIndex == 0) {
            target.style.color = "#00ed9b";
            target.style["background-image"] = "url(assets/earth/tips/btn_cancle.png)";
        } else {
            target.style["background-image"] = "url(assets/earth/tips/btn_ok.png)";
        }
    }

    async function curBtnUpFunc(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        var curIndex = parseInt(target.getAttribute("index"));
        if (curIndex == 0) {
            target.style.color = "#00ed9b";
            target.style["background-image"] = "url(assets/earth/tips/btn_cancle.png)";
        } else {
            target.style["background-image"] = "url(assets/earth/tips/btn_ok.png)";
        }
        keyLoginBg.remove();
        uiDiv.style.visibility = "hidden";
        if(curIndex == 1){
            if(inputText.value == ""){
                var msg = (languageType == 0) ? "请输入正确的私钥!" : "Please enter a private key!";
                msgTip(msg);
            }else{
                var publickey = "";
                setTimeout(function(){if(publickey == ""){
                    var msg = (languageType == 0) ? "请输入正确的私钥!" : "Please enter a private key!";
                    msgTip(msg);  
                }},2000);
                publickey = eosjs_ecc.privateToPublic(inputText.value);
                if(publickey == ""){
                    var msg = (languageType == 0) ? "请输入正确的私钥!" : "Please enter a private key!";
                    msgTip(msg);                        
                }else{
                    var msg = (languageType == 0) ? "登录成功!" : "Login Success!";
                    msgTip(msg); 
                    var config = {
                        chainId: '1c6ae7719a2a3b4ecb19584a30ff510ba1b6ded86e1fd8b8fc22f1179c622a32', // 32 byte (64 char) hex string
                        keyProvider: [inputText.value], // WIF string or array of keys..
                        httpEndpoint: 'http://180.76.108.100:8000',
                        expireInSeconds: 60,
                        broadcast: true,
                        verbose: false, // API activity
                        sign: true
                    };

                    var eosKey = window.eos = Eos(config);
                    var accountName = "";
                    eosKey.getKeyAccounts({public_key:publickey}).then((resp) => {
                        accountName = resp.account_names[0];
                        eosKey.getAccount({account_name:accountName}).then((resp) =>{
                            var info = {};
                            info.name = resp.account_name;
                            info.balance = resp.core_liquid_balance;
                            gameInfo.accountsInfo = info;
                            initEosKeyInfo();
                            var loginText = document.getElementById("loginText");
                            loginText.innerText = languageType == 0?"已登录":"Logined";
                        })                            
                    });
                }
            }
        }
    }
}

function createUseInfo() {
    var imageBg = document.createElement("div");
    imageBg.id = "useInfoBg";
    imageBg.style.position = "absolute";
    imageBg.style.width = window.innerWidth + "px";
    imageBg.style.height = offsetView(2, 150);
    imageBg.style.top = offsetView(2, 180);
    //imageBg.style["background-color"] = "red";
    imageBg.style.visibility = "hidden";
    document.body.appendChild(imageBg);

    var buyUseInfo = document.createElement("div");
    buyUseInfo.style["background-image"] = "url(assets/earth/img/zuijin.png)";
    buyUseInfo.style["margin"] = 40 / mobileHeight * window.innerHeight + "px " + (window.innerWidth - 266 / mobileWidth * window.innerWidth) * 0.5 + "px";
    buyUseInfo.style.position = "absolute";
    buyUseInfo.style.width = offsetView(1, 266);
    buyUseInfo.style.height = offsetView(2, 70);
    buyUseInfo.style["background-size"] = "100% 100%";
    buyUseInfo.style["background-repeat"] = "no-repeat";
    imageBg.appendChild(buyUseInfo);

    var useTeamImage = document.createElement("div");
    useTeamImage.style["background-image"] = "url(assets/earth/tips/icon_1.png)";
    useTeamImage.id = "useTeamImage";
    useTeamImage.style.width = offsetView(3, 70);
    useTeamImage.style.height = offsetView(3, 70);
    useTeamImage.style["background-size"] = "100% 100%";
    useTeamImage.style["background-repeat"] = "no-repeat";
    useTeamImage.style["margin-left"] = offsetView(1, 5);
    useTeamImage.style.position = "absolute";
    buyUseInfo.appendChild(useTeamImage);

    var useNameDiv = document.createElement("div");
    useNameDiv.id = "useNameDiv";
    useNameDiv.style.width = offsetView(1, 180);
    useNameDiv.style.height = offsetView(2, 32);
    useNameDiv.style["text-align"] = "center";
    useNameDiv.style["line-height"] = offsetView(2, 32);
    useNameDiv.innerText = "";
    useNameDiv.style.fontSize = offsetView(3, 16);
    useNameDiv.style.right = "0px";
    useNameDiv.style.position = "absolute";
    useNameDiv.style.color = "black";
    buyUseInfo.appendChild(useNameDiv);

    var useTimeDiv = document.createElement("div");
    useTimeDiv.id = "useTimeDiv";
    useTimeDiv.style.width = offsetView(1, 190);
    useTimeDiv.style.height = offsetView(2, 32);
    useTimeDiv.style["text-align"] = "center";
    useTimeDiv.style["line-height"] = offsetView(2, 32);
    useTimeDiv.innerText = "";
    useTimeDiv.style.fontSize = offsetView(3, 16);
    useTimeDiv.style.right = "0px";
    useTimeDiv.style.position = "absolute";
    useTimeDiv.style.bottom = "0px";
    buyUseInfo.appendChild(useTimeDiv);
}

function offsetView(type, num) {
    if (type == 1) {
        return num / mobileWidth * window.innerWidth + "px";
    } else if (type == 2) {
        return num / mobileHeight * window.innerHeight + "px";
    } else if (type == 3) {
        return (num / mobileHeight * window.innerHeight + num / mobileWidth * window.innerWidth) * 0.5 + "px";
    }
}

function createAssets() {
    var div = document.createElement("div");
    div.id = "assetsDiv";
    div.style.position = "absolute";
    div.style.width = window.innerWidth + "px";
    div.style.height = offsetView(2, 220);
    div.style.bottom = offsetView(2, 85);
    div.style.left = "0px";
    document.body.appendChild(div);

    for (var i = 0; i < 2; i++) {
        var curDiv = document.createElement("div");
        curDiv.style.position = "absolute";
        curDiv.style.width = window.innerWidth * 0.5 + "px";
        curDiv.style.height = offsetView(2, 220);
        curDiv.style[i == 0 ? "left" : "right"] = "0px";
        div.appendChild(curDiv);

        var divBg = document.createElement("div");
        divBg.style.position = "absolute";
        divBg.style.margin = offsetView(2, 8) + " " + offsetView(1, 10);
        divBg.style.width = offsetView(1, 187);
        divBg.style.height = offsetView(2, 204);
        divBg.style["background-color"] = "rgba(0, 237, 155,0.2)";
        curDiv.appendChild(divBg);

        var _topDiv = document.createElement("div");
        _topDiv.style.position = "absolute";
        _topDiv.style.width = offsetView(1, 187);
        _topDiv.style.height = offsetView(2, 124);
        _topDiv.style.top = "0px";
        divBg.appendChild(_topDiv);

        var imageBg = document.createElement("div");
        imageBg.style["background-image"] = i == 0 ? "url(assets/earth/img/time.png)" : "url(assets/earth/img/eosimg.png)";
        imageBg.style.position = "absolute";
        imageBg.style.width = i == 0 ? offsetView(3, 100) : offsetView(3, 74);
        imageBg.style.height = offsetView(3, 100);
        imageBg.style["background-size"] = "100% 100%";
        imageBg.style["background-repeat"] = "no-repeat";
        imageBg.style.margin = i == 0 ? offsetView(2, 12) + " " + offsetView(1, 43.5) : offsetView(2, 12) + " " + offsetView(1, 56.5);
        _topDiv.appendChild(imageBg);

        var _bottomDiv = document.createElement("div");
        _bottomDiv.style.position = "absolute";
        _bottomDiv.style.width = offsetView(1, 187);
        _bottomDiv.style.height = offsetView(2, 80);
        _bottomDiv.style.bottom = "0px";
        divBg.appendChild(_bottomDiv);

        var titleDiv = document.createElement("div");
        titleDiv.style.position = "absolute";
        titleDiv.style.width = offsetView(1, 187);
        titleDiv.style.height = offsetView(2, 35);
        titleDiv.style.top = "0px";
        _bottomDiv.appendChild(titleDiv);

        var titleValue = document.createElement("div");
        titleValue.style.position = "absolute";
        titleValue.style.width = offsetView(1, 187);
        titleValue.style.height = offsetView(2, 35);
        titleValue.style["line-height"] = offsetView(2, 35);
        titleValue.style.left = offsetView(1, 15);
        titleValue.innerText = i == 0 ? "Time：" : "奖池：";
        titleValue.id = i == 0 ? "leftTitle" : "rightTitle";
        titleValue.style.fontSize = offsetView(3, 18);
        titleDiv.appendChild(titleValue);

        var titleDiv = document.createElement("div");
        titleDiv.style.position = "absolute";
        titleDiv.style.width = offsetView(1, 187);
        titleDiv.style.height = offsetView(2, 35);
        titleDiv.style.bottom = offsetView(2, 10);
        _bottomDiv.appendChild(titleDiv);

        var titleValue = document.createElement("div");
        titleValue.style.position = "absolute";
        titleValue.style.width = offsetView(1, 187);
        titleValue.style.height = offsetView(2, 35);
        titleValue.style["line-height"] = offsetView(2, 35);
        titleValue.innerText = "";
        titleValue.id = i == 0 ? "showTimeText" : "rewardValue";
        titleValue.style.fontSize = offsetView(3, 24);
        if (i == 1) {
            titleValue.style["-webkit-text-stroke"] = "2px red";
            titleValue.style.color = "white";
            titleValue.style["font-family"] = "fantasy";
            titleValue.style.left = offsetView(1, 15);
        } else {
            titleValue.style.margin = "0 auto";
            titleValue.style["text-align"] = "center";
        }
        titleDiv.appendChild(titleValue);
    }
}

function createGameInfo() {
    var jackpotDiv = document.createElement("div");
    jackpotDiv.id = "jackpotDiv";
    jackpotDiv.style.position = "absolute";
    jackpotDiv.style.width = window.innerWidth + "px";
    jackpotDiv.style.height = offsetView(2, 120);
    jackpotDiv.style.top = offsetView(2, 340);
    document.body.appendChild(jackpotDiv);

    var jackTop = document.createElement("div");
    jackTop.style.width = window.innerWidth + "px";
    jackTop.style.height = offsetView(2, 70);
    jackTop.style.top = "0px";
    jackTop.style.position = "absolute";
    jackpotDiv.appendChild(jackTop);

    var rewardValueDiv = document.createElement("div");
    rewardValueDiv.style.width = window.innerWidth * 0.7 + "px";
    rewardValueDiv.style.height = offsetView(2, 70);
    rewardValueDiv.style.top = "0px";
    rewardValueDiv.style.left = "0px";
    rewardValueDiv.style.position = "absolute";
    jackTop.appendChild(rewardValueDiv);

    var rewardValue = document.createElement("div");
    rewardValue.id = "rewardValue";
    rewardValue.style.width = window.innerWidth * 0.7 + "px";
    rewardValue.style.height = offsetView(2, 70);
    rewardValue.style["text-align"] = "right";
    rewardValue.style["line-height"] = offsetView(2, 70);
    //rewardValue.style["-webkit-text-stroke"] = "2px red";
    rewardValue.style.color = "white";
    //rewardValue.style["font-family"] = "fantasy";
    rewardValue.style.position = "absolute";
    rewardValue.style.fontSize = offsetView(3,30);
    rewardValue.style.right = offsetView(1,30);
    rewardValueDiv.appendChild(rewardValue);

    var rewardImgDiv = document.createElement("div");
    rewardImgDiv.style.width = window.innerWidth * 0.3 + "px";
    rewardImgDiv.style.height = offsetView(2, 70);
    rewardImgDiv.style.top = "0px";
    rewardImgDiv.style.right = "0px";
    rewardImgDiv.style.position = "absolute";
    jackTop.appendChild(rewardImgDiv);

    var imageBg = document.createElement("div");
    imageBg.style["background-image"] = "url(assets/earth/img/eosimg.png)";
    imageBg.style.position = "absolute";
    imageBg.style.width = offsetView(1, 48);
    imageBg.style.height = offsetView(2, 60);
    imageBg.style["background-size"] = "100% 100%";
    imageBg.style["background-repeat"] = "no-repeat";
    imageBg.style.left = offsetView(1,-28);
    imageBg.style.top = offsetView(2,5);
    rewardImgDiv.appendChild(imageBg);

    var jackBot = document.createElement("div");
    jackBot.style.width = window.innerWidth + "px";
    jackBot.style.height = offsetView(2, 50);
    jackBot.style.bottom = "0px";
    jackBot.style.position = "absolute";
    jackpotDiv.appendChild(jackBot);

    var showTimeText = document.createElement("div");
    showTimeText.id = "showTimeText";
    showTimeText.style.width = window.innerWidth + "px";
    showTimeText.style.height = offsetView(2, 50);
    showTimeText.style["text-align"] = "center";
    showTimeText.style["line-height"] = offsetView(2, 50);
    showTimeText.style.fontSize = offsetView(3, 30);
    jackBot.appendChild(showTimeText);

}

function createMobileTimeDiv() {
    var showDiv = document.createElement("div");
    showDiv.id = "showDiv";
    showDiv.style.position = "absolute";
    showDiv.style.width = window.innerWidth + "px";
    showDiv.style.height = offsetView(2, 50);
    showDiv.style.top = offsetView(2, 470);
    showDiv.style["text-align"] = "center";
    document.body.appendChild(showDiv);

    var rewardDivBg = document.createElement("div");
    rewardDivBg.id = "rewardDivBg";
    rewardDivBg.style.position = "absolute";
    rewardDivBg.style.width = window.innerWidth + "px";
    rewardDivBg.style.height = offsetView(2, 50);
    rewardDivBg.style["line-height"] = offsetView(2, 50);
    rewardDivBg.style["text-align"] = "center";
    showDiv.appendChild(rewardDivBg);

    var timeDiv = document.createElement("div");
    timeDiv.id = "timeDiv";
    timeDiv.style.width = offsetView(1, 390);
    timeDiv.style.height = offsetView(2, 50);
    timeDiv.style.margin = "0 " + offsetView(1, 12);
    timeDiv.style.position = "absolute";
    timeDiv.style["background-color"] = "rgba(255,215,0,0.4)";
    timeDiv.style["border-radius"] = "5px";
    rewardDivBg.appendChild(timeDiv);

    var curVa = 0.4;
    timeDiv.interVal = setInterval(function() {
        var nexVa = (curVa + 0.05 < 0.7) ? (curVa + 0.05) : 0.1;
        timeDiv.style["background-color"] = (gameMode == 1) ? "rgba(255,215,0," + nexVa + ")" : "rgba(17,128,236," + nexVa + ")";
        $("#tipDivBg")[0].style["background-color"] = (gameMode == 1) ? "#caca0d" : "#1180ec";
        curVa = nexVa;
    }, 60);

    var tipDivBg = document.createElement("div");
    tipDivBg.id = "tipDivBg";
    tipDivBg.style.position = "absolute";
    tipDivBg.style.width = offsetView(1, 382);
    tipDivBg.style.height = offsetView(2, 40);
    tipDivBg.style["background-color"] = "#caca0d";
    tipDivBg.style.margin = offsetView(1, 5) + " " + offsetView(2, 5);
    tipDivBg.style["border-radius"] = "5px";
    tipDivBg.addEventListener("click", buyKeyClick);
    timeDiv.appendChild(tipDivBg);

    var keyNum = document.createElement("div");
    keyNum.innerText = "x1";
    keyNum.style.width = offsetView(1, 20);
    keyNum.style.height = offsetView(2, 40);
    keyNum.style["line-height"] = offsetView(2, 40);
    keyNum.style["text-align"] = "center";
    keyNum.style.position = "absolute";
    keyNum.style.left = "3px";
    keyNum.style["font-size"] = offsetView(3, 20);
    tipDivBg.appendChild(keyNum);

    var keyImage = document.createElement("div");
    keyImage.id = "keyImage";
    keyImage.style.width = offsetView(3, 22);
    keyImage.style.height = offsetView(3, 22);
    keyImage.style["background-image"] = "url(assets/earth/img/leftImage_8.png)";
    keyImage.style["background-size"] = "100% 100%";
    keyImage.style["background-repeat"] = "no-repeat";
    keyImage.style.position = "absolute";
    keyImage.style.top = offsetView(2, 8);
    keyImage.style.left = offsetView(1, 30);
    tipDivBg.appendChild(keyImage);

    function buyKeyClick(event) {
        if (!gameInfo.uInfo || gameInfo.uInfo.length == 0) {
            var msg = (languageType == 0) ? "请先充值，激活游戏账号!" : "Please recharge first and activate the game account!";
            msgTip(msg);
            return;
        }
        if (!isStart) {
            var msg = (languageType == 0) ? "游戏暂未开始，请耐心等待！" : "The game is not yet started. Please be patient!";
            msgTip(msg);
            return;
        }
        createTip_1(0, 1, (languageType == 0) ? "如果购买，请按下确定按钮" : "If you buy, press the confirm button");
    }

    var showTextDiv = document.createElement("div");
    showTextDiv.style.width = offsetView(1, 332);
    showTextDiv.style.height = offsetView(2, 40);
    showTextDiv.style.position = "absolute";
    showTextDiv.style.left = offsetView(1, 50);
    showTextDiv.style["text-align"] = "center";
    showTextDiv.style["line-height"] = offsetView(2, 40);
    tipDivBg.appendChild(showTextDiv);

    var showText = document.createElement("div");
    showText.innerText = "";
    showText.id = "showText";
    showText.style.fontSize = offsetView(3,13);
    showTextDiv.appendChild(showText);
}

function pcTopDiv() {

    var topDiv = document.createElement("div");
    topDiv.style.position = "absolute";
    topDiv.id = "topDiv";
    topDiv.style.top = "5px";
    topDiv.style.width = "510px";
    topDiv.style.height = "60px";
    topDiv.style.left = (window.innerWidth * 0.5 - 255) + "px";
    document.body.appendChild(topDiv);

    var str = ["长期", "短期"];
    for (var i = 0; i < 2; i++) {
        var typeDiv = document.createElement("div");
        typeDiv.style.position = "absolute";
        typeDiv.id = "typeDiv_" + i;
        typeDiv.innerText = str[i];
        typeDiv.style.left = 150 + 180 * i + "px";
        typeDiv.style.top = "0px";
        typeDiv.style.width = "165px";
        typeDiv.style.height = "51px";
        typeDiv.style["text-align"] = "center";
        typeDiv.style["line-height"] = "51px";
        typeDiv.style["font-size"] = "24px";
        var imageName = (i == 0) ? "topImage_2.png" : "topImage_1.png";
        typeDiv.style["background-image"] = "url(assets/earth/img/" + imageName + ")";
        typeDiv.style["background-size"] = "100% 100%";
        typeDiv.style["background-repeat"] = "no-repeat";
        typeDiv.setAttribute("typeIndex", i.toString());
        typeDiv.addEventListener("click", typeDivBtnClick);
        topDiv.appendChild(typeDiv);
    }

    function typeDivBtnClick(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        var curIndex = parseInt(target.getAttribute("typeIndex"));
        for (var i = 0; i < 2; i++) {
            var typeDiv = document.getElementById("typeDiv_" + i);
            typeDiv.style["background-image"] = "url(assets/earth/img/topImage_1.png)";
        }
        target.style["background-image"] = "url(assets/earth/img/topImage_2.png)";
        if (gameMode == curIndex + 1) { return; };
        this.curLocation = null;
        PLANET.haveFlagLocations = [];
        if (curIndex == 0) {
            console.log("长期");
            gameMode = 1;
            initEosInfo();
        } else if (curIndex == 1) {
            gameMode = 2;
            console.log("短期");
            initEosInfo();
            if (PLANET.hexaspherePopup) {
                PLANET.hexaspherePopup.close();
            }
            PLANET.state = PLANET.IDLE;
        } else {
            console.log("股权");
        }
    }
}

function mobileTopDiv() {
    var topDiv = document.createElement("div");
    topDiv.style.position = "absolute";
    topDiv.id = "topDiv";
    topDiv.style.top = offsetView(2, 90);
    topDiv.style.width = window.innerWidth + "px";
    topDiv.style.height = offsetView(2, 50);
    topDiv.style.left = "0px";
    document.body.appendChild(topDiv);

    var str = ["长期", "短期"];
    for (var i = 0; i < 2; i++) {
        var div = document.createElement("div");
        div.style.position = "absolute";
        div.style.width = window.innerWidth * 0.5 + "px";
        div.style.height = offsetView(2, 50);
        div.style[i == 0 ? "left" : "right"] = "0px";
        topDiv.appendChild(div);

        var typeDiv = document.createElement("div");
        typeDiv.style.position = "absolute";
        typeDiv.id = "typeDiv_" + i;
        typeDiv.innerText = str[i];
        typeDiv.style.margin = "0 auto";
        typeDiv.style.width = window.innerWidth * 0.5 + "px";
        typeDiv.style.height = offsetView(2, 50);
        typeDiv.style["text-align"] = "center";
        typeDiv.style["line-height"] = offsetView(2, 50);
        typeDiv.style["font-size"] = offsetView(3, 24);
        typeDiv.style.color = i == 0 ? "#00ed9b" : "white";
        typeDiv.setAttribute("typeIndex", i.toString());
        typeDiv.addEventListener("click", typeDivBtnClick);
        div.appendChild(typeDiv);

        var typeLine = document.createElement("div");
        typeLine.style.position = "absolute";
        typeLine.id = "typeLine_" + i;
        typeLine.style.width = window.innerWidth * 0.5 + "px";
        typeLine.style.height = "2px";
        typeLine.style["background-color"] = "#00ed9b";
        typeLine.style.opacity = i == 0 ? 1 : 0.3;
        typeLine.style.bottom = "0px";
        div.appendChild(typeLine);
    }

    function typeDivBtnClick(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        var curIndex = parseInt(target.getAttribute("typeIndex"));
        for (var i = 0; i < 2; i++) {
            var typeLine = document.getElementById("typeLine_" + i);
            typeLine.style.opacity = i == curIndex ? 1 : 0.3;

            var typeDiv = document.getElementById("typeDiv_" + i);
            typeDiv.style.color = i == curIndex ? "#00ed9b" : "white";
        }

        if (gameMode == curIndex + 1) { return; };
        if (curIndex == 0) {
            console.log("长期");
            gameMode = 1;
            initEosInfo();
        } else if (curIndex == 1) {
            gameMode = 2;
            console.log("短期");
            initEosInfo();
        }
    }
}

function createMobileItem() {
    var mobileDiv = document.createElement("div");
    mobileDiv.id = "mobileDiv";
    mobileDiv.style.width = window.innerWidth + "px";
    mobileDiv.style.height = offsetView(2, 90);
    mobileDiv.style.position = "absolute";
    mobileDiv.style.bottom = offsetView(2, 20);
    mobileDiv.style["background-image"] = "url(assets/earth/img/mobile.png)";
    mobileDiv.style["background-size"] = "100% 100%";
    mobileDiv.style["background-repeat"] = "no-repeat";
    document.body.appendChild(mobileDiv);

    var imageName = ["jiangchi", "goumai", "zhandui", "wode"];
    var btnNameList = ["奖池", "购买", "战队", "我的"];
    for (var i = 0; i < 4; i++) {
        var curBtnDiv = document.createElement("div");
        curBtnDiv.id = "mobile_btnDiv" + i;
        curBtnDiv.style.width = window.innerWidth / 4 + "px";
        curBtnDiv.style.height = offsetView(2, 90);
        curBtnDiv.style.position = "absolute";
        curBtnDiv.style.top = "0px";
        curBtnDiv.style.left = window.innerWidth / 4 * i + "px";
        mobileDiv.appendChild(curBtnDiv);

        var offsetH = 89/234*(window.innerWidth / 4.5);
        var curBtn = document.createElement("div");
        curBtn.id = "mobileBtn_" + i;
/*        curBtn.style["margin-top"] = offsetView(2, 17);
        curBtn.style["margin-left"] = "auto";
        curBtn.style["margin-right"] = "auto";*/
        curBtn.style.margin = offsetView(2,(90 - offsetH)*0.5) + " auto";
        curBtn.style.width = window.innerWidth / 4.5 + "px";
        curBtn.style.height = offsetH + "px";
        curBtn.style["background-image"] = "url(assets/earth/img/bottomBtn.png)";
        curBtn.style["background-size"] = "100% 100%";
        curBtn.style["background-repeat"] = "no-repeat";
        curBtn.innerText = btnNameList[i];
        curBtn.style["text-align"] = "center";
        curBtn.style["line-height"] = offsetH + "px"; 
        curBtn.style.fontSize = offsetView(3, 18);       
        curBtn.setAttribute("curBtnIndex", i.toString());
        curBtn.addEventListener("click", curBtnClick);
        curBtnDiv.appendChild(curBtn);

/*        var btnName = document.createElement("div");
        btnName.style.width = window.innerWidth / 4.5 + "px";
        btnName.id = "btnName_" + i;
        btnName.style.height = offsetView(2, offsetH);
        btnName.innerText = btnNameList[i];
        btnName.style["margin-left"] = "auto";
        btnName.style["margin-right"] = "auto";
        btnName.style["text-align"] = "center";
        btnName.style["line-height"] = offsetView(2, offsetH);
        btnName.style.fontSize = offsetView(3, 18);
        curBtn.appendChild(btnName);*/
    }

    function curBtnClick(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        var curIndex = parseInt(target.getAttribute("curBtnIndex"));
        var divIndex = curIndex == 2 ? 3 : (curIndex == 3 ? 2 : curIndex);
        console.log("界面的下标是", curIndex,divIndex);
        var touchDiv = document.getElementById("earth_tip_image_div_" + divIndex);
        console.log("当前点击的界面", curIndex, touchDiv.style.display);
        var imageName = ["jiangchi", "goumai", "zhandui", "wode"];
        for (var i = 0; i < 4; i++) {
/*            var btnName = document.getElementById("btnName_" + i);
            btnName.style.color = "white";*/

            var curBtn = document.getElementById("mobileBtn_" + i);
            //curBtn.style["background-image"] = "url(assets/earth/img/" + imageName[i] + ".png)";
            curBtn.style["background-image"] = "url(assets/earth/img/bottomBtn.png)";
        }
        //var btnName = document.getElementById("btnName_" + curIndex);
        var curBtn = document.getElementById("mobileBtn_" + curIndex);
        var mobileDiv = document.getElementById("mobileHiddenDiv");
        if (touchDiv.style.display == "none") {
            touchDiv.style.display = "block";
            mobileDiv.style.visibility = "visible";
            //btnName.style.color = "#00ed9b";
            curBtn.style["background-image"] = "url(assets/earth/img/bottomBtn_curr.png)";
        } else {
            touchDiv.style.display = "none";
            mobileDiv.style.visibility = "hidden";
            //btnName.style.color = "white";
            curBtn.style["background-image"] = "url(assets/earth/img/bottomBtn.png)";
        }

        if(curIndex == 0){
            touchDiv.style.transform = "scale(0.7)";
        }else{
            touchDiv.style.transform = "scale(0.8)";
        }
        
        touchDiv.style.left = (window.innerWidth * 0.5 - touchDiv.offsetWidth * 0.5) + "px";
        touchDiv.style.top = (window.innerHeight * 0.5 - touchDiv.offsetHeight * 0.5) + "px";

        for (var i = 0; i < 4; i++) {
            if (i != divIndex) {
                var cur = document.getElementById("earth_tip_image_div_" + i);
                cur.style.display = "none";
            }
        }
    }
}

function createUI() {

    var strInfo = [
        ["上轮奖励得主：", "上轮奖池", "当前奖池", "当前Keys"],
        ["兌換比率：", "空投幾率：", "購買Key：", "購買"],
        ["我的Keys：", "本轮消耗EOS：", "我的推荐人：", "账户余额：", "战队分红：", "TOKEN分红：", "KEY分红：", "中奖分红：", "总收入："],
        ["1：如需加入战队，获取战队奖励，请点击下方战队按钮进行操作", "2：如需了解游戏详细玩法及流程，请点击玩法详情按钮"]
    ];

    var typeStr = ["left", "right", "top", "bottom"];
    var valueStr = [
        ["20px", "116px"],
        ["20px", "116px"],
        ["20px", "20px"],
        ["20px", "20px"]
    ];

    var valueSize = [
        ["500px", "580px"],
        ["470px", "460px"],
        ["520px", "250px"],
        ["470px", "350px"]
    ];

    if (!CheckCurrentOs().isPc) {
        var uiDiv = document.createElement("div");
        uiDiv.id = "mobileHiddenDiv";
        uiDiv.style.position = "absolute";
        uiDiv.style.width = window.innerWidth + "px";
        uiDiv.style.height = window.innerHeight + "px";
        uiDiv.style["background-color"] = "rgba(0,0,0,0.8)";
        uiDiv.style.top = "0px";
        uiDiv.style.visibility = "hidden";
        document.body.appendChild(uiDiv);
    }

    for (var i = 0; i < 4; i++) {
        var dirHor = typeStr[(i < 2) ? i : (i - 2)];
        var dirVor = typeStr[(i < 2) ? 2 : 3];
        var div = document.createElement("div");
        div.id = "earth_tip_image_div_" + i;
        div.className = div.id;
        div.style[dirHor] = valueStr[i][0];
        div.style[dirVor] = valueStr[i][1];
        div.style.position = "absolute";
        if (!CheckCurrentOs().isPc) {
            div.style.width = valueSize[i][0];
            div.style.height = valueSize[i][1];
        }
        if (CheckCurrentOs().isPc) {
            div.style.display = "block";
        } else {
            div.style.display = "none";
        }
        var parentName = i % 2 == 0 ? "uiBg_0" : "uiBg_1";
        /*        var parent = document.getElementById(parentName);
                parent.appendChild(div);*/
        document.body.appendChild(div);
        switch (i) {
            case 0:
                createOnePage(div, strInfo[i]);
                break;
            case 1:
                createTwoPage(div);
                break;
            case 2:
                createThreePage(div);
                break;
            case 3:
                createFourPage(div, strInfo[i]);
                break;
        }
    }
}

function refreshLanguage() {

    var strCn = (languageType == 0) ? ["长期", "短期"] : ["Long-term", "Short-term"];
    var onePageStrCn = (languageType == 0) ? ["上轮奖励得主：", "上轮奖池", "当前奖池", "当前Keys"] : ["Last Award Winner：", "Last Pool", "Now Pool", "All Keys"];

    var winText = document.getElementById("winText");
    winText.innerText = onePageStrCn[0];

    for (var i = 0; i < 3; i++) {
        var typeDiv = document.getElementById("typeDiv_" + i);
        if (typeDiv) {
            typeDiv.innerText = strCn[i];
        }

        var onePageT = document.getElementById("onePageNameDiv_" + i);
        onePageT.innerText = onePageStrCn[i + 1];
    }

    var threeStr_1 = (languageType == 0) ? ["个人信息", "个人收益"] : ["USERINFO", "USERPROFIT"];
    for (var i = 0; i < 2; i++) {
        var threePaSpanT = document.getElementById("threePaSpanT_" + i);
        threePaSpanT.innerText = threeStr_1[i];
    }

    var threeStr_2 = (languageType == 0) ? ["我的Keys：", "本轮消耗EOS：", "我的推荐人：", "账户余额：", "战队分红：", "推荐奖励：", "KEY分红：", "中奖分红：", "总收入："] : ["My Keys：", "Now Consume EOS：", "My Referee：", "Account Sum：", "Team Bonus：", "Referee Bonus：", "KEY Bonus：", "Winning Bonus：", "Total Income："];

    for (var i = 0; i < 5; i++) {
        var parent = document.getElementsByClassName("lidiv_" + i)[0];
        var sp = parent.getElementsByTagName("div");
        sp[0].innerText = (i < 4 || curChose == 1) ? threeStr_2[4 * curChose + i] : "";
    }

    var hBtn = document.getElementById("sendBtnChose");
    hBtn.innerHTML = (curChose == 1) ? ((languageType == 0) ? "提取" : "Extract") : ((languageType == 0) ? "充值" : "Recharge");

    var twoTipStr = (languageType == 0) ? ["空投几率：", "空投池："] : ["Airdrop Probability：", "Airdrop Pool："];
    for (var i = 0; i < 2; i++) {
        var twoTipShow = document.getElementById("twoTipShow_" + i);
        twoTipShow.innerText = twoTipStr[i];
    }

    var buyBtn = document.getElementById("curBuyBtn");
    buyBtn.innerText = (languageType == 0) ? "购买" : "Buy Keys";

    var fpStr = (languageType == 0) ? ["1：如需加入战队，获取战队奖励，请点击下方战队按钮进行操作", "2：如需了解游戏详细玩法及流程，请点击玩法详情按钮"] : ["1：If you need to join the team and get the reward, please click the team button.",
        "2：If you need to know how to play this game, please click the play details button."
    ];

    var teamStr = (languageType == 0) ? ["战队", "玩法详情"] : ["Team", "Play Details"];

    for (var i = 0; i < 2; i++) {
        var liNode = document.getElementById("liNode_" + i);
        liNode.innerText = fpStr[i];

        var pobBuyBtn = document.getElementById("pobBuyBtn_" + i);
        pobBuyBtn.innerText = teamStr[i];
    }

    $("#inviteBtn")[0].innerText = (languageType == 0) ? "推荐人" : "Referee";

    var leftTitle = document.getElementById("leftTitle");
    if (leftTitle) {
        leftTitle.innerText = (isStart ? "Time：" : ((languageType == 0) ? "距离开启：" : "Distance opening："));
    }

    var rightTitle = document.getElementById("rightTitle");
    if (rightTitle) {
        rightTitle.innerText = languageType == 0 ? "奖池：" : "Prize Pool：";
    }

    if (!CheckCurrentOs().isPc) {
        var btnNameList = ["奖池", "购买", "战队", "我的"];
        var enBtnName = ["Jackpot", "Buy", "Team", "My"];
        for (var i = 0; i < btnNameList.length; i++) {
            var btnName = document.getElementById("mobileBtn_" + i);
            if (btnName) {
                btnName.innerText = languageType == 0 ? btnNameList[i] : enBtnName[i];
            }
        }
    }

    var loginText = document.getElementById("loginText");
    if(loginText){
        loginText.innerText = languageType == 0?"登录":"Login";
    }

    var wallBtnBg_str = ["钱包登录","私钥登录"];
    var wallBtnBg_strEn = ["Wallet Login","Key Login"];
    for(var i = 0; i < 2; i++){
        var wallBtnBg_ = document.getElementById("wallBtnBg_" + i);
        if(wallBtnBg_){
            wallBtnBg_.innerText = languageType == 0?wallBtnBg_str[i]:wallBtnBg_strEn[i];
        }
    }

    refeshValue();
}

function createTimeDiv() {

    var showDiv = document.createElement("div");
    showDiv.id = "showDiv";
    showDiv.style.position = "absolute";
    showDiv.style.width = window.innerWidth + "px";
    showDiv.style.height = "300px";
    showDiv.style.top = window.innerHeight * 0.45 + "px";
    showDiv.style["text-align"] = "center";
    document.body.appendChild(showDiv);

    var rewardDiv = document.createElement("div");
    rewardDiv.id = "rewardDiv";
    rewardDiv.style.position = "absolute";
    rewardDiv.style.width = showDiv.offsetWidth + "px";
    rewardDiv.style.height = "100px";
    showDiv.appendChild(rewardDiv);

    var rewardValue = document.createElement("div");
    rewardValue.innerHTML = "";
    rewardValue.style["-webkit-text-stroke"] = "2px red";
    rewardValue.id = "rewardValue";
    rewardValue.style.height = "100px";
    rewardValue.style["line-height"] = "100px";
    rewardValue.style.color = "white";
    rewardValue.style["font-size"] = "80px";
    rewardValue.style["position"] = "absolute";
    rewardValue.style.right = rewardDiv.offsetWidth * 0.45 + "px";
    rewardValue.style.top = "4px";
    rewardValue.style["font-family"] = "fantasy";
    rewardDiv.appendChild(rewardValue);

    var rewardImg = document.createElement("div");
    rewardImg.style.position = "absolute";
    rewardImg.id = "rewardImg";
    rewardImg.style.left = rewardDiv.offsetWidth * 0.55 + "px";
    rewardImg.style.top = "-12px";
    rewardImg.style.width = "113px";
    rewardImg.style.height = "134px";
    rewardImg.style["background-image"] = "url(assets/earth/img/eos.png)";
    rewardImg.style["background-size"] = "100% 100%";
    rewardImg.style["background-repeat"] = "no-repeat";
    rewardDiv.appendChild(rewardImg);

    var timeTextDiv = document.createElement("div");
    timeTextDiv.id = "timeTextDiv";
    timeTextDiv.style.position = "absolute";
    timeTextDiv.style.width = showDiv.offsetWidth + "px";
    timeTextDiv.style.height = "50px";
    timeTextDiv.style.top = "100px";
    timeTextDiv.style["text-align"] = "center";
    timeTextDiv.style["line-height"] = "50px";
    showDiv.appendChild(timeTextDiv);

    var timeText = document.createElement("div");
    timeText.id = "showTimeText";
    timeText.innerText = "";
    timeText.style["font-size"] = "40px";
    timeTextDiv.appendChild(timeText);

    var rewardDivBg = document.createElement("div");
    rewardDivBg.id = "rewardDivBg";
    rewardDivBg.style.position = "absolute";
    rewardDivBg.style.width = showDiv.offsetWidth + "px";
    rewardDivBg.style.height = "50px";
    rewardDivBg.style.top = "170px";
    rewardDivBg.style["line-height"] = "50px";
    rewardDivBg.style["text-align"] = "center";
    showDiv.appendChild(rewardDivBg);

    var timeDiv = document.createElement("div");
    timeDiv.id = "timeDiv";
    timeDiv.style.width = "700px";
    timeDiv.style.height = "50px";
    timeDiv.style.position = "absolute";
    timeDiv.style["background-color"] = "rgba(255,215,0,0.4)";
    timeDiv.style.left = (showDiv.offsetWidth - 700) * 0.5 + "px";
    timeDiv.style["border-radius"] = "10px";
    rewardDivBg.appendChild(timeDiv);

    var curVa = 0.4;
    timeDiv.interVal = setInterval(function() {
        var nexVa = (curVa + 0.05 < 0.7) ? (curVa + 0.05) : 0.1;
        timeDiv.style["background-color"] = (gameMode == 1) ? "rgba(255,215,0," + nexVa + ")" : "rgba(17,128,236," + nexVa + ")";
        $("#tipDivBg")[0].style["background-color"] = (gameMode == 1) ? "#caca0d" : "#1180ec";
        curVa = nexVa;
    }, 60);

    var tipDivBg = document.createElement("div");
    tipDivBg.id = "tipDivBg";
    tipDivBg.style.position = "absolute";
    tipDivBg.style.width = "692px";
    tipDivBg.style.height = "42px";
    tipDivBg.style["background-color"] = "#caca0d";
    tipDivBg.style.left = "4px";
    tipDivBg.style.top = "4px";
    tipDivBg.style["border-radius"] = "10px";
    tipDivBg.addEventListener("click", buyKeyClick);
    timeDiv.appendChild(tipDivBg);

    var keyNum = document.createElement("div");
    keyNum.innerText = "x1";
    keyNum.style.width = "20px";
    keyNum.style.height = "42px";
    keyNum.style["line-height"] = "42px";
    keyNum.style["text-align"] = "center";
    keyNum.style.position = "absolute";
    keyNum.style.left = "3px";
    keyNum.style["font-size"] = "22px";
    tipDivBg.appendChild(keyNum);

    var keyImage = document.createElement("div");
    keyImage.id = "keyImage";
    keyImage.style.width = "22px";
    keyImage.style.height = "22px";
    keyImage.style["background-image"] = "url(assets/earth/img/leftImage_8.png)";
    keyImage.style["background-size"] = "100% 100%";
    keyImage.style["background-repeat"] = "no-repeat";
    keyImage.style.position = "absolute";
    keyImage.style.top = "10px";
    keyImage.style.left = "30px";
    tipDivBg.appendChild(keyImage);

    function buyKeyClick(event) {
        if (!gameInfo.uInfo || gameInfo.uInfo.length == 0) {
            var msg = (languageType == 0) ? "请先充值，激活游戏账号!" : "Please recharge first and activate the game account!";
            msgTip(msg);
            return;
        }
        if (!isStart) {
            var msg = (languageType == 0) ? "游戏暂未开始，请耐心等待！" : "The game is not yet started. Please be patient!";
            msgTip(msg);
            return;
        }
        createTip_1(0, 1, (languageType == 0) ? "如果购买，请按下确定按钮" : "If you buy, press the confirm button");
    }

    var showTextDiv = document.createElement("div");
    showTextDiv.style.width = "640px";
    showTextDiv.style.height = "42px";
    showTextDiv.style.position = "absolute";
    showTextDiv.style.left = "50px";
    showTextDiv.style["text-align"] = "center";
    showTextDiv.style["line-height"] = "42px";
    tipDivBg.appendChild(showTextDiv);

    var showText = document.createElement("div");
    showText.innerText = "";
    showText.id = "showText";
    showTextDiv.appendChild(showText);

}


function refeshValue() {

    var allValue = 100000;
    if (gameInfo.gInfo) {

        var spanValue = ["last_win_buyer", "pre_pool_reword", "balance", "sell_keys"];
        for (var i = 0; i < 3; i++) {
            var valueText = document.getElementById("valueText_" + i);
            if (valueText) {
                var value = (i < 2) ? (gameInfo.gInfo[spanValue[i + 1]] * 0.0001).toFixed(4) : gameInfo.gInfo[spanValue[i + 1]];
                valueText.innerText = value;
            }
            var curValue = Number(value);
            var progress = document.getElementById("progress_" + i);
            if (progress) {
                progress.style.clip = "rect(0px," + progress.offsetWidth * (curValue / allValue) + "px," + progress.offsetHeight + "px,0px)";
            }
        }

        var winTextName = document.getElementById("winTextName");
        if (winTextName) {
            winTextName.innerText = gameInfo.gInfo[spanValue[0]];
        }

        var curDateTime = (new Date()).getTime()*0.001;
        isStart = (curDateTime - gameInfo.gInfo.start_time > 0) ? true : false;

        if (!isStart) {
            if (this.hexaspherePopup) {
                this.hexaspherePopup.close();
            }
            this.hexaspherePopup = null;
        }

        var curValue = 0;
        if(isStart){
            curValue = gameInfo.gInfo.end_time - curDateTime;
        }else{
            curValue = gameInfo.gInfo.start_time - curDateTime;
        }

        curTime = (curValue > 1) ? curValue : 0;
        changeTime();

        var airDropPool = document.getElementById("airDropPool_0");
        airDropPool.innerHTML = (gameInfo.gInfo.pr_pool * 0.1).toFixed(2) + "%";

        var airDropRatio = document.getElementById("airDropPool_1");
        airDropRatio.innerHTML = (gameInfo.gInfo.pool * 0.0001).toFixed(4);

        var proDiv = document.getElementById("proDiv");
        proDiv.innerHTML = "@" + (gameInfo.gInfo.key_price * 0.0001).toFixed(4) + "EOS";

        var rewardValue = document.getElementById("rewardValue");
        if (rewardValue) {
            rewardValue.innerText = (gameInfo.gInfo[spanValue[2]] * 0.0001).toFixed(4);
            //console.log("当前奖池数额",rewardValue.innerText);
            rewardValue.style.color = (gameMode == 1) ? "white" : "#1180ec";
            if(CheckCurrentOs().isPc){
               rewardValue.style["-webkit-text-stroke-color"] = (gameMode == 1) ? "red" : "white"; 
            }            
        }

        if ($("#showTimeText")[0]) {
            $("#showTimeText")[0].style.color = (gameMode == 1) ? "white" : "#1180ec";
        }

        var randomStr = [
            [""],
            ["下一次购买key中奖的可能是你!", "Maybe the next time you buy the key prize is you!"],
            ["你是那个好运连连的玩家吗？", "Are you the lucky player?"],
            ["空投奖金会直接转入您的总收入账户!", "The airdrop bonus will be transferred directly to your total income account!"]
        ];
        var curRandom = Math.floor(Math.random() * 3);
        var curRandomStr = "";
        if (curRandom == 0) {
            if (CheckCurrentOs().isPc) {
                curRandomStr = (languageType == 0) ? "空投中奖概率:" : "Probability of winning an airdrop:";
                curRandomStr = curRandomStr + (gameInfo.gInfo.pr_pool * 0.1).toFixed(2) + "%,";
                var otherS = (languageType == 0) ? "空投奖金:" : "Airdrop bonus:";
                curRandomStr = curRandomStr + otherS + (gameInfo.gInfo.pool * 0.0001).toFixed(4) + " EOS";
            } else {
                curRandomStr = (languageType == 0) ? "空投中奖概率:" : "Probability airdrop:";
                curRandomStr = curRandomStr + (gameInfo.gInfo.pr_pool * 0.1).toFixed(2) + "%,";
                var otherS = (languageType == 0) ? "空投奖金:" : "bonus:";
                curRandomStr = curRandomStr + otherS + (gameInfo.gInfo.pool * 0.0001).toFixed(4) + " EOS";
            }

        } else {
            curRandomStr = (languageType == 0) ? randomStr[curRandom][0] : randomStr[curRandom][1];
        }
        $("#showText")[0].innerText = curRandomStr;
    }

    var uInfoValue = ["keys", "key_balance", "invite_name", "balance"];
    var uOtherValue = ["team_dividend", "invite_dividend", "key_dividend", "win_dividend", "income"];
    var spanV = (curChose == 0) ? uInfoValue : uOtherValue;
    if (gameInfo.uInfo) {
        for (var i = 0; i < 5; i++) {
            var lidiv = document.getElementById("lidiv_" + i);
            lidiv.style.visibility = (i < 4 || curChose == 1) ? "visible" : "hidden";
            var parent = document.getElementsByClassName("lidiv_" + i)[0];
            var spv = parent.getElementsByTagName("span");
            if (i < 4) {
                spv[0].innerText = (gameInfo.uInfo[spanV[i]] > 0 || typeof(gameInfo.uInfo[spanV[i]]) == "string") ? ((spanV[i] == "keys" || spanV[i] == "invite_name") ? gameInfo.uInfo[spanV[i]] : (gameInfo.uInfo[spanV[i]] * 0.0001).toFixed(4)) : 0;
            } else {
                spv[0].innerText = (curChose == 1) ? ((gameInfo.uInfo[spanV[i]] > 0) ? (gameInfo.uInfo[spanV[i]] * 0.0001).toFixed(4) : 0) : "";
            }
        }
    }
}

function createTeamDiv() {
    var uiDiv = document.getElementById("uiDiv");
    uiDiv.style.visibility = "visible";

    var teamDiv = document.createElement("div");
    teamDiv.id = "teamDiv";
    teamDiv.style.width = "747px";
    teamDiv.style.height = "544px";
    teamDiv.style.position = "fixed";
    teamDiv.style["background-image"] = "url(assets/earth/tips/bg_team.png)";
    teamDiv.style["background-size"] = "100% 100%";
    teamDiv.style["background-repeat"] = "no-repeat";
    teamDiv.style.margin = "auto";
    teamDiv.style.top = "217.5px";
    teamDiv.style.left = "592.5px";
    uiDiv.appendChild(teamDiv);
    console.log(document.body.clientWidth, document.body.clientHeight);

    var title = document.createElement("div");
    title.style.position = "absolute";
    title.style.width = teamDiv.offsetWidth + "px";
    title.style.height = "100px";
    title.style["text-align"] = "center";
    title.style["line-height"] = "100px";
    title.style["font-size"] = "60px";
    title.style.top = "-60px";
    teamDiv.appendChild(title);

    var titleText = document.createElement("div");
    titleText.innerText = (languageType == 0) ? "战队" : "TEAM";
    title.appendChild(titleText);

    var btnStr = (languageType == 0) ? ["创建战队", "加入战队", "暂不加入"] : ["Create Team", "Join Team", "Not Join"];
    for (var i = 0; i < 3; i++) {
        var curBtn = document.createElement("div");
        curBtn.innerHTML = btnStr[i];
        curBtn.style["text-align"] = "center";
        curBtn.style["line-height"] = "70px";
        curBtn.style.position = "absolute";
        curBtn.style["font-size"] = "24px";
        curBtn.style.top = 130 * (i + 1) + "px";
        curBtn.style.left = "178px"
        curBtn.style.width = "389px";
        curBtn.style.height = "77px";
        curBtn.style["background-image"] = "url(assets/earth/tips/btn_createTeam_1.png)";
        curBtn.style["background-size"] = "100% 100%";
        curBtn.style["background-repeat"] = "none";
        curBtn.addEventListener("mousedown", curBtnDownFunc);
        curBtn.addEventListener("mouseout", curBtnOutFunc);
        curBtn.addEventListener("click", curBtnUpFunc);
        curBtn.setAttribute("index", i.toString());
        teamDiv.appendChild(curBtn);
    }

    function curBtnDownFunc(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        var curIndex = parseInt(target.getAttribute("index"));
        if (curIndex == 3) {
            target.style["background-image"] = "url(assets/earth/tips/btn_close_2.png)";
        } else {
            target.style["background-image"] = "url(assets/earth/tips/btn_createTeam_2.png)";
        }
    }

    function curBtnOutFunc(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        var curIndex = parseInt(target.getAttribute("index"));
        if (curIndex == 3) {
            target.style["background-image"] = "url(assets/earth/tips/btn_close_1.png)";
        } else {
            target.style["background-image"] = "url(assets/earth/tips/btn_createTeam_1.png)";
        }
    }

    function curBtnUpFunc(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        var curIndex = parseInt(target.getAttribute("index"));

        if (curIndex == 3) {
            target.style["background-image"] = "url(assets/earth/tips/btn_close_1.png)";
        } else {
            target.style["background-image"] = "url(assets/earth/tips/btn_createTeam_1.png)";
        }

        if (curIndex == 0) {
            console.log("创建战队");
            //teamDiv.remove();
            teamDiv.style.display = "none";
            uiDiv.style.visibility = "hidden";

            createTeamClan(0);

        } else if (curIndex == 1) {
            console.log("加入战队");
            //teamDiv.remove();
            teamDiv.style.display = "none";
            uiDiv.style.visibility = "hidden";

            createTipWithInput(1, (languageType == 0) ? "加入战队" : "Join Team", (languageType == 0) ? "战队名" : "TeamName");
        } else {
            teamDiv.remove();
            uiDiv.style.visibility = "hidden";
        }
    }

    var closeBtn = document.createElement("div");
    closeBtn.style.position = "absolute";
    closeBtn.style.right = "-42px";
    closeBtn.style.top = "-10px";
    closeBtn.style.width = "32px";
    closeBtn.style.height = "32px";
    closeBtn.style["background-image"] = "url(assets/earth/tips/btn_close_1.png)";
    closeBtn.style["background-size"] = "100% 100%";
    closeBtn.style["background-repeat"] = "none";
    closeBtn.setAttribute("index", "3");
    closeBtn.addEventListener("mousedown", curBtnDownFunc);
    closeBtn.addEventListener("mouseout", curBtnOutFunc);
    closeBtn.addEventListener("click", curBtnUpFunc);
    teamDiv.appendChild(closeBtn);
}

//创建战队
function createTeamClan(_index, value) {
    var uiDiv = document.getElementById("uiDiv");
    uiDiv.style.visibility = "visible";

    var createTeamDiv = document.createElement("div");
    createTeamDiv.id = "createTeamDiv";
    createTeamDiv.style.width = "707px";
    createTeamDiv.style.height = "700px";
    createTeamDiv.style.position = "fixed";
    createTeamDiv.style["background-image"] = "url(assets/earth/tips/bg_createteam.png)";
    createTeamDiv.style["background-size"] = "100% 100%";
    createTeamDiv.style["background-repeat"] = "no-repeat";
    createTeamDiv.style.margin = "auto";
    createTeamDiv.style.left = (document.body.clientWidth * 0.5 - 353.5) + "px";
    createTeamDiv.style.top = "144px";
    uiDiv.appendChild(createTeamDiv);
    console.log(document.body.clientWidth, document.body.clientHeight);

    var top_div = document.createElement("div");
    top_div.className = "top_div";
    top_div.style.width = "568px";
    top_div.style.height = "66px";
    top_div.style.position = "absolute";
    top_div.style["text-align"] = "center";
    top_div.style["line-height"] = "66px";
    top_div.style.left = "69px";
    top_div.style.top = "79px";
    top_div.style["font-size"] = "25px";
    top_div.style.background = "rgba(0,0,0,1)";
    createTeamDiv.appendChild(top_div);

    var topDivText = document.createElement("div");
    var teamkeyNum = (gameInfo.gInfo.create_team_keys * 0.0001).toFixed(1);
    topDivText.innerText = (languageType == 0) ? "创建战队需花费" + teamkeyNum + "eos" : "It takes " + teamkeyNum + "eos to create a battle team";
    top_div.appendChild(topDivText);

    var title = document.createElement("div");
    title.style.position = "absolute";
    title.style.width = createTeamDiv.offsetWidth + "px";
    title.style.height = "100px";
    title.style["text-align"] = "center";
    title.style["line-height"] = "100px";
    title.style["font-size"] = "60px";
    title.style.top = "-60px";
    createTeamDiv.appendChild(title);

    var titleText = document.createElement("div");
    titleText.innerText = (languageType == 0) ? "创建战队" : "Create Team";
    title.appendChild(titleText);

    var inputBg = document.createElement("div");
    inputBg.className = "rechargeInputBg";
    inputBg.style.width = "568px";
    inputBg.style.height = "66px";
    inputBg.style.position = "absolute";
    inputBg.style["background-image"] = "url(assets/earth/tips/input_team.png)";
    inputBg.style["background-size"] = "100% 100%";
    inputBg.style["background-repeat"] = "no-repeat";
    inputBg.style.left = "69px";
    inputBg.style.top = "172px";
    createTeamDiv.appendChild(inputBg);

    var rechargeText = document.createElement("div");
    rechargeText.style["text-align"] = "center";
    rechargeText.style["line-height"] = "68px";
    rechargeText.style.width = "150px";
    rechargeText.style.height = "68px";
    rechargeText.style["font-size"] = "25px";
    inputBg.appendChild(rechargeText);

    var rechargeInfo = document.createElement("div");
    rechargeInfo.innerText = (languageType == 0) ? "战队名称" : "Team Name";
    rechargeText.appendChild(rechargeInfo);

    //输入框
    var inputText = document.createElement("input");
    inputText.name = "rechargeInput";
    inputText.type = "text";
    inputText.style["text-align"] = "center";
    inputText.style["vertical-align"] = "middle";
    inputText.style.position = "absolute";
    inputText.style.top = "0px";
    inputText.style.left = "152px";
    inputText.style.width = "415px";
    inputText.style.height = "66px";
    inputText.style.border = "none";
    inputText.style.background = "rgba(255,255,255,0)";
    inputText.style["font-size"] = "32px";
    inputText.style.color = "#ffff4c";
    if (value && value.length > 0) {
        inputText.value = value;
    } else {
        inputText.setAttribute("placeholder", (languageType == 0) ? "战队名请不要超过6个字符" : "No more than 6 characters");
    }
    inputText.maxLength = "6";
    inputBg.appendChild(inputText);


    var mid_div = document.createElement("div");
    mid_div.className = "top_div";
    mid_div.style.width = "568px";
    mid_div.style.height = "240px";
    mid_div.style.position = "absolute";
    mid_div.style.left = "69px";
    mid_div.style.top = "300px";
    mid_div.style.background = "rgba(0,0,0,1)";
    createTeamDiv.appendChild(mid_div);

    var title_1 = document.createElement("div");
    title_1.innerHTML = (languageType == 0) ? "添加战队图标：" : "Add team Icon：";
    title_1.style["text-align"] = "center";
    title_1.style["line-height"] = "70px";
    title_1.style.position = "absolute";
    title_1.style["font-size"] = "23px";
    title_1.style.top = "0px";
    title_1.style.left = "14px";
    mid_div.appendChild(title_1);

    var addTeamIconBtn = document.createElement("div");
    addTeamIconBtn.style.position = "absolute";
    addTeamIconBtn.style.top = "89px";
    addTeamIconBtn.style.left = "215px";
    addTeamIconBtn.style.width = "162px";
    addTeamIconBtn.style.height = "148px";
    if (_index == 0) {
        addTeamIconBtn.style["background-image"] = "url(assets/earth/tips/btn_addTeamIcon.png)";
    } else {
        addTeamIconBtn.style["background-image"] = "url(assets/earth/tips/btn_teambg_1.png)";
        var icon = document.createElement("div");
        icon.style.position = "absolute";
        icon.style.width = "88px";
        icon.style.height = "60px";
        icon.style.top = "44px";
        icon.style.left = "37px";
        icon.style["background-image"] = "url(assets/earth/tips/icon_" + _index + ".png)";
        addTeamIconBtn.appendChild(icon);
    }

    addTeamIconBtn.addEventListener("click", addBtnUpFunc);
    mid_div.appendChild(addTeamIconBtn);

    function addBtnUpFunc(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;

        console.log("添加战队图标");

        createTeamDiv.remove();
        uiDiv.style.visibility = "hidden";
        addTeamIconBg(inputText.value);
    }

    var btnStr = (languageType == 0) ? ["取消", "确定"] : ["Cancel", "Confirm"];
    for (var i = 0; i < 2; i++) {
        var curBtn = document.createElement("div");
        curBtn.innerHTML = btnStr[i];
        curBtn.style["text-align"] = "center";
        curBtn.style["line-height"] = "70px";
        curBtn.style.position = "absolute";
        curBtn.style["font-size"] = "24px";
        curBtn.style.top = "589px";
        curBtn.style.left = (350 * i + 58) + "px";
        curBtn.style.width = "249px";
        curBtn.style.height = "77px";

        if (i == 0) {
            curBtn.style.color = "#00ed9b";
            curBtn.style["background-image"] = "url(assets/earth/tips/btn_cancle.png)";
        } else {
            curBtn.style["background-image"] = "url(assets/earth/tips/btn_ok.png)";
        }

        curBtn.style["background-size"] = "100% 100%";
        curBtn.style["background-repeat"] = "none";
        curBtn.addEventListener("mousedown", curBtnDownFunc);
        curBtn.addEventListener("mouseout", curBtnOutFunc);
        curBtn.addEventListener("click", curBtnUpFunc);
        curBtn.setAttribute("index", i.toString());
        createTeamDiv.appendChild(curBtn);
    }

    function curBtnDownFunc(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        target.style["background-image"] = "url(assets/earth/tips/btn_press.png)";
        var curIndex = parseInt(target.getAttribute("index"));
        if (curIndex == 0) {
            target.style.color = "#ffffff";
        }
    }

    function curBtnOutFunc(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        var curIndex = parseInt(target.getAttribute("index"));
        if (curIndex == 0) {
            target.style.color = "#00ed9b";
            target.style["background-image"] = "url(assets/earth/tips/btn_cancle.png)";
        } else {
            target.style["background-image"] = "url(assets/earth/tips/btn_ok.png)";
        }
    }

    async function curBtnUpFunc(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        var curIndex = parseInt(target.getAttribute("index"));
        if (curIndex == 0) {
            target.style.color = "#00ed9b";
            target.style["background-image"] = "url(assets/earth/tips/btn_cancle.png)";
        } else {
            target.style["background-image"] = "url(assets/earth/tips/btn_ok.png)";
        }
        var teamDiv = document.getElementById("teamDiv");
        if (curIndex == 0) {
            createTeamDiv.remove();           
            if(teamDiv){
                teamDiv.style.display = "block";
            }else{
                uiDiv.style.visibility = "hidden";
            }            
        } else if (curIndex == 1) {
            if(teamDiv){
                teamDiv.remove();
            }
            if (checkIsHasSpecialStr(inputText.value)) {
                var msg = (languageType == 0) ? "当前输入不合法，请勿输入特殊符号" : "Current input is not legal. Do not enter special symbols";
                msgTip(msg);
            } else {
                if (gameInfo.tInfo) {
                    for (var i = 0; i < gameInfo.tInfo.length; i++) {
                        if (inputText.value == gameInfo.tInfo[i].name) {
                            var msg = (languageType == 0) ? "战队名已占用，请重新命名!" : "The name of the battle team has been occupied. Please rename it!";
                            msgTip(msg);
                            return;
                        }
                    }
                }

                if (gameInfo.uInfo.balance * 0.0001 >= createTeamEos) {
                    if (inputText.value.length > 0) {
                        if (_index > 0) {
                            createTeamDiv.remove();
                            uiDiv.style.visibility = "hidden";
                            netInfo.teamcreate({ "user": gameInfo.accountsInfo.name, "name": inputText.value, "logo": "url(assets/earth/tips/icon_" + _index + ".png)", "gamemode": gameMode }, { authorization: [gameInfo.accountsInfo.name + '@active'] });
                            console.log("创建战队确定接口");
                        } else {
                            var msg = (languageType == 0) ? "请选择战队图标!" : "Please select the team icon!";
                            msgTip(msg);
                        }
                    } else {
                        var msg = (languageType == 0) ? "请输入战队名称!" : "Please enter the name of the combat team!";
                        msgTip(msg);
                    }
                } else {
                    var msg = (languageType == 0) ? "当前账户余额不足，请充值!" : "Current account balance is insufficient, please recharge!";
                    msgTip(msg);
                }
            }
        }
    }
}

//检测特殊字符
function checkIsHasSpecialStr(str) {
    var myReg = new RegExp("[`~!@#$^&*()=|{}':;',\\[\\].<>/?~！@#￥……&*（）——|{}【】‘；：”“'。，、？_%]")
    if (myReg.test(str)) {
        return true;
    }
    return false;
}

//检查是否为数字
function checkIsNum(str) {
    var myReg = new RegExp("^[0-9]*$");
    if (myReg.test(str)) {
        return true;
    }
    return false;
}

//输入框检测
function inputValueCheck(value, type) {

    if (value) {
        if (type == 1) {
            return checkIsNum(value);
        } else {
            return checkIsHasSpecialStr(value);
        }
    }
    return false;
}

function addTeamIconBg(value) {
    var uiDiv = document.getElementById("uiDiv");
    uiDiv.style.visibility = "visible";

    var addteamDiv = document.createElement("div");
    addteamDiv.id = "teamIconDiv";
    addteamDiv.style.width = "747px";
    addteamDiv.style.height = "544px";
    addteamDiv.style.position = "fixed";
    addteamDiv.style["background-image"] = "url(assets/earth/tips/bg_team.png)";
    addteamDiv.style["background-size"] = "100% 100%";
    addteamDiv.style["background-repeat"] = "no-repeat";
    addteamDiv.style.margin = "auto";
    addteamDiv.style.top = "217.5px";
    addteamDiv.style.left = "592.5px";
    uiDiv.appendChild(addteamDiv);
    console.log(document.body.clientWidth, document.body.clientHeight);

    var title = document.createElement("div");
    title.style.position = "absolute";
    title.style.width = addteamDiv.offsetWidth + "px";
    title.style.height = "100px";
    title.style["text-align"] = "center";
    title.style["line-height"] = "100px";
    title.style["font-size"] = "60px";
    title.style.top = "-60px";
    addteamDiv.appendChild(title);

    var titleText = document.createElement("div");
    titleText.innerText = (languageType == 0) ? "战队图标" : "Team Icon";
    title.appendChild(titleText);

    var title_1 = document.createElement("div");
    title_1.innerHTML = (languageType == 0) ? "请选择战队图标：" : "Select Team Icon：";
    title_1.style["text-align"] = "center";
    title_1.style["line-height"] = "70px";
    title_1.style.position = "absolute";
    title_1.style["font-size"] = "23px";
    title_1.style.top = "12px";
    title_1.style.left = "35px";
    addteamDiv.appendChild(title_1);


    var iconDiv = document.createElement("div");
    iconDiv.style.width = "620px";
    iconDiv.style.height = "300px";
    //iconDiv.style.marginTop = "95px";
    iconDiv.style.margin = "90px auto";
    iconDiv.style.overflowY = "auto";
    addteamDiv.appendChild(iconDiv);

    var iconList = document.createElement("div");
    iconList.style.height = "600px";
    iconList.style.position = "relative";
    iconList.style.top = "0px";
    iconList.style.left = "0px";
    iconDiv.appendChild(iconList);

    var icon_list = [];
    for (var i = 0; i < 5; i++) {
        for (var j = 0; j < 4; j++) {
            var item = document.createElement("div");
            iconList.appendChild(item);
            item.style.position = "absolute";
            item.style.width = "162px";
            item.style.height = "148px";
            item.id = "item_" + (4 * i + j + 1);
            item.style.top = (item.offsetHeight + (iconList.offsetHeight - item.offsetHeight * 4) / 3) * i + "px";
            item.style.left = 4 + (item.offsetWidth + (iconList.offsetWidth - item.offsetWidth * 4) / 2.7) * j + "px";
            //item.setAttribute("img","url/img/img_" + (4*i + (j+1)));
            item.style["background"] = "url(assets/earth/tips/btn_teambg_1.png) no-repeat";

            var icon = document.createElement("div");
            icon.style.position = "absolute";
            icon.style.width = "88px";
            icon.style.height = "60px";
            icon.style.top = "44px";
            icon.style.left = "37px";
            icon.style["background-image"] = "url(assets/earth/tips/icon_" + (4 * i + (j + 1)).toString() + ".png)";
            icon.setAttribute("index", (4 * i + (j + 1)).toString());
            item.appendChild(icon);

            item.addEventListener("click", itemBtnUpFunc);
            item.setAttribute("index", (4 * i + (j + 1)).toString());

            icon_list.push(item);
        }
    }

    var selectIndex = 0;

    function itemBtnUpFunc(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        var curIndex = parseInt(target.getAttribute("index"));

        if (selectIndex == curIndex) { return; }

        if (selectIndex > 0) {
            var lostSelect = document.getElementById("item_" + selectIndex);
            lostSelect.style["background"] = "url(assets/earth/tips/btn_teambg_1.png)";
        }

        var curSelect = document.getElementById("item_" + curIndex);
        curSelect.style["background"] = "url(assets/earth/tips/btn_teambg_2.png)";

        selectIndex = curIndex;
    }

    var btnStr = (languageType == 0) ? ["取消", "确定"] : ["Cancel", "Confirm"];
    for (var i = 0; i < 2; i++) {
        var curBtn = document.createElement("div");
        curBtn.innerHTML = btnStr[i];
        curBtn.style["text-align"] = "center";
        curBtn.style["line-height"] = "70px";
        curBtn.style.position = "absolute";
        curBtn.style["font-size"] = "24px";
        curBtn.style.top = "414px";
        curBtn.style.left = (340 * i + 80) + "px";
        curBtn.style.width = "249px";
        curBtn.style.height = "77px";

        if (i == 0) {
            curBtn.style.color = "#00ed9b";
            curBtn.style["background-image"] = "url(assets/earth/tips/btn_cancle.png)";
        } else {
            curBtn.style["background-image"] = "url(assets/earth/tips/btn_ok.png)";
        }

        curBtn.style["background-size"] = "100% 100%";
        curBtn.style["background-repeat"] = "none";
        curBtn.addEventListener("mousedown", curBtnDownFunc);
        curBtn.addEventListener("mouseout", curBtnOutFunc);
        curBtn.addEventListener("click", curBtnUpFunc);
        curBtn.setAttribute("index", i.toString());
        addteamDiv.appendChild(curBtn);
    }

    function curBtnDownFunc(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        target.style["background-image"] = "url(assets/earth/tips/btn_press.png)";

        if (i == 0) {
            curBtn.style.color = "#ffffff";
        }
    }

    function curBtnOutFunc(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        if (i == 0) {
            curBtn.style.color = "#00ed9b";
            curBtn.style["background-image"] = "url(assets/earth/tips/btn_cancle.png)";
        } else {
            curBtn.style["background-image"] = "url(assets/earth/tips/btn_ok.png)";
        }
    }

    function curBtnUpFunc(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        var curIndex = parseInt(target.getAttribute("index"));
        if (curIndex == 0) {
            curBtn.style.color = "#00ed9b";
            curBtn.style["background-image"] = "url(assets/earth/tips/btn_cancle.png)";
        } else {
            curBtn.style["background-image"] = "url(assets/earth/tips/btn_ok.png)";
        }
        addteamDiv.remove();
        uiDiv.style.visibility = "hidden";
        if (curIndex == 1) {
            createTeamClan(selectIndex, value);            
        }else{
            createTeamClan(0, value); 
        }
    }
}

//自适应
function adaptionPos() {

    var transformNum = (window.innerHeight + window.innerWidth) / (curHeight + curWidth);
    var transformScale = "scale(" + transformNum + ")";
    var mobileNum = (window.innerHeight + window.innerWidth) / (mobileHeight + mobileWidth);
    var mobileScale = "scale(" + mobileNum + ")";
    var topDiv = document.getElementById("topDiv");
    if (topDiv) {
        if (CheckCurrentOs().isPc) {
            topDiv.style.left = window.innerWidth * 0.5 - topDiv.offsetWidth * 0.5 + "px";
            topDiv.style.transform = transformScale;
        }
    }

    var loginDivID = document.getElementById("loginDivID");
    if(loginDivID){
        loginDivID.style.transform = transformScale;
        loginDivID.style.right = transformNum*350 + "px";
        loginDivID.style.top = transformNum*50 + "px";      
    }

    var languageDiv = document.getElementById("languageDiv");
    if (languageDiv) {
        if (CheckCurrentOs().isPc) {
            languageDiv.style.right = 34 * transformNum + "px";
            languageDiv.style.transform = transformScale;
        } else {
            languageDiv.style.transform = mobileScale;
            languageDiv.style.right = -languageDiv.offsetWidth * (1 - mobileNum) / 2 + "px";
        }
    }

    var logoImg = document.getElementById("logoImg");
    if (logoImg) {
        if (CheckCurrentOs().isPc) {
            logoImg.style.left = 30 * transformNum + "px";
            logoImg.style.transform = transformScale;
        } else {
            logoImg.style.left = -logoImg.offsetWidth * (1 - mobileNum) / 2 + "px";
            logoImg.style.top = -logoImg.offsetHeight * (1 - mobileNum) / 2 + "px";
            logoImg.style.transform = mobileScale;
        }
    }

    var keybuyDiv = document.getElementById("keybuyDiv");
    if (keybuyDiv) {
        keybuyDiv.style.left = window.innerWidth * 0.5 - keybuyDiv.offsetWidth * 0.5 + "px";
        keybuyDiv.style.top = window.innerHeight * 0.5 - keybuyDiv.offsetHeight * 0.5 + "px";
        keybuyDiv.style.transform = transformScale;
    }

    var keyLoginBg = document.getElementById("keyLoginBg");
    if(keyLoginBg){
        keyLoginBg.style.left = window.innerWidth * 0.5 - keyLoginBg.offsetWidth * 0.5 + "px";
        keyLoginBg.style.top = window.innerHeight * 0.5 - keyLoginBg.offsetHeight * 0.5 + "px";
        keyLoginBg.style.transform = transformScale;        
    }

    var rechargeDiv = document.getElementById("rechargeDiv");
    if (rechargeDiv) {
        rechargeDiv.style.left = window.innerWidth * 0.5 - rechargeDiv.offsetWidth * 0.5 + "px";
        rechargeDiv.style.top = window.innerHeight * 0.5 - rechargeDiv.offsetHeight * 0.5 + "px";
        rechargeDiv.style.transform = transformScale;
    }

    var msgDiv = document.getElementById("msgDiv");
    if (msgDiv) {
        msgDiv.style.width = window.innerWidth + "px";
        msgDiv.style.height = window.innerHeight + "px";
    }

    var msgBg = document.getElementById("msgBg");
    if (msgBg) {
        msgBg.style.left = window.innerWidth * 0.5 - msgBg.offsetWidth * 0.5 + "px";
        msgBg.style.top = window.innerHeight * 0.5 - msgBg.offsetHeight * 0.5 + "px";
        msgBg.style.transform = transformScale;
    }

    var teamDiv = document.getElementById("teamDiv");
    if (teamDiv) {
        teamDiv.style.left = window.innerWidth * 0.5 - teamDiv.offsetWidth * 0.5 + "px";
        teamDiv.style.top = window.innerHeight * 0.5 - teamDiv.offsetHeight * 0.5 + "px";
        teamDiv.style.transform = transformScale;
    }

    var teamIconDiv = document.getElementById("teamIconDiv");
    if (teamIconDiv) {
        teamIconDiv.style.left = window.innerWidth * 0.5 - teamIconDiv.offsetWidth * 0.5 + "px";
        teamIconDiv.style.top = window.innerHeight * 0.5 - teamIconDiv.offsetHeight * 0.5 + "px";
        teamIconDiv.style.transform = transformScale;
    }    

    var createTeamDiv = document.getElementById("createTeamDiv");
    if (createTeamDiv) {
        createTeamDiv.style.left = window.innerWidth * 0.5 - createTeamDiv.offsetWidth * 0.5 + "px";
        createTeamDiv.style.top = window.innerHeight * 0.5 - createTeamDiv.offsetHeight * 0.5 + "px";
        createTeamDiv.style.transform = transformScale;
    }

    var showDiv = document.getElementById("showDiv");
    if (showDiv) {
        if (CheckCurrentOs().isPc) {
            showDiv.style.width = window.innerWidth + "px";
            showDiv.style.top = window.innerHeight * 0.45 + "px";
            showDiv.style.transform = transformScale;
            for (var i = 0; i < $("#showDiv").contents().length; i++) {
                var cont = $("#showDiv").contents()[i];
                cont.style.width = showDiv.offsetWidth + "px";
            }

            var rewardValue = document.getElementById("rewardValue");
            rewardValue.style.right = showDiv.offsetWidth * 0.45 + "px";

            var rewardImg = document.getElementById("rewardImg");
            rewardImg.style.left = showDiv.offsetWidth * 0.55 + "px";

            var timeTextDiv = document.getElementById("timeTextDiv");
            timeTextDiv.style.width = showDiv.offsetWidth + "px";

            var rewardDivBg = document.getElementById("rewardDivBg");
            rewardDivBg.style.width = showDiv.offsetWidth + "px";

            var timeDiv = document.getElementById("timeDiv");
            timeDiv.style.left = (showDiv.offsetWidth - timeDiv.offsetWidth) * 0.5 + "px";
        }
    }

    var uiDiv = document.getElementById("uiDiv");
    if (uiDiv) {
        uiDiv.style.width = window.innerWidth + "px";
        uiDiv.style.height = window.innerHeight + "px";
    }

    //推荐人界面
    var createInviteDiv = document.getElementById("createInviteDiv");
    if (createInviteDiv) {
        createInviteDiv.style.left = (window.innerWidth * 0.5 - createInviteDiv.offsetWidth * 0.5) + "px";
        createInviteDiv.style.top = (window.innerHeight * 0.5 - createInviteDiv.offsetHeight * 0.5) + "px";
        createInviteDiv.style.transform = transformScale;
    }

    for (var i = 0; i < 4; i++) {
        var divObj = document.getElementById("earth_tip_image_div_" + i);
        if (divObj) {
            if(CheckCurrentOs().isTablet){
                var scaleX = window.innerWidth / curWidth < 0.7?0.7:window.innerWidth / curWidth;
                var scaleY = window.innerHeight / curHeight > 1?window.innerHeight / curHeight*0.7:window.innerHeight / curHeight;
                divObj.style.transform = "scale(" + scaleX + "," + scaleY + ")";
            }else if (CheckCurrentOs().isPc) {
                var curheight = (window.innerHeight / curHeight < 1) ? window.innerHeight / curHeight * 0.9 : (window.innerHeight / curHeight);
                divObj.style.transform = "scale(" + window.innerWidth / curWidth + "," + curheight + ")";
            }
        }
    }
}

function createOnePage(parent, str) {

    var spanValue = ["last_win_buyer", "balance", "balance", "sell_keys"];
    var oneDiv = document.createElement("div");
    oneDiv.style.position = "absolute";
    oneDiv.style.left = "34px";
    oneDiv.style.top = "20px";
    oneDiv.style.width = "428px";
    oneDiv.style.height = "129px";
    oneDiv.style.position = "absolute";
    oneDiv.style["background-image"] = "url(assets/earth/img/leftImage_4.png)";
    oneDiv.style["background-size"] = "100% 100%";
    oneDiv.style["background-repeat"] = "no-repeat";
    parent.appendChild(oneDiv);

    var winText = document.createElement("div");
    winText.innerText = str[0];
    winText.id = "winText";
    winText.style.color = "#00ed9b";
    winText.style.position = "absolute";
    winText.style.left = "32px";
    winText.style.top = "56px";
    winText.style.fontSize = "18px";
    oneDiv.appendChild(winText);

    var winTextNameDiv = document.createElement("div");
    winTextNameDiv.style.position = "absolute";
    winTextNameDiv.style.right = "25px";
    winTextNameDiv.style.bottom = "20px";
    winTextNameDiv.style.width = "200px";
    winTextNameDiv.style.height = "45px";
    oneDiv.appendChild(winTextNameDiv);

    var nameText = document.createElement("span");
    nameText.id = "winTextName";
    nameText.innerText = "";
    nameText.style["line-height"] = "45px";
    nameText.style["text-align"] = "center";
    nameText.style["display"] = "block";
    nameText.style.fontSize = "18px";
    winTextNameDiv.appendChild(nameText);

    var twoDiv = document.createElement("div");
    twoDiv.style.position = "absolute";
    twoDiv.style.left = "34px";
    twoDiv.style.top = "140px";
    twoDiv.style.width = "430px";
    twoDiv.style.height = "422px";
    twoDiv.style["background-image"] = "url(assets/earth/img/leftImage_3.png)";
    twoDiv.style["background-size"] = "100% 100%";
    twoDiv.style["background-repeat"] = "no-repeat";
    parent.appendChild(twoDiv);

    for (var i = 0; i < 3; i++) {
        var bgImage = document.createElement("div");
        bgImage.id = "bgImage_" + i;
        bgImage.style["text-align"] = "center";
        bgImage.style["background-image"] = "url(assets/earth/img/leftImage_1.png)";
        bgImage.style["background-size"] = "100% 100%";
        bgImage.style["background-repeat"] = "no-repeat";
        bgImage.style.width = "382px";
        bgImage.style.height = "107px";
        bgImage.style.position = "absolute";
        bgImage.style.top = 40 + 120 * i + "px";
        bgImage.style.left = "25px";
        twoDiv.appendChild(bgImage);

        var progress = document.createElement("div");
        progress.id = "progress_" + i;
        progress.style["background-image"] = "url(assets/earth/img/leftImage_2.png)";
        progress.style.position = "absolute";
        progress.style["background-size"] = "100% 100%";
        progress.style["background-repeat"] = "no-repeat";
        progress.style.width = "257px";
        progress.style.height = "16px";
        progress.style.top = "25px";
        progress.style.left = "25px";
        //progress.style.clip = "rect(0px," + progress.offsetWidth*0.3 + "px," + progress.offsetHeight + "px,0px)";
        bgImage.appendChild(progress);

        var valueDiv = document.createElement("div");
        valueDiv.style.width = "270px";
        valueDiv.style.height = "30px";
        valueDiv.style.bottom = "17px";
        valueDiv.style.left = "14px";
        valueDiv.style.position = "absolute";
        bgImage.appendChild(valueDiv);


        var valueTextDiv = document.createElement("div");
        valueTextDiv.style.width = "200px";
        valueTextDiv.style.height = "30px";
        valueTextDiv.style.bottom = "0px";
        valueTextDiv.style.left = "0px";
        valueTextDiv.style.position = "absolute";
        valueDiv.appendChild(valueTextDiv);

        var valueText = document.createElement("div");
        valueText.id = "valueText_" + i;
        valueText.innerText = "100000";
        valueText.style.position = "absolute";
        valueText.style.width = "200px";
        valueText.style.margin = "0 auto";
        valueText.style["line-height"] = "30px";
        valueText.style["text-align"] = "center";
        valueText.style["font-size"] = "22px";
        valueText.style["font-family"] = "inherit";
        valueTextDiv.appendChild(valueText);

        var valueTypeDiv = document.createElement("div");
        valueTypeDiv.style.width = "70px";
        valueTypeDiv.style.height = "30px";
        valueTypeDiv.style.bottom = "0px";
        valueTypeDiv.style.right = "0px";
        valueTypeDiv.style.position = "absolute";
        valueDiv.appendChild(valueTypeDiv);

        var valueType = document.createElement("div");
        valueType.style["background-image"] = "url(assets/earth/img/leftImage_" + (i + 6) + ".png)";
        valueType.style.position = "absolute";
        valueType.style["background-size"] = "100% 100%";
        valueType.style["background-repeat"] = "no-repeat";
        valueType.style.width = "22px";
        valueType.style.height = "22px";
        valueType.style.margin = "4px auto";
        valueTypeDiv.appendChild(valueType);

        var nameDiv = document.createElement("div");
        nameDiv.innerText = str[i + 1];
        nameDiv.id = "onePageNameDiv_" + i;
        nameDiv.style.position = "absolute";
        nameDiv.style.color = "#00ed9b";
        nameDiv.style.right = "37px";
        nameDiv.style.width = "45px";
        nameDiv.style.height = "60px";
        nameDiv.style.bottom = "24px";
        nameDiv.style["line-height"] = "25px";
        nameDiv.style["font-size"] = "16px";
        bgImage.appendChild(nameDiv);
    }

    var jsonInfo = [
        ["leftImage_5.png"],
        ["top", "80px"],
        ["left", "484px"],
        ["top", "230px"],
        ["left", "-14px"],
        ["rotate(0deg)"]
    ];
    createOtherDiv(parent, jsonInfo, 1);
}

function createTwoPage(parent) {

    var keyDiv = document.createElement("div");
    keyDiv.id = "keyDiv";
    keyDiv.className = "keyDiv";
    parent.appendChild(keyDiv);

    var div_1 = document.createElement("div");
    div_1.style["background-image"] = "url(assets/earth/img/rightTopImage_6.png)";
    div_1.style.position = "absolute";
    div_1.style.width = "403px";
    div_1.style.height = "61px";
    div_1.style.top = "90px";
    div_1.style.right = "30px";
    div_1.style["background-size"] = "100% 100%";
    div_1.style["background-repeat"] = "none";
    keyDiv.appendChild(div_1);

    var inputText = document.createElement("input");
    inputText.id = "myInput";
    inputText.type = "text";
    inputText.value = "1";
    inputText.style["text-align"] = "center";
    inputText.style["vertical-align"] = "middle";
    inputText.style.position = "absolute";
    inputText.style.top = "10px";
    inputText.style.left = "64px";
    inputText.style.width = "150px";
    inputText.style.height = "40px";
    inputText.style.border = "none";
    inputText.style.fontSize = "20px";
    inputText.style.background = "rgba(255,255,255,0)";
    inputText.style.color = "#ffff4c";
    div_1.appendChild(inputText);

    var proValue = document.createElement("div");
    proValue.id = "proDiv";
    proValue.innerHTML = "@0.0000EOS";
    proValue.style.width = "150px";
    proValue.style.height = "61px";
    proValue.style["text-align"] = "center";
    proValue.style["line-height"] = "61px";
    proValue.style.color = "#00ed9b";
    proValue.style.position = "absolute";
    proValue.style.right = "24px";
    proValue.style.fontSize = "18px";
    div_1.appendChild(proValue);

    var div_2 = document.createElement("div");
    div_2.style["background-image"] = "url(assets/earth/img/rightTopImage_5.png)";
    div_2.style.position = "absolute";
    div_2.style.width = "406px";
    div_2.style.height = "205px";
    div_2.style.top = "170px";
    div_2.style.right = "30px";
    div_2.style["background-size"] = "100% 100%";
    div_2.style["background-repeat"] = "no-repeat";
    keyDiv.appendChild(div_2);

    var str = ["空投几率：", "空投池："];

    for (var i = 0; i < 2; i++) {
        var bgImage = document.createElement("div");
        bgImage.style["background-color"] = "#012a1a";
        bgImage.style.position = "absolute";
        bgImage.style.width = "180px";
        bgImage.style.height = "30px";
        bgImage.style.top = 25 + 40 * i + "px";
        bgImage.style.left = "30px";
        bgImage.style["background-size"] = "100% 100%";
        bgImage.style["background-repeat"] = "no-repeat";
        div_2.appendChild(bgImage);

        var tipShow = document.createElement("div");
        tipShow.innerHTML = str[i];
        tipShow.id = "twoTipShow_" + i;
        tipShow.style.position = "absolute";
        tipShow.style.left = "10px";
        tipShow.style.color = "#00ed9b";
        tipShow.style["text-align"] = "center";
        tipShow.style["line-height"] = "30px";
        tipShow.style["font-size"] = "14px";
        bgImage.appendChild(tipShow);

        var airDropPool = document.createElement("div");
        airDropPool.innerHTML = "1";
        airDropPool.id = "airDropPool_" + i;
        airDropPool.style.color = "#0dc564";
        airDropPool.style["background-image"] = "url(assets/earth/img/rightTopImage_1.png)";
        airDropPool.style.position = "absolute";
        airDropPool.style.width = "136px";
        airDropPool.style.height = "28px";
        airDropPool.style["text-align"] = "center";
        airDropPool.style["line-height"] = "28px";
        airDropPool.style.right = "25px";
        airDropPool.style.top = 25 + 40 * i + "px";
        airDropPool.style.fontSize = "14px";
        div_2.appendChild(airDropPool);
    }

    var numStr = ["+1key", "+5key", "+10", "+100"];
    var numValue = [1, 5, 10, 100];
    for (var j = 0; j < 4; j++) {
        var haveBtn = document.createElement("button");
        haveBtn.id = "haveBtn_" + j;
        haveBtn.style.color = "#0dc564";
        haveBtn.innerHTML = numStr[j];
        haveBtn.style.width = "75px";
        haveBtn.style.height = "33px";
        haveBtn.style["font-size"] = "14px";
        haveBtn.style["background-image"] = "url(assets/earth/img/rightTopImage_4.png)";
        haveBtn.style["background-size"] = "100% 100%";
        haveBtn.style["background-repeat"] = "no-repeat";
        haveBtn.style.position = "absolute";
        haveBtn.style.top = "112px";
        haveBtn.style["text-align"] = "center";
        haveBtn.style["line-height"] = "33px";
        haveBtn.style.left = 30 + 90 * j + "px";
        haveBtn.setAttribute("index", j.toString());
        haveBtn.addEventListener("mouseout", btnChangeOut);
        haveBtn.addEventListener("mousedown", btnChangeDown);
        haveBtn.addEventListener("click", btnChange);
        div_2.appendChild(haveBtn);
    }

    function btnChange(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        var curIndex = parseInt(target.getAttribute("index"));
        console.log(curIndex);

        if (inputValueCheck(inputText.value, 1)) {
            inputText.value = "" + (parseInt(inputText.value) + numValue[curIndex]);
        } else {
            inputText.value = "" + numValue[curIndex];
        }

        target.style["background-image"] = "url(assets/earth/img/rightTopImage_4.png)";
        target.style.width = "75px";
        target.style.height = "33px";
    }

    function btnChangeOut(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        var curIndex = parseInt(target.getAttribute("index"));
        console.log(curIndex);
        target.style["background-image"] = "url(assets/earth/img/rightTopImage_4.png)";
        target.style.width = "75px";
        target.style.height = "33px";
    }

    function btnChangeDown(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        var curIndex = parseInt(target.getAttribute("index"));
        console.log(curIndex);
        target.style["background-image"] = "url(assets/earth/img/rightTopImage_7.png)";
        target.style.width = "92px";
        target.style.height = "50px";
    }

    var buyBtn = document.createElement("div");
    buyBtn.style.color = "#ffff4c";
    buyBtn.innerHTML = "购买";
    buyBtn.id = "curBuyBtn";
    buyBtn.style.width = "169px";
    buyBtn.style.height = "38px";
    buyBtn.style["text-align"] = "center";
    buyBtn.style["line-height"] = "38px";
    buyBtn.style["font-size"] = "18px";
    buyBtn.style["background-image"] = "url(assets/earth/img/rightTopImage_2.png)";
    buyBtn.style.position = "absolute";
    buyBtn.style.top = "166px";
    buyBtn.style.right = "5px";
    buyBtn.addEventListener("click", buyBtnClick);
    buyBtn.addEventListener("mouseout", buyBtnOutClick);
    buyBtn.addEventListener("mousedown", buyBtnDownClick);
    div_2.appendChild(buyBtn);

    function buyBtnClick() {
        console.log("购买通信");
        if (!gameInfo.uInfo || gameInfo.uInfo.length == 0) {
            var msg = (languageType == 0) ? "请先充值，激活游戏账号!" : "Please recharge first and activate the game account!";
            msgTip(msg);
            return;
        }

        if (!isStart) {
            var msg = (languageType == 0) ? "游戏暂未开始，请耐心等待！" : "The game is not yet started. Please be patient!";
            msgTip(msg);
            return;
        }

        if (inputValueCheck(inputText.value, 1)) {
            if(gameInfo.uInfo.balance*0.0001 >= Number(inputText.value)*(gameInfo.gInfo.key_price * 0.0001)){
                createTip_1(0, parseInt(inputText.value), (languageType == 0) ? "如果购买，请按下确定按钮" : "If you buy, press the confirm button");
            }else{
                var msg = (languageType == 0) ? "账户余额不足" : "Insufficient account balance";
                msgTip(msg);                
            }            
        } else {
            var msg = (languageType == 0) ? "请输入数字" : "Please Enter A Number";
            msgTip(msg);
        }

    }

    function buyBtnOutClick() {

    }

    function buyBtnDownClick() {

    }

    var jsonInfo = [
        ["rightTopImage_3.png"],
        ["top", "118px"],
        ["right", "440px"],
        ["top", "260px"],
        ["right", "-14px"],
        ["rotate(180deg)"]
    ];
    createOtherDiv(parent, jsonInfo, 2);
}

function msgTip(msg, type) {

    if (msg.length == 0) { return }

    if ($("#msgDiv").length > 0) {
        $("#msgText")[0].innerText = msg;
        return;
    }
    var msgDiv = document.createElement("div");
    msgDiv.id = "msgDiv";
    msgDiv.style.position = "absolute";
    msgDiv.style.width = window.innerWidth + "px";
    msgDiv.style.height = window.innerHeight + "px";
    msgDiv.style["background-color"] = "rgba(0,0,0,0.8)";
    msgDiv.style.top = "0px";
    document.body.appendChild(msgDiv);

    var msgBg = document.createElement("div");
    msgBg.id = "msgBg";
    msgBg.style.width = "747px";
    msgBg.style.height = "420px";
    msgBg.style.position = "fixed";
    msgBg.style["background-image"] = "url(assets/earth/tips/bg_background_1.png)";
    msgBg.style["background-size"] = "100% 100%";
    msgBg.style["background-repeat"] = "no-repeat";
    msgBg.style.margin = "auto";
    msgBg.style.left = (document.body.clientWidth * 0.5 - 373.5) + "px";
    msgBg.style.top = (document.body.clientHeight * 0.5 - 210) + "px";
    msgDiv.appendChild(msgBg);

    var textDiv = document.createElement("div");
    textDiv.style["text-align"] = "center";
    textDiv.style.width = msgBg.offsetWidth + "px";
    textDiv.style.height = "300px";
    textDiv.style["line-height"] = "300px";
    textDiv.style["font-size"] = "32px";
    msgBg.appendChild(textDiv);

    var text = document.createElement("div");
    text.innerText = msg;
    text.id = "msgText";
    textDiv.appendChild(text);

    var curBtn = document.createElement("div");
    curBtn.innerHTML = (languageType == 0) ? "确定" : "Confirm";
    curBtn.style["text-align"] = "center";
    curBtn.style["line-height"] = "70px";
    curBtn.style.position = "absolute";
    curBtn.style["font-size"] = "24px";
    curBtn.style.width = "249px";
    curBtn.style.height = "77px";
    curBtn.style.bottom = "80px";
    curBtn.style.left = msgBg.offsetWidth * 0.5 - 125 + "px";
    curBtn.style["background-image"] = "url(assets/earth/tips/btn_ok.png)";
    curBtn.style["background-size"] = "100% 100%";
    curBtn.style["background-repeat"] = "none";
    curBtn.addEventListener("click", btnRemoveClick);
    msgBg.appendChild(curBtn);

    function btnRemoveClick() {
        if (type) {
            var html = (languageType == 0) ? "zn.html" : "en.html";
            var htmlPath = "strategy/" + html;
            window.open(htmlPath);
        }
        msgDiv.remove();
    }

}

//确定or取消统一弹框  0购买 1提现
function createTip_1(type, num, str) {
    var uiDiv = document.getElementById("uiDiv");
    uiDiv.style.visibility = "visible";

    var keybuyDiv = document.createElement("div");
    keybuyDiv.className = "keybuyDiv";
    keybuyDiv.id = keybuyDiv.className;
    keybuyDiv.style.width = "747px";
    keybuyDiv.style.height = "420px";
    keybuyDiv.style.position = "fixed";
    keybuyDiv.style["background-image"] = "url(assets/earth/tips/bg_background_1.png)";
    keybuyDiv.style["background-size"] = "100% 100%";
    keybuyDiv.style["background-repeat"] = "no-repeat";
    keybuyDiv.style.margin = "auto";
    keybuyDiv.style.left = (document.body.clientWidth * 0.5 - 373.5) + "px";
    keybuyDiv.style.top = (document.body.clientHeight * 0.5 - 210) + "px";
    uiDiv.appendChild(keybuyDiv);
    console.log(document.body.clientWidth, document.body.clientHeight);

    var buyText = document.createElement("div");
    buyText.innerHTML = str;
    buyText.style["text-align"] = "center";
    buyText.style["line-height"] = "300px";
    buyText.style["font-size"] = "32px";
    keybuyDiv.appendChild(buyText);

    var btnStr = (languageType == 0) ? ["取消", "确定"] : ["Cancel", "Confirm"];
    for (var i = 0; i < 2; i++) {
        var curBtn = document.createElement("div");
        curBtn.innerHTML = btnStr[i];
        curBtn.style["text-align"] = "center";
        curBtn.style["line-height"] = "70px";
        curBtn.style.position = "absolute";
        curBtn.style["font-size"] = "24px";
        curBtn.style.top = "283px";
        curBtn.style.left = (340 * i + 80) + "px";
        curBtn.style.width = "249px";
        curBtn.style.height = "77px";

        if (i == 0) {
            curBtn.style.color = "#00ed9b";
            curBtn.style["background-image"] = "url(assets/earth/tips/btn_cancle.png)";
        } else {
            curBtn.style["background-image"] = "url(assets/earth/tips/btn_ok.png)";
        }

        curBtn.style["background-size"] = "100% 100%";
        curBtn.style["background-repeat"] = "none";
        curBtn.addEventListener("mousedown", curBtnDownFunc);
        curBtn.addEventListener("mouseout", curBtnOutFunc);
        curBtn.addEventListener("click", curBtnUpFunc);
        curBtn.setAttribute("index", i.toString());
        keybuyDiv.appendChild(curBtn);
    }

    function curBtnDownFunc(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        target.style["background-image"] = "url(assets/earth/tips/btn_press.png)";
        var curIndex = parseInt(target.getAttribute("index"));
        if (curIndex == 0) {
            target.style.color = "#ffffff";
        }
    }

    function curBtnOutFunc(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        var curIndex = parseInt(target.getAttribute("index"));
        if (curIndex == 0) {
            target.style.color = "#00ed9b";
            target.style["background-image"] = "url(assets/earth/tips/btn_cancle.png)";
        } else {
            target.style["background-image"] = "url(assets/earth/tips/btn_ok.png)";
        }
    }


    function curBtnUpFunc(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        var curIndex = parseInt(target.getAttribute("index"));
        if (curIndex == 0) {
            target.style.color = "#00ed9b";
            target.style["background-image"] = "url(assets/earth/tips/btn_cancle.png)";
        } else {
            target.style["background-image"] = "url(assets/earth/tips/btn_ok.png)";
        }

        if (curIndex == 0) {
            keybuyDiv.remove();
            uiDiv.style.visibility = "hidden";

        } else if (curIndex == 1) {
            if (type == 0) {
                console.log("购买通信");
                var inputText = document.getElementById("inputText");
                console.log(gameInfo.accountsInfo.name, num, gameMode);
                netInfo.keybuy({ "user": gameInfo.accountsInfo.name, "num": num, "gamemode": gameMode }, { authorization: [gameInfo.accountsInfo.name + '@active'] });
            } else {
                console.log("提取通信");
                netInfo.withdraw({ "user": gameInfo.accountsInfo.name, "quantity": (gameInfo.uInfo.income * 0.0001).toFixed(4) + " EOS" }, { authorization: [gameInfo.accountsInfo.name + '@active'] });
            }
            keybuyDiv.remove();
            uiDiv.style.visibility = "hidden";
        }
    }
}

//带输入框的统一弹框 0充值 1加入战队
function createTipWithInput(type, titlestr, str) {
    var uiDiv = document.getElementById("uiDiv");
    uiDiv.style.visibility = "visible";

    var rechargeDiv = document.createElement("div");
    rechargeDiv.className = "rechargeDiv";
    rechargeDiv.id = rechargeDiv.className;
    rechargeDiv.style.width = "747px";
    rechargeDiv.style.height = "420px";
    rechargeDiv.style.position = "fixed";
    rechargeDiv.style["background-image"] = "url(assets/earth/tips/bg_background_1.png)";
    rechargeDiv.style["background-size"] = "100% 100%";
    rechargeDiv.style["background-repeat"] = "no-repeat";
    rechargeDiv.style.margin = "auto";
    rechargeDiv.style.left = (document.body.clientWidth * 0.5 - 373.5) + "px";
    rechargeDiv.style.top = (document.body.clientHeight * 0.5 - 210) + "px";
    uiDiv.appendChild(rechargeDiv);
    console.log(document.body.clientWidth, document.body.clientHeight);


    var title = document.createElement("div");
    title.style.position = "absolute";
    title.style.width = rechargeDiv.offsetWidth + "px";
    title.style.height = "100px";
    title.style["text-align"] = "center";
    title.style["line-height"] = "100px";
    title.style["font-size"] = "60px";
    title.style.top = "-60px";
    rechargeDiv.appendChild(title);

    var titleText = document.createElement("div");
    titleText.innerText = titlestr;
    title.appendChild(titleText);


    var inputBg = document.createElement("div");
    inputBg.className = "rechargeInputBg";
    inputBg.style.width = "568px";
    inputBg.style.height = "75px";
    inputBg.style.position = "absolute";
    inputBg.style["background-image"] = "url(assets/earth/tips/input_bg.png)";
    inputBg.style["background-size"] = "100% 100%";
    inputBg.style["background-repeat"] = "no-repeat";
    inputBg.style.left = "100px";
    inputBg.style.top = "120px";
    rechargeDiv.appendChild(inputBg);

    var rechargeText = document.createElement("div");
    rechargeText.style["text-align"] = "center";
    rechargeText.style["line-height"] = "74px";
    rechargeText.style.width = "170px";
    rechargeText.style.height = "74px";
    rechargeText.style["font-size"] = "32px";
    inputBg.appendChild(rechargeText);

    var rechargeInfo = document.createElement("div");
    rechargeInfo.innerText = str;
    rechargeText.appendChild(rechargeInfo);

    //输入框
    var inputText = document.createElement("input");
    inputText.name = "rechargeInput";
    inputText.type = "text";
    inputText.value = type == 0?"1":"";
    inputText.style["text-align"] = "center";
    inputText.style["vertical-align"] = "middle";
    inputText.style.position = "absolute";
    inputText.style.top = "0px";
    inputText.style.left = "172px";
    inputText.style.width = "395px";
    inputText.style.height = "75px";
    inputText.style.border = "none";
    inputText.style.background = "rgba(255,255,255,0)";
    inputText.style.color = "#ffff4c";
    inputText.style.fontSize = "32px";
    inputText.maxLength = 7;
    inputText.setAttribute("placeholder", (languageType == 0) ? "输入战队名" : "Import team name");
    inputBg.appendChild(inputText);


    var btnStr = (languageType == 0) ? ["取消", "确定"] : ["Cancel", "Confirm"];
    for (var i = 0; i < 2; i++) {
        var curBtn = document.createElement("div");
        curBtn.innerHTML = btnStr[i];
        curBtn.style["text-align"] = "center";
        curBtn.style["line-height"] = "70px";
        curBtn.style.position = "absolute";
        curBtn.style["font-size"] = "24px";
        curBtn.style.top = "283px";
        curBtn.style.left = (340 * i + 80) + "px";
        curBtn.style.width = "249px";
        curBtn.style.height = "77px";

        if (i == 0) {
            curBtn.style.color = "#00ed9b";
            curBtn.style["background-image"] = "url(assets/earth/tips/btn_cancle.png)";
        } else {
            curBtn.style["background-image"] = "url(assets/earth/tips/btn_ok.png)";
        }

        curBtn.style["background-size"] = "100% 100%";
        curBtn.style["background-repeat"] = "none";
        curBtn.addEventListener("mousedown", curBtnDownFunc);
        curBtn.addEventListener("mouseout", curBtnOutFunc);
        curBtn.addEventListener("click", curBtnUpFunc);
        curBtn.setAttribute("index", i.toString());
        rechargeDiv.appendChild(curBtn);
    }

    function curBtnDownFunc(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        target.style["background-image"] = "url(assets/earth/tips/btn_press.png)";
        var curIndex = parseInt(target.getAttribute("index"));
        if (curIndex == 0) {
            target.style.color = "#ffffff";
        }
    }

    function curBtnOutFunc(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        var curIndex = parseInt(target.getAttribute("index"));
        if (curIndex == 0) {
            target.style.color = "#00ed9b";
            target.style["background-image"] = "url(assets/earth/tips/btn_cancle.png)";
        } else {
            target.style["background-image"] = "url(assets/earth/tips/btn_ok.png)";
        }
    }

    async function curBtnUpFunc(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        var curIndex = parseInt(target.getAttribute("index"));
        if (curIndex == 0) {
            target.style.color = "#00ed9b";
            target.style["background-image"] = "url(assets/earth/tips/btn_cancle.png)";
        } else {
            target.style["background-image"] = "url(assets/earth/tips/btn_ok.png)";
        }

        var teamDiv = document.getElementById("teamDiv");
        if (curIndex == 0) {
            rechargeDiv.remove();
            if(teamDiv){
                teamDiv.style.display = "block";
            }else{
                uiDiv.style.visibility = "hidden";
            }
        } else if (curIndex == 1) {

            if(teamDiv){
                teamDiv.remove();
            }
            if (type == 0) {
                if (checkIsNum(inputText.value)) {
                    console.log("充值通信", parseInt(inputText.value).toFixed(4));
                    if(window.eosKey){
                        window.eosKey.transaction(
                            {
                                actions: [
                                    {
                                        account: 'eosio.token',
                                        name: 'transfer',
                                        authorization: [{
                                            actor: gameInfo.accountsInfo.name,
                                            permission: 'active'
                                        }],
                                        data: {
                                            from: gameInfo.accountsInfo.name,
                                            to: "eos2goodluck",
                                            quantity: parseInt(inputText.value).toFixed(4) + " EOS",
                                            memo: 'MEMO'
                                        }
                                    }
                                ]
                            })                        
                    }else{
                        const data = {
                            from: gameInfo.accountsInfo.name,
                            to: "eos2goodluck",
                            quantity: parseInt(inputText.value).toFixed(4) + " EOS",
                            memo: "MEMO"
                        }
                        var transfer = await contract.transfer(data, {
                            authorization: [gameInfo.accountsInfo.name + '@active']
                        }).catch(console.error);
                        console.log(transfer);
                        if (transfer.broadcast) {
                            isRech = true;
                        }
                    }

                } else {
                    var msg = (languageType == 0) ? "请输入数字" : "Please Enter A Number";
                    msgTip(msg);
                }
            } else {

                if (checkIsHasSpecialStr(inputText.value)) {
                    var msg = (languageType == 0) ? "请输入正确的战队名称" : "Please Enter The Correct Team Name";
                    msgTip(msg);
                    return;
                }
                var isHave = false;
                if(gameInfo.tInfo){
                    for(var i = 0; i < gameInfo.tInfo.length; i++){
                        var teamInfo = gameInfo.tInfo[i];
                        if(inputText.value == teamInfo.name){
                            isHave = true;
                            break;
                        }
                    }
                }
                if(!isHave){
                    var msg = (languageType == 0) ? "没有此战队!" : "No team";
                    msgTip(msg);
                    return;                    
                }
                netInfo.teamjoin({ "user": gameInfo.accountsInfo.name, "team": inputText.value, "gamemode": 1 }, { authorization: [gameInfo.accountsInfo.name + '@active'] });
                console.log("加入战队通信");
            }

            rechargeDiv.remove();
            uiDiv.style.visibility = "hidden";
        }
    }
}

function createThreePage(parent) {

    var str = ["我的Keys：", "本轮消耗EOS：", "我的推荐人：", "账户余额：", "战队分红：", "推荐奖励：", "KEY分红：", "中奖分红：", "总收入："];
    var bgDiv = document.createElement("div");
    bgDiv.style.position = "absolute";
    bgDiv.style.left = "30px";
    bgDiv.style.bottom = "0px";
    bgDiv.style.width = "455px";
    bgDiv.style.height = "249px";
    bgDiv.style.position = "absolute";
    bgDiv.style["background-image"] = "url(assets/earth/img/leftBotImage_5.png)";
    bgDiv.style["background-size"] = "100% 100%";
    bgDiv.style["background-repeat"] = "no-repeat";
    parent.appendChild(bgDiv);

    var oneDiv = document.createElement("div");
    oneDiv.className = "hd";
    bgDiv.appendChild(oneDiv);

    for (var s = 0; s < 2; s++) {
        var spanT = document.createElement("div");
        spanT.style.position = "absolute";
        spanT.id = "threePaSpanT_" + s;
        spanT.style.left = 45 + 125 * s + "px";
        spanT.style.top = "5px";
        var imgName = "leftBotImage_2.png";
        if (s == 0) {
            spanT.className = "current";
            spanT.innerHTML = "个人信息";
        } else {
            spanT.innerHTML = "个人收益";
            imgName = "leftBotImage_1.png";
            spanT.style.color = "#0dc564";
        }
        spanT.style.width = "125px";
        spanT.style.height = "21px";
        spanT.style.fontSize = "18px";
        spanT.style["background-image"] = "url(assets/earth/img/" + imgName;
        spanT.style["background-size"] = "100% 100%";
        spanT.style["background-repeat"] = "no-repeat";
        spanT.style["line-height"] = "21px";
        spanT.style["text-align"] = "center";
        oneDiv.appendChild(spanT);
    }

    var twoDiv = document.createElement("div");
    twoDiv.className = "bd";
    bgDiv.appendChild(twoDiv);

    var ol = document.createElement("div");
    twoDiv.appendChild(ol);
    ol.style.position = "absolute";
    ol.style.left = "34px";
    ol.style.top = "42px";

    for (var q = 0; q < 5; q++) {
        var lidiv = document.createElement("div");
        lidiv.className = "lidiv_" + q;
        lidiv.id = lidiv.className;
        lidiv.style.width = "240px";
        lidiv.style.height = "30px";
        lidiv.style.position = "absolute";
        lidiv.style["background-color"] = "#012a1a";
        lidiv.style.top = 38 * q + "px";
        ol.appendChild(lidiv);

        var li = document.createElement("div");
        li.style.color = "#0dc564";
        li.innerText = (q < 4) ? str[q] : "";
        li.style.position = "absolute";
        li.style["line-height"] = "30px";
        li.style["font-size"] = "14px";
        li.style.left = "15px";
        lidiv.appendChild(li);

        var livalue = document.createElement("span");
        livalue.innerText = "";
        livalue.style.position = "absolute";
        livalue.style["line-height"] = "30px";
        livalue.style["font-size"] = "14px";
        livalue.style.right = "10px";
        livalue.style["font-family"] = "initial";
        lidiv.appendChild(livalue);

        lidiv.style.visibility = (q < 4) ? "visible" : "hidden";
    }

    var spans = document.getElementsByClassName("hd")[0].getElementsByTagName("div");
    for (var m = 0; m < spans.length; m++) {
        spans[m].onclick = clickHandle;
        spans[m].setAttribute("index", m.toString());
    }

    var uInfoValue = ["keys", "key_balance", "invite_name", "balance"];
    var uOtherValue = ["team_dividend", "invite_dividend", "key_dividend", "win_dividend", "income"];

    function clickHandle() {
        str = (languageType == 0) ? ["我的Keys：", "本轮消耗EOS：", "我的推荐人：", "账户余额：", "战队分红：", "推荐奖励：", "KEY分红：", "中奖分红：", "总收入："] : ["My Keys：", "Now Consume EOS：", "My Referee：", "Account Sum：", "Team Bonus：", "Referee Bonus：", "KEY Bonus：", "Winning Bonus：", "Total Income："]
        console.log(this.getAttribute("index"));
        var curIndex = this.getAttribute("index");
        curChose = curIndex;
        var lidiv = document.getElementById("lidiv_4");
        lidiv.style.visibility = (curChose == 1) ? "visible" : "hidden";
        var spanV = (curChose == 0) ? uInfoValue : uOtherValue;
        for (var i = 0; i < 5; i++) {
            var parent = document.getElementsByClassName("lidiv_" + i)[0];
            var sp = parent.getElementsByTagName("div");
            sp[0].innerText = (i < 4 || curChose == 1) ? str[4 * curChose + i] : "";
            var spv = parent.getElementsByTagName("span");
            if (gameInfo.uInfo) {
                if (i < 4) {
                    spv[0].innerText = (gameInfo.uInfo[spanV[i]] > 0 || typeof(gameInfo.uInfo[spanV[i]]) == "string") ? ((spanV[i] == "keys" || spanV[i] == "invite_name") ? gameInfo.uInfo[spanV[i]] : (gameInfo.uInfo[spanV[i]] * 0.0001).toFixed(4)) : 0;
                } else {
                    spv[0].innerText = (curChose == 1) ? ((gameInfo.uInfo[spanV[i]] > 0) ? (gameInfo.uInfo[spanV[i]] * 0.0001).toFixed(4) : 0) : "";
                }
            }
        }

        for (var i = 0; i < spans.length; i++) {
            spans[i].style.color = "#0dc564";
            spans[i].style["background-image"] = "url(assets/earth/img/leftBotImage_1.png";
        }
        spans[curIndex].style.color = "white";
        spans[curIndex].style["background-image"] = "url(assets/earth/img/leftBotImage_2.png";

        var hBtn = document.getElementById("sendBtnChose");
        hBtn.innerHTML = (curChose == 1) ? ((languageType == 0) ? "提取" : "Extract") : ((languageType == 0) ? "充值" : "Recharge");

        var inviteBtn = document.getElementById("inviteBtn");
        inviteBtn.style.visibility = (curChose == 1) ? "hidden" : "visible";
    }

    var btnDiv = document.createElement("div");
    btnDiv.style.position = "absolute";
    btnDiv.style.right = "160px";
    btnDiv.style.top = "30px";
    bgDiv.appendChild(btnDiv);

    var btnText = document.createElement("div");
    btnText.innerText = "充值";
    btnText.id = "sendBtnChose";
    btnText.style.position = "absolute";
    btnText.style.color = "#ffff4c";
    btnText.style["line-height"] = "25px";
    btnText.style["font-size"] = "22px";
    btnText.style.width = "100px";
    btnText.style["text-align"] = "center";
    btnText.style.top = "52px";
    btnText.style.left = "15px";
    btnDiv.appendChild(btnText);

    var btnBg = document.createElement("div");
    btnBg.id = "curBtnBg";
    btnBg.style.position = "absolute";
    btnBg.style.width = "130px";
    btnBg.style.height = "130px";
    btnBg.style["background-image"] = "url(assets/earth/img/leftBotImage_3.png";
    btnBg.style["background-size"] = "100% 100%";
    btnBg.style["background-repeat"] = "no-repeat";
    btnBg.addEventListener("mousedown", btnDownFunc);
    btnBg.addEventListener("mouseout", btnOutFunc);
    btnBg.addEventListener("click", btnUpFunc);
    btnDiv.appendChild(btnBg);

    var inviteBtn = document.createElement("button");
    inviteBtn.style.color = "#ffff4c";
    inviteBtn.id = "inviteBtn";
    inviteBtn.innerHTML = "推荐人";
    inviteBtn.style.width = "169px";
    inviteBtn.style.height = "38px";
    inviteBtn.style["font-size"] = "18px";
    inviteBtn.style["background-image"] = "url(assets/earth/img/rightTopImage_2.png)";
    inviteBtn.style["background-size"] = "100% 100%";
    inviteBtn.style["background-repeat"] = "no-repeat";
    inviteBtn.style["text-align"] = "center";
    inviteBtn.style["line-height"] = "38px";
    inviteBtn.style.position = "absolute";
    inviteBtn.style.bottom = "16px";
    inviteBtn.style.left = "85px";
    inviteBtn.setAttribute("pobBuyBtnIndex", q.toString());
    inviteBtn.addEventListener("click", curBtnClick);
    bgDiv.appendChild(inviteBtn);

    function curBtnClick() {
        if (gameInfo.uInfo && gameInfo.uInfo.invite_name.length > 0) {
            var msg = (languageType == 0) ? "已有推荐人!" : "Referees already available!";
            msgTip(msg);
            return;
        }

        if (!gameInfo.uInfo) {
            var msg = (languageType == 0) ? "请先充值，激活游戏账号!" : "Please recharge first and activate the game account!";
            msgTip(msg);
            return;
        }
        createInviteBg();
    }

    setInterval(function() {
        var curBtnBg = document.getElementById("curBtnBg");
        var curDeg = 0;
        if (curBtnBg) {
            if (curBtnBg.style.transform) {
                curDeg = Number(curBtnBg.style.transform.split("(")[1].split(")")[0].split("deg")[0]);
                curDeg = (curDeg < 360) ? (curDeg + 2) : 0;
            }
            curBtnBg.style.transform = "rotate(" + curDeg + "deg)";
        }
    }, 50);

    function btnDownFunc() {
        btnText.style.color = "cyan";
    }

    async function btnUpFunc() {
        btnText.style.color = "#ffff4c";
        if (!gameInfo.accountsInfo) {
            var msg = (languageType == 0) ? "请登录EOS钱包后刷新游戏！" : "Please login to EOS wallet to refresh the game!";
            msgTip(msg);
            return;
        }
        if (curChose == 1) {
            console.log("提取");
            if(gameInfo.uInfo.income * 0.0001 > 0){
                createTip_1(1, 0, (languageType == 0) ? "如果提取，请按下确定按钮" : "If it is extracted, press the confirm button");
            }else{
                var msg = (languageType == 0) ? "收入为0时不能提取！" : "When income is 0, it can not be extracted!";
                msgTip(msg);                
            }
            
        } else {
            console.log("充值");
            if (!isStart) {
                var msg = (languageType == 0) ? "游戏暂未开始，请耐心等待！" : "The game is not yet started. Please be patient!";
                msgTip(msg);
                return;
            }
            createTipWithInput(0, (languageType == 0) ? "充  值" : "Recharge", (languageType == 0) ? "充值金额" : "Amount");
        }
    }

    function btnOutFunc() {
        btnText.style.color = "#ffff4c";
    }

    var jsonInfo = [
        ["leftBotImage_4.png"],
        ["bottom", "140px"],
        ["left", "500px"],
        ["bottom", "244px"],
        ["left", "-14px"],
        ["rotate(0deg)"]
    ];
    createOtherDiv(parent, jsonInfo, 3);
}

//推荐人弹框
function createInviteBg() {
    var uiDiv = document.getElementById("uiDiv");
    uiDiv.style.visibility = "visible";

    var createInviteDiv = document.createElement("div");
    createInviteDiv.id = "createInviteDiv";
    createInviteDiv.style.width = "747px";
    createInviteDiv.style.height = "420px";
    createInviteDiv.style.position = "absolute";
    createInviteDiv.style["background-image"] = "url(assets/earth/tips/bg_background_1.png)";
    createInviteDiv.style["background-size"] = "100% 100%";
    createInviteDiv.style["background-repeat"] = "no-repeat";
    //createInviteDiv.style.margin = "auto";
    createInviteDiv.style.left = (document.body.clientWidth * 0.5 - 373.5) + "px";
    createInviteDiv.style.top = (document.body.clientHeight * 0.5 - 210) + "px";
    uiDiv.appendChild(createInviteDiv);


    var title_1 = document.createElement("div");
    title_1.style.position = "absolute";
    title_1.style.width = createInviteDiv.offsetWidth + "px";
    title_1.style.height = "50px";
    title_1.style["text-align"] = "center";
    title_1.style["line-height"] = "100px";
    title_1.style["font-size"] = "40px";
    title_1.style.left = "0px";
    title_1.style.top = "-70px";
    createInviteDiv.appendChild(title_1);

    var titleText_1 = document.createElement("div");
    titleText_1.innerText = (languageType == 0) ? "推荐人" : "Referee";
    title_1.appendChild(titleText_1);


    var title_2 = document.createElement("div");
    title_2.style.position = "absolute";
    title_2.style.width = createInviteDiv.offsetWidth + "px";
    title_2.style.height = "100px";
    title_2.style["text-align"] = "center";
    title_2.style["line-height"] = "100px";
    title_2.style["font-size"] = "20px";
    title_2.style.top = "37px";
    createInviteDiv.appendChild(title_2);

    var titleText_2 = document.createElement("div");
    titleText_2.innerText = (languageType == 0) ? "请填入您的推荐人钱包账号，您将获得额外的Token分红！" : "Input your purse wallet account, and you will get an additional Token bonus.";
    title_2.appendChild(titleText_2);


    var title_3 = document.createElement("div");
    title_3.style.position = "absolute";
    title_3.style.width = createInviteDiv.offsetWidth + "px";
    title_3.style.height = "100px";
    title_3.style["text-align"] = "center";
    title_3.style["line-height"] = "100px";
    title_3.style["font-size"] = "18px";
    title_3.style.top = "184px";
    createInviteDiv.appendChild(title_3);

    var titleText_3 = document.createElement("div");
    titleText_3.style.color = "#b7b7b7";
    titleText_3.innerText = (languageType == 0) ? "注：请核对好玩家钱包帐号，再点击确认按钮！" : "Note: please check the wallet account and click the confirmation button!";
    title_3.appendChild(titleText_3);


    var inputBg = document.createElement("div");
    inputBg.className = "inviteInputBg";
    inputBg.style.width = "568px";
    inputBg.style.height = "66px";
    inputBg.style.position = "absolute";
    inputBg.style["background-image"] = "url(assets/earth/tips/input_team.png)";
    inputBg.style["background-size"] = "100% 100%";
    inputBg.style["background-repeat"] = "no-repeat";
    inputBg.style.left = "90px";
    inputBg.style.top = "147px";
    createInviteDiv.appendChild(inputBg);


    var rechargeText = document.createElement("div");
    rechargeText.style["text-align"] = "center";
    rechargeText.style["line-height"] = "68px";
    rechargeText.style.width = "150px";
    rechargeText.style.height = "68px";
    rechargeText.style["font-size"] = "25px";
    inputBg.appendChild(rechargeText);

    var rechargeInfo = document.createElement("div");
    rechargeInfo.innerText = (languageType == 0) ? "推荐人" : "Referee";
    rechargeText.appendChild(rechargeInfo);

    //输入框
    var inputText = document.createElement("input");
    inputText.name = "rechargeInput";
    inputText.type = "text";
    inputText.style["text-align"] = "center";
    inputText.style["vertical-align"] = "middle";
    inputText.style.position = "absolute";
    inputText.style.top = "1px";
    inputText.style.left = "151px";
    inputText.style.width = "417px";
    inputText.style.height = "62px";
    inputText.style.border = "none";
    inputText.style.background = "rgba(255,255,255,0)";
    inputText.style.fontSize = "32px";
    inputText.style.color = "#ffff4c";
    inputText.setAttribute("placeholder", (languageType == 0) ? "输入推荐人钱包账号" : "Enter the purse account");
    //inputText.maxLength = "6";
    inputBg.appendChild(inputText);

    var okBtn = document.createElement("button");
    okBtn.style.color = "#00ed9b";
    okBtn.id = "okBtn";
    okBtn.innerHTML = (languageType == 0) ? "确定" : "Confirm";
    okBtn.style.width = "265px";
    okBtn.style.height = "67px";
    okBtn.style["font-size"] = "30px";
    okBtn.style["background-image"] = "url(assets/earth/stockRight/btn_token_1.png)";
    okBtn.style["background-size"] = "100% 100%";
    okBtn.style["background-repeat"] = "no-repeat";
    okBtn.style["text-align"] = "center";
    okBtn.style["line-height"] = "38px";
    okBtn.style.position = "absolute";
    okBtn.style.bottom = "37px";
    okBtn.style.left = "250px";
    okBtn.setAttribute("index", "1");
    okBtn.addEventListener("click", okBtnClick);
    createInviteDiv.appendChild(okBtn);

    function okBtnClick(event) {
        console.log("推荐人接口");
        if (checkIsHasSpecialStr(inputText.value)) {
            var msg = (languageType == 0) ? "当前输入不合法，请勿输入特殊符号" : "Current input is not legal. Do not enter special symbols";
            msgTip(msg);
        } else {
            console.log("推荐人接口");
            console.log(inputText.value);
            if (inputText.value && inputText.value.length > 0) {
                netInfo.invite({ "user": gameInfo.accountsInfo.name, "invite": inputText.value, "gamemode": gameMode }, { authorization: [gameInfo.accountsInfo.name + '@active'] });
                createInviteDiv.remove();
                uiDiv.style.visibility = "hidden";
            } else {
                var msg = (languageType == 0) ? "请输入推荐人钱包账号" : "Please Input The Referee Purse Account";
                msgTip(msg);
            }
        }
    }


/*    var rewardBtn = document.createElement("button");
    rewardBtn.style.color = "#ffffff";
    rewardBtn.id = "rewardBtn";
    rewardBtn.innerHTML = (languageType == 0) ? "奖励规则" : "Reward Rules";
    rewardBtn.style.width = "265px";
    rewardBtn.style.height = "67px";
    rewardBtn.style["font-size"] = "30px";
    rewardBtn.style["background-image"] = "url(assets/earth/stockRight/btn_reward_1.png)";
    rewardBtn.style["background-size"] = "100% 100%";
    rewardBtn.style["background-repeat"] = "no-repeat";
    rewardBtn.style["text-align"] = "center";
    rewardBtn.style["line-height"] = "38px";
    rewardBtn.style.position = "absolute";
    rewardBtn.style.bottom = "33px";
    rewardBtn.style.left = "413px";
    rewardBtn.setAttribute("index", "2");
    //rewardBtn.addEventListener("click", curBtnClick);
    createInviteDiv.appendChild(rewardBtn);*/


    var closeBtn = document.createElement("div");
    closeBtn.style.position = "absolute";
    closeBtn.style.right = "-42px";
    closeBtn.style.top = "-10px";
    closeBtn.style.width = "32px";
    closeBtn.style.height = "32px";
    closeBtn.style["background-image"] = "url(assets/earth/tips/btn_close_1.png)";
    closeBtn.style["background-size"] = "100% 100%";
    closeBtn.style["background-repeat"] = "none";
    closeBtn.setAttribute("index", "close");
    closeBtn.addEventListener("mousedown", closebtnDownFunc);
    closeBtn.addEventListener("mouseout", closebtnOutFunc);
    closeBtn.addEventListener("click", closebtnUpFunc);
    createInviteDiv.appendChild(closeBtn);

    function closebtnDownFunc(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        target.style["background-image"] = "url(assets/earth/tips/btn_close_2.png)";
    }

    function closebtnOutFunc(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        target.style["background-image"] = "url(assets/earth/tips/btn_close_1.png)";
    }

    function closebtnUpFunc(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        target.style["background-image"] = "url(assets/earth/tips/btn_close_2.png)";

        createInviteDiv.remove();
        uiDiv.style.visibility = "hidden";
    }

}

function createFourPage(parent, str) {

    var bgDiv = document.createElement("div");
    bgDiv.style.position = "absolute";
    bgDiv.style.right = "18px";
    bgDiv.style.bottom = "0px";
    bgDiv.style.width = "439px";
    bgDiv.style.height = "347px";
    bgDiv.style.position = "absolute";
    bgDiv.style["background-image"] = "url(assets/earth/img/rBottomImage_1.png)";
    bgDiv.style["background-size"] = "100% 100%";
    bgDiv.style["background-repeat"] = "no-repeat";
    parent.appendChild(bgDiv);

    var textBg = document.createElement("div");
    textBg.style.position = "absolute";
    textBg.style["background-color"] = "#012a1a";
    textBg.style.width = "350px";
    textBg.style.height = "180px";
    textBg.style.top = "90px";
    textBg.style.left = "45px";
    bgDiv.appendChild(textBg);

    var pH = document.createElement("ol");
    pH.style.position = "absolute";
    pH.style.right = "24px";
    pH.style["line-height"] = "40px";
    pH.style["font-size"] = "14px";
    pH.style["list-style-type"] = "none";
    pH.style.width = "300px";
    for (var j = 0; j < str.length; j++) {
        var liNode = document.createElement("li");
        liNode.id = "liNode_" + j;
        liNode.innerHTML = str[j];
        pH.appendChild(liNode);
    }
    textBg.appendChild(pH);

    var curStr = ["战队", "玩法详情"];
    for (var q = 0; q < 2; q++) {
        var pobBuyBtn = document.createElement("button");
        pobBuyBtn.style.color = "#0dc564";
        pobBuyBtn.id = "pobBuyBtn_" + q;
        pobBuyBtn.innerHTML = curStr[q];
        pobBuyBtn.style.width = "169px";
        pobBuyBtn.style.height = "38px";
        pobBuyBtn.style["font-size"] = "18px";
        pobBuyBtn.style["background-image"] = "url(assets/earth/img/rightTopImage_2.png)";
        pobBuyBtn.style["background-size"] = "100% 100%";
        pobBuyBtn.style["background-repeat"] = "no-repeat";
        pobBuyBtn.style["text-align"] = "center";
        pobBuyBtn.style["line-height"] = "38px";
        pobBuyBtn.style.position = "absolute";
        pobBuyBtn.style.bottom = "25px";
        var curP = "left";
        if (q == 1) {
            curP = "right";
        }
        pobBuyBtn.style[curP] = "45px";
        pobBuyBtn.setAttribute("pobBuyBtnIndex", q.toString());
        pobBuyBtn.addEventListener("click", curBtnClick);
        pobBuyBtn.addEventListener("mouseout", curBtnClickOut);
        pobBuyBtn.addEventListener("mousedown", curBtnClickDown);
        bgDiv.appendChild(pobBuyBtn);
    }

    function curBtnClick(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        var curIndex = parseInt(target.getAttribute("pobBuyBtnIndex"));
        if (curIndex == 0) {
            console.log("战队");
            if (gameInfo.uInfo) {
                if (gameMode == 1) {
                    var canTouch = (gameInfo.uInfo.team.length == 0 || gameInfo.uInfo.pre_team == 0) ? true : false;
                    if (canTouch) {
                        createTeamDiv();
                    } else {
                        var msg = (gameInfo.uInfo.team.length > 0) ? ((languageType == 0) ? "已有战队" : "Have Team") : "";
                        msgTip(msg);
                    }
                } else {
                    var msg = (languageType == 0) ? "短期暂不支持创建战队!" : "Short term support for the creation of combat teams";
                    msgTip(msg);
                }
            } else {
                var msg = (languageType == 0) ? "请先充值，激活游戏账号!" : "Please recharge first and activate the game account!";
                msgTip(msg);
                return;
            }
        } else {
            var html = (languageType == 0) ? "zn.html" : "en.html";
            var htmlPath = "strategy/" + html;
            window.open(htmlPath);
            console.log("玩法详情");
        }
        //target.style["background-image"] = "url(assets/earth/btn_nor.png)";
    }

    function curBtnClickOut(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        //target.style["background-image"] = "url(assets/earth/btn_nor.png)";
    }

    function curBtnClickDown(event) {
        event = event || window.event;
        var target = event.target || event.srcElement;
        //target.style["background-image"] = "url(assets/earth/btn_down.png)";
    }

    var jsonInfo = [
        ["rBottomImage_2.png"],
        ["bottom", "24px"],
        ["right", "468px"],
        ["bottom", "340px"],
        ["right", "-14px"],
        ["rotate(180deg)"]
    ];
    createOtherDiv(parent, jsonInfo, 4);
}


function createOtherDiv(parent, jsonInfo, index) {

    if (!CheckCurrentOs().isPc) {
        return;
    }
    var tipImage = document.createElement("div");
    tipImage.style["background-image"] = "url(assets/earth/img/" + jsonInfo[0][0] + ")";
    tipImage.style.position = "absolute";
    tipImage.style["background-size"] = "100% 100%";
    tipImage.style["background-repeat"] = "no-repeat";
    tipImage.style.width = "179px";
    tipImage.style.height = "64px";
    tipImage.style[jsonInfo[1][0]] = jsonInfo[1][1];
    tipImage.style[jsonInfo[2][0]] = jsonInfo[2][1];
    parent.appendChild(tipImage);

    /*    var showBtn = document.createElement("div");
        showBtn.style["background-image"] = "url(assets/earth/img/showBtn.png)";
        showBtn.style.position = "absolute";
        showBtn.id = "showBtn_" + (index - 1);
        showBtn.style["background-size"] = "100% 100%";
        showBtn.style["background-repeat"] = "no-repeat";
        showBtn.style.transform = jsonInfo[5][0];
        showBtn.style.width = "88px";
        showBtn.style.height = "42px";
        showBtn.style[jsonInfo[3][0]] = jsonInfo[3][1];
        showBtn.style[jsonInfo[4][0]] = jsonInfo[4][1];
        showBtn.setAttribute("showBtnIndex", index.toString());
        showBtn.addEventListener("mouseup", showBtnClick);
        document.body.appendChild(showBtn);

        function showBtnClick(event) {
            event = event || window.event;
            var target = event.target || event.srcElement;
            var curIndex = parseInt(target.getAttribute("showBtnIndex"));
            console.log(curIndex);
            btnTouch = true;
            var touchDiv = document.getElementById("earth_tip_image_div_" + (curIndex - 1));
            if (divChoseIndex != curIndex && divChoseIndex > 0) {
                var lostDiv = document.getElementById("earth_tip_image_div_" + (divChoseIndex - 1));
                lostDiv.style.visibility = "hidden";
                touchDiv.style.visibility = "visible";
                var vis = touchDiv.style.visibility;
                if (curIndex != 3) {
                    vis = "hidden";
                }
                for (var j = 0; j < 5; j++) {
                    var lidiv = document.getElementById("lidiv_" + j);
                    lidiv.style.visibility = (j < 4 || curChose == 1) ? vis : "hidden";
                }
            } else {
                touchDiv.style.visibility = (touchDiv.style.visibility == "visible") ? "hidden" : "visible";
                if (curIndex == 3) {
                    for (var j = 0; j < 5; j++) {
                        var lidiv = document.getElementById("lidiv_" + j);
                        lidiv.style.visibility = (j < 4 || curChose == 1) ? touchDiv.style.visibility : "hidden";
                    }
                }
            }

            touchDiv.style.transform = "scale(1)";
            divChoseIndex = curIndex;
        }*/
}


function changeTime() {
    curTime -= 1;
    curTime = (curTime >= 0) ? curTime : 0;
    if (curTime <= 0 && isStart && !isShow) {
        var msg = (languageType == 0) ? "游戏结算中，请耐心等待!" : "Please wait patiently in game settlement!";
        msgTip(msg);
        isShow = true;
    } else if (!isStart) {
        var msgDiv = document.getElementById("msgDiv");
        if (msgDiv) {
            msgDiv.remove();
        }
    }   
    var earth_time = document.getElementsByClassName("earth-popup__briefs-count");
    if (earth_time[0] && earth_time[0].innerText) {
        earth_time[0].innerText = formatSeconds(curTime);
    }

    var showTimeText = document.getElementById("showTimeText");
    if (showTimeText) {
        showTimeText.innerText = (isStart ? "TIME：" : ((languageType == 0) ? "距离开启：" : "Next Open：")) + formatSeconds(curTime);
        if(isStart && curTime > 30){
            isShow = false;
        }
        var useTimeDiv = document.getElementById("useTimeDiv");
        if (useTimeDiv) {
            useTimeDiv.innerText = (isStart ? "TIME:" : ((languageType == 0) ? "距离开启:" : "Next Open：")) + formatSeconds(curTime);
        }
    }

    if (this.timeValue) {
        clearTimeout(this.timeValue);
    }
    this.timeValue = setTimeout("changeTime()", 1000);
}

function formatSeconds(value) {

    var secondTime = parseInt(value);
    var minuteTime = 0;
    var hourTime = 0;
    if (secondTime >= 60) {
        minuteTime = parseInt(secondTime / 60);
        secondTime = parseInt(secondTime % 60);
        if (secondTime < 10) {
            secondTime = "0" + secondTime;
        }

        if (minuteTime >= 60) {

            hourTime = parseInt(minuteTime / 60);
            if (hourTime < 10) {
                hourTime = "0" + hourTime;
            }

            minuteTime = parseInt(minuteTime % 60);
            if (minuteTime < 10) {
                minuteTime = "0" + minuteTime;
            }
        } else {
            hourTime = "00";
            if (minuteTime < 10) {
                minuteTime = "0" + minuteTime;
            }
        }
    } else {
        hourTime = "00";
        minuteTime = "00";
        if (secondTime < 10) {
            secondTime = "0" + secondTime;
        }
    }
    result = hourTime + "：" + minuteTime + "：" + secondTime;
    return result;
}

Planet.prototype.drawBG = function() {
    // draw BG
    var scope = this;

    var wo = 2560;
    var ho = 1440;
    var scale_coef = 590;

    // var w = this.radius*.5 / 9*16 *5;
    // var h = this.radius*.5 *5;
    var w = wo / scale_coef * this.radius;
    var h = ho / scale_coef * this.radius;

    var g = new THREE.PlaneGeometry(w, h, 1);

    var m = createMaterial("bg.jpg", function() {

        TweenLite.to(m, 3, {
            opacity: 1,
            ease: Sine.easeInOut
        })

    });

    var bg = this.bg = new THREE.Mesh(g, m);
    bg.matrixAutoUpdate = false;
    //bg.position.z = radius*1.5;
    this.static_container.add(bg);

    var patches = [];

    addPatch("bg_fragment_left.jpg", 933, 1011, 219, 0, 0);
    addPatch("bg_fragment_left_1.jpg", 933, 1011, 219, 0, Math.PI);
    addPatch("bg_fragment_right.jpg", 1074, 1133, 1516, 8, Math.PI / 3);
    addPatch("bg_fragment_right_1.jpg", 1074, 1133, 1516, 8, Math.PI / 3 + Math.PI);

    this.updateBg = function(delta) {

        for (var i = 0; i < patches.length; i++) {
            var m = patches[i];
            m.anim_offset += .03;
            m.opacity = Math.sin(m.anim_offset) * .4 + .2;
        };

    }

    function addPatch(img, ww, hh, xx, yy, anim_offset) {

        ww = ww / wo * w;
        hh = hh / ho * h;

        var g = new THREE.PlaneGeometry(ww, hh, 1);
        var m = createMaterial(img);
        // m.blending = 0;
        m.opacity = 1;
        m.anim_offset = anim_offset || 0;
        patches.push(m);

        var mesh = new THREE.Mesh(g, m);
        mesh.position.x = -w / 2 + ww / 2 + xx / wo * w;
        // console.log( -w/2, mesh.position.x );
        mesh.position.y = h / 2 - hh / 2 - yy / ho * h;
        mesh.position.z = .01;

        mesh.matrixAutoUpdate = false;
        mesh.updateMatrix();

        bg.add(mesh);

    }


    function createMaterial(img, onLoad) {
        var m = new THREE.MeshBasicMaterial();
        m.fog = !false;
        m.transparent = true;
        m.opacity = 0;
        m.blending = THREE.AdditiveBlending;
        m.depthWrite = false;
        // m.color = new THREE.Color( 0xff0000 );
        // m.wireframe = true;

        m.map = scope.textureLoader.load(PlanetData.textures_path + img, onLoad);
        m.map.generateMipalphaMaps = false;
        m.map.magFilter = THREE.LinearFilter;
        m.map.minFilter = THREE.LinearFilter;

        return m;
    }

}



/*
███████╗██████╗ ██╗   ██╗████████╗███╗   ██╗██╗██╗  ██╗
██╔════╝██╔══██╗██║   ██║╚══██╔══╝████╗  ██║██║██║ ██╔╝
███████╗██████╔╝██║   ██║   ██║   ██╔██╗ ██║██║█████╔╝ 
╚════██║██╔═══╝ ██║   ██║   ██║   ██║╚██╗██║██║██╔═██╗ 
███████║██║     ╚██████╔╝   ██║   ██║ ╚████║██║██║  ██╗
╚══════╝╚═╝      ╚═════╝    ╚═╝   ╚═╝  ╚═══╝╚═╝╚═╝  ╚═╝
*/
Planet.prototype.drawSputniks = function() {
    // SPUTNIKS
    this.sputniks = [];

    var sputnik1 = this.addSputnik('station_b.js', this.radius * 1.2, this.container, new THREE.Vector3(-.5, 0, 0));
    var sputnik2 = this.addSputnik('station_c.js', this.radius * 1.25, this.container, new THREE.Vector3(.6, 3, -1.2));
}


Planet.prototype.addSputnik = function(name, radius, container, rotation) {

    var scope = this;
    var loader = new THREE.JSONLoader();

    var ring = scope.drawRing(new THREE.Vector3(), radius, .05, new THREE.Vector3());
    var m = ring.material;
    m.opacity = .3;

    loader.load(
        // resource URL
        PlanetData.textures_path + name,
        // Function when resource is loaded
        function(geometry, materials) {

            var m = new THREE.MeshBasicMaterial({ color: scope.planet_color });
            m.wireframe = true;
            // m.transparent = true;
            // m.blending = THREE.AdditiveBlending;
            // m.depthWrite = false;

            var object = new THREE.Mesh(geometry, m);
            object.position.x = -radius;
            object.rotation.x = .5;
            object.scale.set(.03, .03, .03);
            object.matrixAutoUpdate = false;
            object.updateMatrix();
            ring.add(object);
        }
    );

    scope.sputniks.push(ring);

    var ring_container = new THREE.Object3D();
    scope.container.add(ring_container);
    ring_container.add(ring);

    ring_container.rotation.x = rotation.x;
    ring_container.rotation.y = rotation.y;
    ring_container.rotation.z = rotation.z;

    ring_container.matrixAutoUpdate = false;
    ring_container.updateMatrix();

    return ring;
}

function PlanetPointed(planet) {

    var scope = this;

    /// INIT
    var parts_count = 2;
    var u_grid = 250;
    var v_grid = 250;
    var particles = u_grid * v_grid;
    var is_animate = false;

    //球面粒子
    var texture = planet.textureLoader.load(PlanetData.textures_path + "dot.png");
    texture.generateMipalphaMaps = false;
    texture.magFilter = THREE.LinearFilter;
    texture.minFilter = THREE.LinearFilter;

    var materials = [];
    for (var i = 0; i < parts_count; i++) {
        var m = new THREE.PointsMaterial({ size: .15 / planet.ratio }); // 
        m.color = new THREE.Color(0x31b477);
        //m.color = new THREE.Color("#00ffff");
        m.map = texture;
        m.depthWrite = false;
        m.transparent = true;
        m.opacity = 0;
        m.blending = THREE.AdditiveBlending;
        // m.side = THREE.BackSide;//FrontSide;

        var prop = i / parts_count;
        m.t_ = prop * Math.PI * 2;
        m.speed_ = .04;
        m.min_ = Math.random() * .2 + .5;
        m.delta_ = Math.random() * .1 + .1;
        m.opacity_coef_ = 1;

        materials.push(m);
    }

    var current_container;







    var sea_hex_material;

    // METHODS
    this.init = function(_year) {

        var container = new THREE.Object3D();
        container.matrixAutoUpdate = false;
        // planet.container.add( container );
        // PlanetData.years[_year].pointed_sphere = container;

        // LAND

        var sphere_parts = [];

        for (var i = 0; i < parts_count; i++) {
            sphere_parts[i] = {
                positions: [],
                // colors: [],
            };
        };

        var positions = [];
        // var colors = [];

        spherical = new THREE.Spherical();
        spherical.radius = planet.radius;
        var pos = new THREE.Vector3();
        var projectiveImage = PlanetData.years[_year].earth_image;

        // var col = new THREE.Color(0xb1f7a0);
        for (var sv = 0; sv < v_grid; sv++) {
            var st = (u_grid * (1 - Math.sin(sv / v_grid * Math.PI))) / u_grid + .5;
            // console.log(sv,st);
            for (var su = 0; su < u_grid; su += st) {
                var u = su / u_grid;
                var v = sv / v_grid;
                var is_land = projectiveImage.isLandByUV(u, v);
                if (is_land) {
                    var o = sphere_parts[Math.floor(Math.random() * parts_count)];
                    spherical.theta = u * Math.PI * 2 - Math.PI / 2;
                    spherical.phi = v * Math.PI;
                    pos.setFromSpherical(spherical);
                    o.positions.push(pos.x);
                    o.positions.push(pos.y);
                    o.positions.push(pos.z);
                    // o.colors.push( col.r );
                    // o.colors.push( col.g );
                    // o.colors.push( col.b );
                }
            }
        };

        // POINTS
        for (var i = 0; i < sphere_parts.length; i++) {
            var o = sphere_parts[i];
            var geometry = new THREE.BufferGeometry();

            var positions_ = new Float32Array(o.positions.length);
            for (var j = 0; j < o.positions.length; j++) {
                positions_[j] = o.positions[j];
            };

            // var colors_ = Float32Array.from( o.colors );
            geometry.addAttribute('position', new THREE.BufferAttribute(positions_, 3));
            // geometry.addAttribute( 'color', new THREE.BufferAttribute( colors_, 3 ) );
            geometry.computeBoundingSphere();

            o.material = materials[i];

            var points = o.mesh = new THREE.Points(geometry, o.material);
            points.matrixAutoUpdate = false;
            container.add(points);
        };





        // SEA HEXS

        var r = planet.radius * .97;

        sea_hex_material = new THREE.MeshBasicMaterial({
            transparent: true,
            opacity: 0,
            color: new THREE.Color(0x31b477),
            blending: THREE.AdditiveBlending,
            // side : THREE.DoubleSide,
            depthWrite: false
            // ,wireframe: true
        });

        // Utils.drawFunction( undefined, 0 );

        var hex = Utils.createHexagon(.18, false, sea_hex_material, .025);
        var geo = new THREE.Geometry(); //hex.geometry.clone();
        var step = .01;
        var stp = step;
        var end, xx, y, yy;
        var pi2 = Math.PI * 2;
        var check_offset = .02;
        var row = false;

        for (var _y = -Math.PI + .5; _y < -.6; _y += .04) {
            y = Math.cos(_y) * .5 + .5;
            // console.log(">>", _y, y );
            row = !row;
            stp = Math.abs(step / Math.sin(y * Math.PI));
            end = Math.floor(1 / stp);
            // console.log( y, stp, end );

            for (var x = 0; x < end; x++) {

                xx = .5 + (end / 2 - x - (row ? .5 : 0)) * stp;
                yy = y;

                if (
                    Math.random() > .25 ||
                    projectiveImage.isLandByUV(xx, yy) ||
                    projectiveImage.isLandByUV(xx - check_offset, yy) ||
                    projectiveImage.isLandByUV(xx + check_offset, yy) ||
                    projectiveImage.isLandByUV(xx, yy - check_offset) ||
                    projectiveImage.isLandByUV(xx, yy + check_offset)
                ) continue;

                Utils.setFromSpherical(planet.radius * (.97 - Math.random() * .01), xx, yy, hex.position);
                hex.lookAt(THREE.Vector3.ZERO);
                hex.updateMatrix();
                hex.updateMatrixWorld();

                geo.merge(hex.geometry, hex.matrixWorld);

            }
        };

        // console.log("=>", geo );
        var hexs = new THREE.Mesh(geo, sea_hex_material);
        hexs.matrixAutoUpdate = false;
        container.add(hexs);




        return container;
    }



    this.update = function() {
        for (var i = 0; i < materials.length; i++) {
            var m = materials[i];
            m.t_ += m.speed_;
            // o.material.opacity = Math.sin(o.t)*.2+.5;
            m.opacity = (Math.sin(m.t_) * m.delta_ + m.min_) * m.opacity_coef_;
        };
    }


    this.show = function(_year, t) {
        var year_data = PlanetData.years[_year];

        if (!year_data.pointed_sphere) year_data.pointed_sphere = this.init(_year);
        current_container = year_data.pointed_sphere;

        planet.container.add(current_container);

        for (var i = 0; i < materials.length; i++) {
            var m = materials[i];
            TweenLite.killTweensOf(m);
            TweenLite.to(m, t, {
                opacity_coef_: 1,
                ease: Sine.easeInOut,
                onComplete: function() {

                }
            })
        };

        TweenLite.killTweensOf(sea_hex_material);
        TweenLite.to(sea_hex_material, t, {
            opacity: .4,
            ease: Sine.easeInOut
        });
    }


    this.hide = function(t) {

        for (var i = 0; i < materials.length; i++) {
            var m = materials[i];
            //console.log(m);
            TweenLite.killTweensOf(m);
            TweenLite.to(m, t, {
                opacity_coef_: 0,
                ease: Sine.easeInOut,
                onComplete: function() {
                    planet.container.remove(current_container);
                }
            })
        };

        TweenLite.killTweensOf(sea_hex_material);
        TweenLite.to(sea_hex_material, t, {
            opacity: 0,
            ease: Sine.easeInOut
        });
    }

}
// LAND CONTOUR
PlanetContour = function(planet) {

    var max_opacity = .8; //.65;

    var _geometry = new THREE.SphereGeometry(planet.radius * .995, 32, 32, 0, Math.PI);
    var m1 = new THREE.MeshBasicMaterial();
    m1.color = new THREE.Color(0x31b477);
    m1.fog = false;
    m1.transparent = true;
    m1.blending = THREE.AdditiveBlending;
    m1.depthWrite = false;

    var sphere1 = new THREE.Mesh(_geometry, m1);
    sphere1.visible = false;
    sphere1.matrixAutoUpdate = false;
    // sphere1.rotation.y = Math.PI * .999;
    sphere1.updateMatrix();
    planet.container.add(sphere1);
    sphere1.matrixAutoUpdate = false;

    // 2nd halfsphere
    var m2 = m1.clone();

    var sphere2 = sphere1.clone();
    sphere2.material = m2;
    planet.container.add(sphere2);
    sphere2.rotation.y = Math.PI;
    sphere2.updateMatrix();




    // METHODS

    this.show = function(_year, t) {
        var year_data = PlanetData.years[_year];

        if (!year_data.contour_texture) {
            var urls = year_data.contour_url;
            year_data.contour_texture = [getTexture(urls[0]), getTexture(urls[1])];
        }

        m1.map = year_data.contour_texture[0];
        m1.map.generateMipalphaMaps = false;
        m1.map.magFilter = THREE.LinearFilter;
        m1.map.minFilter = THREE.LinearFilter;
        m1.needsUpdate = true;

        m2.map = year_data.contour_texture[1];
        m2.map.generateMipalphaMaps = false;
        m2.map.magFilter = THREE.LinearFilter;
        m2.map.minFilter = THREE.LinearFilter;
        m2.needsUpdate = true;

        fadeIn(sphere1, t);
        fadeIn(sphere2, t);
    }



    this.hide = function(t) {
        fadeOut(sphere1, t);
        fadeOut(sphere2, t);
    }





    function getTexture(path) {
        var map = planet.textureLoader.load(path); // PlanetData.textures_path + "contour1_1.png"
        map.generateMipalphaMaps = false;
        map.magFilter = THREE.LinearFilter;
        map.minFilter = THREE.LinearFilter;
        return map;
    }

    function fadeIn(o, t) {
        o.visible = true;
        var m = o.material;
        m.opacity = 0;
        TweenLite.killTweensOf(m);
        TweenLite.to(m, t, {
            opacity: max_opacity,
            ease: Sine.easeInOut
            // ,onComplete: function(){

            // }
        })
    }

    function fadeOut(o, t) {
        var m = o.material;
        TweenLite.killTweensOf(m);
        TweenLite.to(m, t, {
            opacity: 0,
            ease: Sine.easeInOut,
            onComplete: function() {
                // o.visible = false;
            }
        })
    }

}

var PlanetData = (function() {

    var scope = this;

    this.textures_path = "assets/earth/";

    this.YEAR = null; // Current YEAR data container
    this.YEAR_ID = null; // Current year id container

    // YEARS DATA
    this.years = {

        "2030": {
            "earth_url": this.textures_path + "earth_1.png",
            "contour_url": [this.textures_path + "contour1_1.png", this.textures_path + "contour2_1.png"]

                // debug parameter! min amount of locations. the app adds fake locations if actual value is lower.
                ,
            min_locations: 100
        },

        "2040": {
            "earth_url": this.textures_path + "earth_1.png",
            "contour_url": [this.textures_path + "contour1_1.png", this.textures_path + "contour2_1.png"],
            min_locations: 50
        },

        "2050": {
            "earth_url": this.textures_path + "earth_1.png",
            "contour_url": [this.textures_path + "contour1_1.png", this.textures_path + "contour2_1.png"],
            min_locations: 10
        },
    };

    this.displayBoxImage = this.textures_path + "displayImage.png";

    // 
    this.year_ids = [];
    for (var i in this.years) {
        this.year_ids.push(i);
    };

    this.hasLocationAnyBriefs = function(_location, year) {

        // current year
        if (year === true) {

            return _location.years[scope.YEAR_ID].briefs;

            // specified year
        } else if (year !== undefined) {

            return _location.years[year].briefs;

        }

        // any year
        for (var i in _location.years) {
            var briefs = _location.years[i].briefs;
            if (briefs) return briefs;
        };

        return 0;

    }

    return this;

})();
/*
██╗   ██╗███████╗ █████╗ ██████╗ ███████╗
╚██╗ ██╔╝██╔════╝██╔══██╗██╔══██╗██╔════╝
 ╚████╔╝ █████╗  ███████║██████╔╝███████╗
  ╚██╔╝  ██╔══╝  ██╔══██║██╔══██╗╚════██║
   ██║   ███████╗██║  ██║██║  ██║███████║
   ╚═╝   ╚══════╝╚═╝  ╚═╝╚═╝  ╚═╝╚══════╝
*/

Planet.prototype.showYear = function(_year, onReady) {

    var scope = this;
    // console.log(">>>! ", this.main.controls.autoRotate );

    if (PlanetData.YEAR_ID) {
        this.hidePlanet(_year, onReady);
        return;
    }

    PlanetData.YEAR_ID = _year;
    PlanetData.YEAR = PlanetData.years[_year];
    console.log("showYear: ", _year, PlanetData.YEAR);

    if (PlanetData.YEAR.earth_image) {

        show();

    } else {

        PlanetData.YEAR.earth_image = this.projectiveImage = new ProjectiveImage(PlanetData.YEAR.earth_url, show);
    }

    $(".timeline").css("pointer-events", "none");

    function show() {

        var t = 2.25;
        scope.main.animateIn(t, function() {
            scope.state = scope.IDLE;
            // scope.commentToggle( true );
            $(".timeline").css("pointer-events", "auto");
        });

        t = t / 3 * 2;
        scope.planetLocations.show(_year, t);
        scope.planetPointed.show(_year, t);
        scope.planetContour.show(_year, t);

        if (onReady) onReady();
    }

}

Planet.prototype.hidePlanet = function(_year, onReady, t) {


    this.state = this.ANIMATED;
    var scope = this;
    // console.log("hidePlanet");
    this.deactivateHexagon();

    $(".timeline").css("pointer-events", "none");
    // scope.commentToggle( false );

    if (t === undefined) t = 1.5;

    this.main.animateOut(t, function() {
        PlanetData.YEAR_ID = undefined;
        scope.showYear(_year, onReady);
        // $(".timeline").css( "pointer-events", "auto" );
    });

    scope.planetLocations.hide(t / 2);
    scope.planetPointed.hide(t / 2);
    scope.planetContour.hide(t / 2);

    // if( this._PlanetCommentPopup ) this._PlanetCommentPopup.hide();

}
THREE.Text = function(params) {

    // params.text
    // params.font_propotion
    // params.font
    // params.width
    // params.height
    // params.transparent
    // params.offset_x
    // params.offset_y
    // params.multiplier
    // params.fillStyle
    // params.debug

    var scope = this;
    scope.offset_x = params.offset_x || 0;
    scope.border_x = params.border_x || 0;
    scope.offset_y = params.offset_y || 0;
    scope.font = params.font || "Arial";
    scope.font_propotion = params.font_propotion || 20;
    // scope.multiplier = params.multiplier || 1;
    scope.fillStyle = params.fillStyle || "rgba(255,0,0, 0.95)";
    scope.fontStyle = params.fontStyle || "";

    // scope.pow_coef_x = 1;

    var canvas = scope.canvas = document.createElement('canvas');
    var context = scope.context = canvas.getContext('2d');
    if (params.debug) {
        document.body.appendChild(canvas);
        // $(canvas).css({ position: "absolute", top: 0, left: 0 });
        canvas.style.position = "absolute";
        canvas.style.top = 0;
        canvas.style.left = 0;
    }

    var texture = new THREE.Texture(canvas)
    texture.needsUpdate = true;
    texture.generateMipmaps = false;
    texture.magFilter = THREE.LinearFilter;
    texture.minFilter = THREE.LinearFilter;
    texture.wrapS = THREE.ClampToEdgeWrapping;
    // texture.repeat.x = - 1;
    texture.needsUpdate = true;

    var material = new THREE.MeshBasicMaterial({ map: texture });
    material.transparent = params.transparent || false;
    material.side = params.side == undefined ? THREE.DoubleSide : params.side;
    material.depthWrite = !true;
    // material.wireframe = true;

    var g = new THREE.PlaneGeometry(1, 1);
    var m = new THREE.Matrix4();
    m.setPosition(new THREE.Vector3(.5, .5, 0));
    g.applyMatrix(m);

    // var material_test = new THREE.MeshBasicMaterial( { color: 0xff0000 } );

    var mesh = scope.mesh = new THREE.Mesh(g, material);
    mesh.matrixAutoUpdate = false;
    mesh.visible = false;

    mesh.setSize = function(width, height) {
        // console.log("setSize: ", width);

        mesh.width = width;
        mesh.height = height;

        var w = mesh.canvas_vis_width = Math.floor(width * 100);
        var h = mesh.canvas_vis_height = Math.floor(height * 100);
        var wc = Utils.nearestPow2(w);
        var hc = Utils.nearestPow2(h);
        canvas.width = wc;
        canvas.height = hc;
        texture.repeat.x = mesh.pow_coef_x = w / wc;
        texture.repeat.y = mesh.pow_coef_y = h / hc;
        texture.offset.y = (1 - texture.repeat.y);
        // console.log( "setSize>> W:", width, w, wc, mesh.pow_coef_x );
        // console.log( "setSize>> H:", height, h, hc, mesh.pow_coef_y );
        mesh.scale.set(width, height, 1);
        mesh.updateMatrix();
    }

    mesh.setWidth = function(text) {
        var w;
        if (typeof text == "string") { // get width from text
            setupText();
            w = (context.measureText(text).width + scope.offset_x + scope.border_x) / 100;
            // console.log("setWidth: ", text, w );
            // console.log(">: ", scope.offset_x, scope.border_x );
        } else w = text;

        mesh.setSize(w, params.height);

        return w;

    }

    mesh.setText = function(text, width) {
        // console.log("\n");
        // console.log("setText: ", scope.offset_x );

        mesh.setWidth(width || text);

        context.clearRect(0, 0, canvas.width, canvas.height);

        if (mesh.prefill) mesh.prefill.apply(scope);

        // console.log( ">>> ", context.font );

        // debug !!!
        // context.fillStyle = "#FF0000";
        // // context.fillRect( 0, 0, mesh.canvas_vis_width, mesh.canvas_vis_height );
        // context.fillRect( 0, 0, canvas.width, canvas.height );
        // debug !!!


        setupText();
        // context.fillStyle = "#000000";
        context.fillText(text, scope.offset_x, mesh.canvas_vis_height / 2);

        texture.needsUpdate = true;
    }

    function setupText() {
        scope.font_height = scope.font_propotion * mesh.canvas_vis_height;
        context.font = scope.fontStyle + " " + (scope.font_height) + 'px ' + scope.font; //"Bold 40px Arial";
        context.fillStyle = scope.fillStyle;
        context.textBaseline = "middle";
    }
    // mesh.setText( "init" );


    mesh.show = function(_delay) {
        mesh.scale.x = .001;
        mesh.matrixAutoUpdate = true;
        TweenLite.killTweensOf(mesh.scale);
        TweenLite.to(mesh.scale, .2, {
            delay: _delay,
            x: Math.floor(mesh.width),
            ease: Sine.easeOut,
            onStart: function() {
                mesh.visible = true;
            },
            onComplete: function() {
                mesh.updateMatrix();
                mesh.matrixAutoUpdate = false;
            }
        });
    }

    mesh.hide = function(_delay) {
        if (!mesh.visible) return;
        mesh.scale.x = 0;
        mesh.matrixAutoUpdate = true;
        TweenLite.killTweensOf(mesh.scale);
        TweenLite.to(mesh.scale, .2, {
            delay: _delay,
            x: .001,
            ease: Sine.easeIn,
            onComplete: function() {
                mesh.visible = false;
                mesh.updateMatrix();
                mesh.matrixAutoUpdate = false;
            }
        });
    }

    return mesh;
}
// IMAGE
function ProjectiveImage(_img_url, _onload) {

    var projectionContext;

    var img = document.createElement("img");
    img.src = _img_url;
    img.onload = function() {
        console.log("image loaded");
        var projectionCanvas = document.createElement('canvas');
        projectionContext = projectionCanvas.getContext('2d');
        projectionCanvas.width = img.width;
        projectionCanvas.height = img.height;
        projectionCanvas.id = "canvas";
        projectionContext.drawImage(img, 0, 0, img.width, img.height);
        if (_onload) _onload();
    }

    var pixelData = null;

    var maxLat = -100;
    var maxLon = 0;
    var minLat = 0;
    var minLon = 0;

    this.isLand = function(lat, lon) {

        var x = parseInt(img.width * (lon + 180) / 360);
        var y = parseInt(img.height * (lat + 90) / 180);

        if (pixelData == null) {
            pixelData = projectionContext.getImageData(0, 0, img.width, img.height);
        }
        return pixelData.data[(y * pixelData.width + x) * 4] === 0;
    };

    this.isLandByUV = function(u, v) {
        if (pixelData == null) {
            pixelData = projectionContext.getImageData(0, 0, img.width, img.height);
        }
        var x = parseInt(img.width * u);
        var y = parseInt(img.height * v);
        return pixelData.data[(y * pixelData.width + x) * 4] === 0;
    };

    this.getUV = function(lat, lon) {
        return {
            x: (lon + 180) / 360,
            y: (lat + 90) / 180
        }
    }

    this.getUVOfPI = function(lat, lon) {
        return {
            x: (lon + Math.PI) / Utils.PI2,
            y: (lat + Utils.PIh) / Math.PI
        }
    }
}

var Utils = new function() {

    this.getHalfPoint = function(p1, p2) {
        var p1 = new THREE.Vector3(p1.x, p1.y, p1.z);
        var p2 = new THREE.Vector3(p2.x, p2.y, p2.z);
        var b2 = p2.sub(p1).divideScalar(2).add(p1);
        return b2;
    }

    this.getRandSides = function(value) {
        return Math.random() * value * 2 - value;
    }

    this.PIh = Math.PI / 2;
    this.PI2 = Math.PI * 2;

    THREE.Vector3.ZERO = new THREE.Vector3();

    this.createHexagon = function(h, orient, material, ring_width) {
        // var h = .5;
        // var g = ring_width ? new THREE.PRingBufferGeometry( h, h + ring_width, 6, 1 ) : new THREE.CircleBufferGeometry( h, 6 );
        var g = ring_width ? new THREE.RingGeometry(h, h + ring_width, 6, 1) : new THREE.CircleGeometry(h, 6);
        // m.makeScale( -1,1,1 ); g.applyMatrix(m);
        if (orient) {
            var m = new THREE.Matrix4();
            m.identity().makeRotationX(Math.PI / 2);
            g.applyMatrix(m);
            m.identity().makeRotationY(Utils.PI2 / 6 / 2);
            g.applyMatrix(m);
        }

        if (!material) var material = new THREE.MeshBasicMaterial({ color: 0xffffff });
        // material.transparent = true;
        // material.opacity =.5;
        material.side = THREE.BackSide;
        var mesh = new THREE.Mesh(g, material);
        mesh.matrixAutoUpdate = false;

        return mesh;
    }

    this.orientHexagon = function(mesh, t, look_at_corner) {
        var up_coef = 10;
        mesh.position.copy(t.centerPoint);
        // mesh.scale.set( t.width, t.width, t.width );
        // mesh.scale.set( .001, .001, .001 );
        mesh.up.set(t.centerPoint.x * up_coef, t.centerPoint.y * up_coef, t.centerPoint.z * up_coef);
        if (look_at_corner) mesh.lookAt(t.boundary[0]);
        // mesh.updateMatrix();
    }

    this.nearestPow2 = function(aSize) {
        return Math.pow(2, Math.ceil(Math.log(aSize) / Math.log(2)));
    }

    this.setFromSpherical = function(radius, u, v, vec3) {
        var spherical = new THREE.Spherical();
        spherical.radius = radius;
        spherical.theta = u * Math.PI * 2 - Math.PI / 2;
        spherical.phi = v * Math.PI;
        if (!vec3) vec3 = new THREE.Vector3();
        vec3.setFromSpherical(spherical);
        return vec3;
    }

}


Utils.getEventCursorPosition = function(e, mouse_obj) {
    var pos;
    var touches = e.originalEvent.touches;
    if (touches) pos = touches.length ? touches[0] : e.originalEvent.changedTouches[0];
    else pos = e;

    if (mouse_obj) {
        mouse_obj.x = pos.clientX;
        mouse_obj.y = pos.clientY;
        return;
    }

    return { x: pos.clientX, y: pos.clientY };
}

Utils.getEventCursorPositionOrientation = function(e, mouse_obj) {
    Util.getEventCursorPosition(e, mouse_obj);
    mouse_obj.x = (mouse_obj.x / window.innerWidth) * 2 - 1;
    mouse_obj.y = -(mouse_obj.y / window.innerHeight) * 2 + 1;
}

Utils.get2dPosition = function(position, camera, dom_element) {
    var v = position.clone().project(camera);
    v.x = (v.x + 1) / 2 * dom_element.innerWidth;
    v.y = -(v.y - 1) / 2 * dom_element.innerHeight; // - window.innerHeight * .08;
    return v;
}



Utils.drawFunction = function(start, end, foo, step, amplitude) {

    console.log('====================================');

    start = start == undefined ? -Math.PI : start;
    end = end == undefined ? Math.PI : end;
    step = step == undefined ? .1 : step;
    amplitude = amplitude == undefined ? 30 : amplitude;
    foo = foo == undefined ? function(v) { return Math.cos(v) } : foo;

    var count = 0;

    for (var y = start; y < end; y += step) {
        var str = '';
        for (var i = 0; i < amplitude * 2; i++) {
            str += i == amplitude ? ':' : "-";
        };
        var p = foo(y);
        var x = Math.round(p * amplitude) + amplitude;
        str = str.substr(0, x) + "*" + str.substr(x + 1);
        console.log(count + " |" + str, x);
        count++;
        if (count >= 10) count = 0;
    }
    console.log('====================================');
}












// FAKE EXTERNAL METHODS
/*
var kaspersky = kaspersky || {};

(function(){
    
    var $DOMElement = $("<div id='active_hexagon' style='\
        position:fixed;\
        top: 0;\
        left: 0;\
        width: 100px;\
        height: 100px;\
        background: red;\
        display: none;\
    '>").appendTo( $("html") );

    if( !kaspersky.getHexaspherePopup ) kaspersky.getHexaspherePopup = function( data, onClick ){

        console.log( "getHexaspherePopup> ", data );
        $DOMElement.show();

        $DOMElement.off().click( function(){
            onClick( data[0] );
        });
        
        return {
            "element": $DOMElement[0],
            "close": function(){
                $DOMElement.hide();
                console.log( "The active hexagon close!" );
            } //закрытие окна
        }

    }

})();
*/